import{g as Z,i as $,K as ee,r,t as d,H as F,u as i,L as te,o as le,N as ae,k as c,c as v,l as _,m as u,p as n,q as e,U as oe,z as C,W as ne,J as k,M as de,A as E}from"./index-46c4d077.js";import{d as U}from"./document-05818088.js";import{u as se}from"./document-b69017e8.js";import{d as ie}from"./helpers-2f7f5024.js";import{b as ce}from"./helpers-27fc0e50.js";import"./index.esm-b6ca17d6.js";const fe={__name:"index",setup(ue){const S=Z(),w=$(),T=se(),M=ee();let s=r(!1),b=r([]),g=r([]),y=r(d.tableSelectedState.none),o=F(O()),f=r([]),A=r([]),B=r(i.createEmptyDataSource());F({});function O(){return{pageNumber:1,sortBy:"Code",code:null,documentTypeIds:null,abreviation:null,name:null,recordStateIds:[d.recordStateType.published],active:!0,organization:null}}te(async()=>{s.value=!0,f.value=i.convertEnumToArray(w.enums.recordStateType);const t=await U.getLists(M.getLanguage);i.validateResponse(t,null,()=>{T.setLists(t.data),f.value=i.convertEnumToArray(w.enums.recordStateType),A.value=i.concatItemsBadge(f.value,ce.recordStateTypeBadgeOptions)}),s.value=!1}),le(async()=>{await I()});function L(t){S.push({name:E.router.BACKOFFICE_EDIT_DOCUMENT_PAGE.name,params:{documentId:i.encodeId(t.documentId),documentVersion:i.encodeId(t.documentVersion)}})}function N(t){S.push({name:E.router.BACKOFFICE_DETAIL_DOCUMENT_PAGE.name,params:{documentId:i.encodeId(t.documentId),documentVersion:i.encodeId(t.documentVersion)}})}async function P(){Object.assign(o,O()),await z()}async function z(){o.pageNumber=1,await I()}async function D(){s.value=!0;const t=await U.create(ie.newForm());i.validateResponse(t,null,()=>{const a=i.encodeId(t.data.documentId),V=i.encodeId(t.data.documentVersion);S.push({name:E.router.BACKOFFICE_EDIT_DOCUMENT_PAGE.name,params:{documentId:a,documentVersion:V}})}),s.value=!1}async function R(t){o.sortBy=t,await I()}async function x(t){o.pageNumber=t,await I()}async function I(){s.value=!0;let t=await U.search(o);i.validateResponse(t,null,()=>{B.value=t.data}),s.value=!1}const H=r(ae.havePermission(d.permissions.document.createEdit));return(t,a)=>{const V=c("breadcrumb-item"),K=c("breadcrumb"),G=c("cbutton"),m=c("form-field"),W=c("row"),j=c("cfilter"),p=c("ccolumn"),q=c("table-action-edit"),J=c("table-action-detail"),h=c("ctable"),Q=c("card"),X=c("page");return v(),_(X,{title:t._lang.backoffice.document.pageTitle},{breadcrumb:u(()=>[n(K,{"has-home":!0},{default:u(()=>[n(V,{label:t._lang.backoffice.document.breadcrumbTitle},null,8,["label"])]),_:1})]),actions:u(()=>[H.value?(v(),_(G,{key:0,class:"col-12 col-sm-auto",type:e(d).buttonType.secondary,size:e(d).buttonSize.medium,title:t._lang.common.toAdd,icon:oe,onClick:D},null,8,["type","size","title"])):C("",!0)]),default:u(()=>[n(Q,{shadow:!0},{body:u(()=>[n(j,{title:t._lang.common.filter,disabled:e(s),"clear-click":P,"apply-click":z,loading:e(s),collapsed:!0},{default:u(()=>[n(W,null,{default:u(()=>[n(m,{id:"code",modelValue:e(o).code,"onUpdate:modelValue":a[0]||(a[0]=l=>e(o).code=l),class:"mb-3 col-12 col-md-6 col-xl-4",label:t._lang.label.code,type:e(d).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),n(m,{class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).documentTypeIds,"onUpdate:modelValue":a[1]||(a[1]=l=>e(o).documentTypeIds=l),label:t._lang.label.documentTypeId,type:e(d).inputs.multiselect,options:e(T).documentTypeList,disabled:e(s),mode:e(d).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),n(m,{class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).abreviation,"onUpdate:modelValue":a[2]||(a[2]=l=>e(o).abreviation=l),label:t._lang.label.abreviation,type:e(d).inputs.text,maxlength:16,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),n(m,{id:"organization",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).organization,"onUpdate:modelValue":a[3]||(a[3]=l=>e(o).organization=l),label:t._lang.label.organizationHost,type:e(d).inputs.multiselect,options:e(T).organizationList,disabled:e(s),valueProp:e(d).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),n(m,{id:"name",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).name,"onUpdate:modelValue":a[4]||(a[4]=l=>e(o).name=l),label:t._lang.label.name,type:e(d).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),n(m,{id:"recordStateIds",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).recordStateIds,"onUpdate:modelValue":a[5]||(a[5]=l=>e(o).recordStateIds=l),label:t._lang.label.state,type:e(d).inputs.multiselect,options:e(f),disabled:e(s),mode:e(d).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),n(m,{id:"active",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).active,"onUpdate:modelValue":a[6]||(a[6]=l=>e(o).active=l),label:t._lang.label.public,type:e(d).inputs.checkbox,disabled:e(s)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","disabled","loading"]),n(ne,null,{default:u(()=>[n(h,{onSort:R,onChangePage:x,selectedItems:e(b),"onUpdate:selectedItems":a[7]||(a[7]=l=>k(b)?b.value=l:b=l),unselectedItems:e(g),"onUpdate:unselectedItems":a[8]||(a[8]=l=>k(g)?g.value=l:g=l),selectedState:e(y),"onUpdate:selectedState":a[9]||(a[9]=l=>k(y)?y.value=l:y=l),data:e(B),checkbox:!1,loading:e(s),defaultSort:"pointOfCareId",checkboxField:"code"},{columns:u(()=>[n(p,{name:t._lang.label.code,field:"code",sortable:!0},null,8,["name"]),n(p,{name:t._lang.label.documentTypeId,field:"documentType",sortField:"documentTypeId",sortable:!0},null,8,["name"]),n(p,{name:t._lang.label.abreviation,field:"abreviation",sortable:!0},null,8,["name"]),n(p,{name:t._lang.label.name,field:"name",sortable:!0},null,8,["name"]),n(p,{name:t._lang.label.state,field:"recordStateTypeId",align:e(d).columnAlign.center,custom:de,options:e(A),sortable:!0},null,8,["name","align","options"])]),actions:u(l=>[l.item.recordStateTypeId==e(d).recordStateType.draft?(v(),_(q,{key:0,onClick:Y=>L(l.item)},null,8,["onClick"])):C("",!0),l.item.recordStateTypeId>e(d).recordStateType.draft?(v(),_(J,{key:1,onClick:Y=>N(l.item)},null,8,["onClick"])):C("",!0)]),_:1},8,["selectedItems","unselectedItems","selectedState","data","loading"])]),_:1})]),_:1})]),_:1},8,["title"])}}};export{fe as default};
