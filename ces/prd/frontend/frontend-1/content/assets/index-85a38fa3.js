import{b as Y,d as J,u,r as _,o as D,a as Q,c as v,e as y,_ as W,f as X,g as Z,h as ee,i as ae,j as B,k as T,l as x,w as h,m as l,n as d,p as a,q as te,s as I,t as f,v as i,F as O,x as se,y as A,z,A as oe,B as ne}from"./index-a14ad215.js";const le={search:t=>Y.post("/es/search",t)},re=J("SearchStore",{state:()=>({objectTypes:[],organizationParents:[],items:[],filterModel:u.createFilterModel(),pageCount:0,page:0}),getters:{},actions:{setObjectTypes(t){this.objectTypes=[];for(let p in t)this.objectTypes.some(b=>b.value===t[p].index)||this.objectTypes.push({value:t[p].index,label:t[p].title})},setOrganizationParents(t){this.organizationParents=[];for(let p in t)this.organizationParents.some(b=>b.value===t[p].organizationParent)||this.organizationParents.push({value:t[p].organizationParent,label:t[p].organizationParent})},setFilterModel(t){this.filterModel=t},setItems(t){this.items=t},setPageCount(t){this.pageCount=t},setPage(t){this.page=t}}}),ie={__name:"observer",props:{options:Object},emits:["intersect"],setup(t,{emit:p}){const b=t,r=_(null),V=_(null);return D(()=>{const P=b.options||{};r.value=new IntersectionObserver(([m])=>{m&&m.isIntersecting&&p("intersect")},P),r.value.observe(V.value)}),Q(()=>{r.value.disconnect()}),(P,m)=>(v(),y("div",{class:"observer",ref_key:"observerRef",ref:V},null,512))}};const C=t=>(oe("data-v-b7d7a61b"),t=t(),ne(),t),ce={class:"image-back-home px-5"},ue=C(()=>l("div",{class:"col-12 mt-5"},[l("h1",null,"Bem-vindo")],-1)),de={class:"col-12"},pe={class:"col-12 search-btn"},_e={class:"col-12"},ve=["innerHTML"],me={class:"mt-3"},ge=["onClick"],he={class:"title"},be={class:"description"},fe={key:0,class:"f-14"},ye=C(()=>l("br",null,null,-1)),Ie=C(()=>l("br",null,null,-1)),Ce={key:0,class:"f-14"},Pe=C(()=>l("br",null,null,-1)),Ee=C(()=>l("br",null,null,-1)),Ae=C(()=>l("br",null,null,-1)),Ve={class:"date"},ke=C(()=>l("hr",{class:"rounded"},null,-1)),ze=["innerHTML"],Te={__name:"search",setup(t){const p=X(),b=Z(),r=re();ee();const V=ae();let P=_(!1),m=_(!1),F=_(!1),M=_(!1),n=_(u.createFilterModel()),E=_(0),S=_(999),g=_([]),R=_(0);const N=B(()=>V.common.emptyResult.replace("{0}",`<strong>${n.value.query}</strong>`)),j=B(()=>V.common.totalRecords.replace("{0}",`<strong>${R.value}</strong>`)),w=async()=>{F.value=!1,n.value.query&&(E.value=0,r.setFilterModel(n.value),g.value=[],await L(),m.value=!1,F.value=!1)},L=async()=>{M.value=!0,n.value.pageNumber=E.value;let s=await le.search(n.value);s.code!==0&&await H(),u.validateResponse(s,null,()=>{g.value.push(...K(s.data.items)),E.value++,R.value=s.data.total,S.value=Math.ceil(s.data.total/n.value.pageSize),r.setObjectTypes(g.value),r.setOrganizationParents(g.value),r.setItems(g.value),r.setPageCount(S.value),r.setPage(E.value),M.value=!1,P.value=!0})};D(()=>{F.value=!1,p.hash==="#history"&&(m.value=!0,r.filterModel.query&&(g.value.push(...r.items),E.value=r.page,S.value=r.pageCount,n.value=r.filterModel,P.value=!0,F.value=!0,m.value=!1))});const H=async()=>{n.value.pageNumber=0,n.value.name=null,n.value.abreviation=null,n.value.organizationParents=null,n.value.index=null};function q(s){let e="",c={};switch(s.index){case"organization":e=z.router.BACKOFFICE_SEARCH_DETAIL_ENTITY_PAGE.name,c={organizationId:u.encodeId(s.id),organizationVersion:u.encodeId(s.version)};break;case"pointofcare":e=z.router.BACKOFFICE_SEARCH_DETAIL_POINT_OF_CARE_PAGE.name,c={pointOfCareId:u.encodeId(s.id),pointOfCareVersion:u.encodeId(s.version)};break;case"service":e=z.router.BACKOFFICE_SEARCH_DETAIL_SERVICE_PAGE.name,c={serviceId:u.encodeId(s.id),serviceVersion:u.encodeId(s.version)};break;case"location":e=z.router.BACKOFFICE_SEARCH_DETAIL_LOCATION_PAGE.name,c={locationId:u.encodeId(s.id),locationVersion:u.encodeId(s.version)};break;case"document":e=z.router.BACKOFFICE_SEARCH_DETAIL_DOCUMENT_PAGE.name,c={documentId:u.encodeId(s.id),documentVersion:u.encodeId(s.version)};break}b.push({name:e,params:c})}function K(s){return s.map(e=>({id:e.id,version:e.version,title:e.pt.type,name:e.pt.name,organizationParent:e.organizationParent,address:e.address,date:u.formatDate(e.startDate),index:e.index,economicActivity:e.economicActivity,category:e.category,type:e.type}))}async function U(){E.value<S.value&&await L()}return(s,e)=>{const c=T("row"),k=T("form-field"),G=T("icon-search"),$=T("card");return v(),x($,{shadow:!0,class:"card-home",padding:!1},{body:h(()=>[l("div",ce,[d(c,null,{default:h(()=>[ue]),_:1}),d(c,{class:"mt-5 mb-3"},{default:h(()=>[l("div",de,[d(k,{id:"query",label:"Pesquisar",modelValue:a(n).query,"onUpdate:modelValue":e[0]||(e[0]=o=>a(n).query=o),placeholder:s._lang.backoffice.home.placeholderSearch,onKeyup:te(w,["enter"]),type:a(I).inputs.search},null,8,["modelValue","placeholder","onKeyup","type"])])]),_:1}),d(c,null,{default:h(()=>[d(k,{id:"abreviation",class:"mb-3 col-12 col-md-6",label:s._lang.label.abreviation,type:a(I).inputs.text,maxlength:45,modelValue:a(n).abreviation,"onUpdate:modelValue":e[1]||(e[1]=o=>a(n).abreviation=o)},null,8,["label","type","modelValue"]),d(k,{id:"types",class:"mb-3 col-12 col-md-6",modelValue:a(n).index,"onUpdate:modelValue":e[2]||(e[2]=o=>a(n).index=o),label:s._lang.label.type,loading:a(m),type:a(I).inputs.multiselect,mode:a(I).multiselectMode.tags,options:a(r).objectTypes},null,8,["modelValue","label","loading","type","mode","options"])]),_:1}),d(c,null,{default:h(()=>[d(k,{id:"name",class:"mb-3 col-12 col-md-6",label:s._lang.label.name,type:a(I).inputs.text,maxlength:45,modelValue:a(n).name,"onUpdate:modelValue":e[3]||(e[3]=o=>a(n).name=o)},null,8,["label","type","modelValue"]),d(k,{id:"organizationParents",class:"mb-3 col-12 col-md-6",modelValue:a(n).organizationParents,"onUpdate:modelValue":e[4]||(e[4]=o=>a(n).organizationParents=o),label:s._lang.label.parentOrganization,loading:a(m),type:a(I).inputs.multiselect,mode:a(I).multiselectMode.tags,options:a(r).organizationParents},null,8,["modelValue","label","loading","type","mode","options"])]),_:1}),d(c,{class:"mt-2 pb-3"},{default:h(()=>[l("div",pe,[l("button",{class:"btn btn-primary medium mb-3",type:"button",onClick:w},[d(G,{color:"#FFF"}),f(" "+i(s._lang.common.search),1)])])]),_:1})]),a(P)?(v(),x(c,{key:0,class:"px-5"},{default:h(()=>[l("div",_e,[a(g).length?(v(),y(O,{key:0},[d(c,null,{default:h(()=>[l("div",{class:"mt-3",innerHTML:a(j)},null,8,ve)]),_:1}),l("div",me,[l("ul",null,[(v(!0),y(O,null,se(a(g),o=>(v(),y("li",{class:"infinite-scroll-item p-hand",onClick:Se=>q(o)},[l("h4",he,i(o.title),1),l("p",be,[l("i",null,i(o.organizationParent),1),f(", "),l("strong",null,i(o.name),1)]),o.address?(v(),y("p",fe,[f(i(o.address.zipCode)+" - "+i(o.address.island)+" ",1),ye,f(" "+i(o.address.county)+", "+i(o.address.parish)+", "+i(o.address.location)+" ",1),Ie,f(" "+i(o.address.address),1)])):A("",!0),o.index==="service"?(v(),y(O,{key:1},[o.category?(v(),y("p",Ce,[f(i(o.type)+" ",1),Pe,f(" "+i(o.category)+" ",1),Ee,f(" "+i(o.economicActivity)+" ",1),Ae])):A("",!0)],64)):A("",!0),l("p",Ve,i(s._lang.label.startDate)+": "+i(o.date),1),ke],8,ge))),256))]),d(ie,{onIntersect:U})])],64)):A("",!0),!a(g).length&&!a(M)?(v(),y("div",{key:1,class:"mt-4",innerHTML:a(N)},null,8,ze)):A("",!0)])]),_:1})):A("",!0)]),_:1})}}},Fe=W(Te,[["__scopeId","data-v-b7d7a61b"]]),Oe={__name:"index",setup(t){return(p,b)=>{const r=T("page");return v(),x(r,{title:p._lang.backoffice.home.pageTitle},{default:h(()=>[d(Fe)]),_:1},8,["title"])}}};export{Oe as default};
