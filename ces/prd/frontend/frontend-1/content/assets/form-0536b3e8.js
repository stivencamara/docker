import{u as re}from"./index.esm-26e5e98d.js";import{_ as ue,a as ce,b as me}from"./contacts-154c5a4f.js";import{_ as pe,a as ge}from"./address.vue_vue_type_style_index_0_scoped_5480b292_lang-5c9173d9.js";import{j as T,k as p,c as L,l as w,m as S,p as t,q as e,J as B,t as m,_ as fe,u as v,r as y,w as be,e as P,n as Y,O as ve,Q as ye,F as le,i as te,K as _e,H as ee,L as oe,o as ne,M as de,N as Ve,E as Ce,f as Se,g as Oe,x as Ie,v as Te,z as j}from"./index-af43a57b.js";import{b as F}from"./helpers-0b287b89.js";import{u as Le}from"./organization-25c5b553.js";import{u as se}from"./point-of-care-3902aa6d.js";import{_ as ke}from"./address-7a25e4a7.js";import{_ as Be,a as Fe}from"./refusal-a7068635.js";import{r as we}from"./index.esm-7a0fc0c5.js";import{_ as Ne}from"./generic-b7841e8a.js";import{p as ae}from"./point-of-care-9754b2ef.js";import{s as Z}from"./service-9ee13c2f.js";import{u as Ee}from"./service-adeb7206.js";import{s as Ae}from"./helpers-74c6ab4d.js";const qe={__name:"description",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},selectedLang:{type:[String,Number],required:!0},validateForm:{type:Boolean,default:!1},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(f,{emit:d}){const n=f;Le();const i=T({get(){return n.modelValue},set(a){d("update:modelValue",a)}}),l=T(()=>n.selectedLang),g=T({get(){return F.getFieldByLangAndName(i.value,l.value,"description")},set(a){F.setFieldByLangAndName(i.value,l.value,"description",a)}}),_=T({get(){return F.getFieldByLangAndName(i.value,l.value,"preConditions")},set(a){F.setFieldByLangAndName(i.value,l.value,"preConditions",a)}});return T({get(){return F.getFieldByLangAndName(i.value,l.value,"keywords")},set(a){F.setFieldByLangAndName(i.value,l.value,"keywords",a)}}),(a,o)=>{const u=p("form-field"),O=p("accordion");return L(),w(O,{id:"description",title:a._lang.common.description,collapsed:!1,class:"mb-4"},{default:S(()=>[t(u,{id:"description",class:"mb-3 col-12",modelValue:e(g),"onUpdate:modelValue":o[0]||(o[0]=c=>B(g)?g.value=c:null),label:a._lang.label.description,disabled:n.disabled,loading:n.loading,type:e(m).inputs.text,maxlength:255,language:e(l)},null,8,["modelValue","label","disabled","loading","type","language"]),t(u,{id:"preConditions",class:"mb-3 col-12",modelValue:e(_),"onUpdate:modelValue":o[1]||(o[1]=c=>B(_)?_.value=c:null),label:a._lang.label.preConditions,disabled:n.disabled,loading:n.loading,type:e(m).inputs.text,maxlength:255,language:e(l)},null,8,["modelValue","label","disabled","loading","type","language"])]),_:1},8,["title"])}}},Me={class:"input-group mb-3"},Re=["aria-describedby"],Ue=["id","disabled"],he={__name:"address",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},validateForm:{type:Boolean,default:!1},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(f,{emit:d}){const n=f,i=se(),l=v.uuid();let g=y(0),_=y(0);const a=y(!1);y(!1);const o=T({get(){return n.modelValue},set(V){d("update:modelValue",V)}}),u="search-location";function O(V){Object.assign(o.value.address,V),g.value++}function c(){_.value++,window.setTimeout(function(){v.showModalById(u)},5)}return be(o.value,V=>{V.address.locationId!=null&&(a.value?(V.address.locationId=null,V.address.code=null,a.value=!1):a.value=!0)}),(V,k)=>{const q=p("icon-search"),I=p("accordion");return L(),P(le,null,[t(I,{id:"address-accordion",title:V._lang.backoffice.entities.address,collapsed:!1,class:"mb-4"},{default:S(()=>[Y("div",Me,[ve(Y("input",{ref:"locationQuery",id:"location-query",type:"text",class:"form-control",placeholder:"Código do património","aria-label":"placeholder","aria-describedby":e(l),disabled:"","onUpdate:modelValue":k[0]||(k[0]=N=>e(o).address.code=N)},null,8,Re),[[ye,e(o).address.code]]),Y("button",{class:"btn btn-primary",type:"button",id:e(l),disabled:n.disabled,onClick:c},[t(q,{color:"#FFF"})],8,Ue)]),(L(),w(ke,{key:e(g),modelValue:e(o).address,"onUpdate:modelValue":k[1]||(k[1]=N=>e(o).address=N),disabled:n.disabled,rules:n.rules,loading:n.loading,"validate-form":n.validateForm&&e(o).address.isRequired,store:e(i),vuelidate:n.vuelidate},null,8,["modelValue","disabled","rules","loading","validate-form","store","vuelidate"]))]),_:1},8,["title"]),(L(),w(ue,{key:e(_),onApply:O}))],64)}}},je=fe(he,[["__scopeId","data-v-5480b292"]]),ze={__name:"service-channel-requirements",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},validateForm:{type:Boolean,default:!1},selectedLang:{type:[String,Number],required:!0},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(f,{emit:d}){const n=f,i=T({get(){return n.modelValue},set(a){d("update:modelValue",a)}}),l=T(()=>n.selectedLang),g=T({get(){return F.getFieldByLangAndName(i.value,l.value,"openingHours")},set(a){F.setFieldByLangAndName(i.value,l.value,"openingHours",a)}}),_=T({get(){return F.getFieldByLangAndName(i.value,l.value,"attendanceRestrictions")},set(a){F.setFieldByLangAndName(i.value,l.value,"attendanceRestrictions",a)}});return(a,o)=>{const u=p("form-field"),O=p("accordion");return L(),w(O,{id:"attendance-restrictions",title:a._lang.backoffice.pointOfCare.serviceChannelRequirements,collapsed:!1,class:"mb-4"},{default:S(()=>[t(u,{id:"openingHours",class:"mb-3 col-12",modelValue:e(g),"onUpdate:modelValue":o[0]||(o[0]=c=>B(g)?g.value=c:null),label:a._lang.label.openingHours,disabled:n.disabled,loading:n.loading,type:e(m).inputs.textarea,rows:3,language:e(l),maxlength:2e3},null,8,["modelValue","label","disabled","loading","type","language"]),t(u,{id:"attendanceRestrictions",class:"mb-3 col-12",modelValue:e(_),"onUpdate:modelValue":o[1]||(o[1]=c=>B(_)?_.value=c:null),label:a._lang.label.attendanceRestrictions,disabled:n.disabled,loading:n.loading,type:e(m).inputs.textarea,rows:3,language:e(l),maxlength:2e3},null,8,["modelValue","label","disabled","loading","type","language"])]),_:1},8,["title"])}}},$e={__name:"general",props:{modelValue:{type:Object,required:!0},selectedLang:we,disabled:{Boolean,default:!0},rules:{Boolean,default:!0},validateForm:{Boolean,default:!1},loading:{Object,default:{}},isExternalEdit:{type:Boolean,default:!1},vuelidate:{type:Object,default:null}},setup(f){const d=f,n=se(),i=re(d.rules,d.modelValue),l=T({get(){return d.modelValue},set(a){emit("update:modelValue",a)}}),g=T(()=>d.selectedLang),_=T(()=>d.selectedLang===m.language.en);return(a,o)=>(L(),P(le,null,[t(Be,{modelValue:e(l),"onUpdate:modelValue":o[0]||(o[0]=u=>B(l)?l.value=u:null),store:e(n)},null,8,["modelValue","store"]),t(e(pe),{modelValue:e(l),"onUpdate:modelValue":o[1]||(o[1]=u=>B(l)?l.value=u:null),disabled:d.disabled,loading:f.loading,selectedLang:d.selectedLang,validateForm:d.validateForm,rules:d.rules,isExternalEdit:d.isExternalEdit,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","validateForm","rules","isExternalEdit","vuelidate"]),t(e(qe),{modelValue:e(l),"onUpdate:modelValue":o[2]||(o[2]=u=>B(l)?l.value=u:null),disabled:d.disabled,loading:f.loading,selectedLang:d.selectedLang,validateForm:d.validateForm,rules:d.rules,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","validateForm","rules","vuelidate"]),t(e(je),{modelValue:d.modelValue,"onUpdate:modelValue":o[3]||(o[3]=u=>d.modelValue=u),disabled:d.disabled,loading:f.loading||e(_),rules:d.rules,validateForm:d.validateForm,vuelidate:e(i)},null,8,["modelValue","disabled","loading","rules","validateForm","vuelidate"]),t(e(ze),{modelValue:e(l),"onUpdate:modelValue":o[4]||(o[4]=u=>B(l)?l.value=u:null),disabled:d.disabled,loading:f.loading,selectedLang:d.selectedLang,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","vuelidate"]),t(e(me),{modelValue:e(l).contacts,"onUpdate:modelValue":o[5]||(o[5]=u=>e(l).contacts=u),disabled:d.disabled||e(_),modal:ce,store:e(n),loading:f.loading},null,8,["modelValue","disabled","store","loading"]),t(e(Fe),{modelValue:e(l),"onUpdate:modelValue":o[6]||(o[6]=u=>B(l)?l.value=u:null),disabled:d.disabled,loading:f.loading,selectedLang:d.selectedLang,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","vuelidate"]),t(Ne,{modelValue:e(l),"onUpdate:modelValue":o[7]||(o[7]=u=>B(l)?l.value=u:null),disabled:d.disabled,loading:f.loading,selectedLang:e(g),vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","vuelidate"])],64))}},Pe={__name:"search-service-modal",props:{pointOfCareId:{Number,required:!0},pointOfCareVersion:{Number,required:!0}},emits:["apply"],setup(f,{emit:d}){const n=f,i=Ee(),l="search-service-modal",g=te(),_=_e();let a=ee(h()),o=y([]),u=y([]),O=y(v.createEmptyDataSource()),c=y(!1),V=y(!1),k=y(0),q=y("pt"),I=ee(N());function N(){return Ae.newForm()}function h(){return{pageNumber:1,sortBy:"Code",code:null,serviceTypeIds:null,serviceCategoryIds:null,businessEventIds:null,lifeEventIds:null,abreviation:null,name:null,organization:null,recordStateIds:[m.recordStateType.published],active:!0}}oe(async()=>{c.value=!0,o.value=v.convertEnumToArray(g.enums.recordStateType);const r=await Z.getLists(_.getLanguage);v.validateResponse(r,null,()=>{i.setLists(r.data),o.value=v.convertEnumToArray(g.enums.recordStateType),u.value=v.concatItemsBadge(o.value,F.recordStateTypeBadgeOptions)}),c.value=!1}),ne(async()=>{await M()});async function z(r){a.sortBy=r,await M()}async function H(r){a.pageNumber=r,await M()}async function M(){c.value=!0;let r=await Z.search(a);v.validateResponse(r,null,()=>{O.value=r.data}),c.value=!1}async function D(){Object.assign(a,h()),await M()}async function K(){await M()}async function R(r){const b=await Z.getById(r.serviceId,r.serviceVersion);v.validateResponse(b,null,()=>{Object.assign(I,b.data),V.value=!0}),k.value++}function x(){}async function Q(){c.value=!0;const r=await ae.associationCreate(n.pointOfCareId,n.pointOfCareVersion,I.serviceId,I.serviceVersion);v.validateResponse(r,g.backoffice.pointOfCare.serviceAdded,()=>{d("apply")}),c.value=!1}return(r,b)=>{const s=p("form-field"),E=p("row"),G=p("cfilter"),U=p("ccolumn"),A=p("table-action-detail"),J=p("ctable"),W=p("container-wrapper"),$=p("cbutton"),X=p("modal");return L(),w(X,{id:l,title:r._lang.backoffice.service.searchTitle,size:e(m).modalSize.extraLarge,"remove-padding":!0},{body:S(()=>[t(G,{title:r._lang.common.filter,disabled:e(c),"clear-click":D,"apply-click":K,loading:e(c),collapsed:!0},{default:S(()=>[t(E,null,{default:S(()=>[t(s,{id:"code",modelValue:e(a).code,"onUpdate:modelValue":b[0]||(b[0]=C=>e(a).code=C),class:"mb-3 col-12 col-md-6 col-xl-4",label:r._lang.label.code,type:e(m).inputs.text,maxlength:45,disabled:e(c)},null,8,["modelValue","label","type","disabled"]),t(s,{id:"serviceTypeId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(a).serviceTypeIds,"onUpdate:modelValue":b[1]||(b[1]=C=>e(a).serviceTypeIds=C),label:r._lang.label.serviceTypeId,type:e(m).inputs.multiselect,options:e(i).serviceTypeList,disabled:e(c),mode:e(m).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),t(s,{id:"serviceCategoryId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(a).serviceCategoryIds,"onUpdate:modelValue":b[2]||(b[2]=C=>e(a).serviceCategoryIds=C),label:r._lang.label.serviceCategoryId,type:e(m).inputs.multiselect,options:e(i).serviceCategoryList,disabled:e(c),mode:e(m).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),t(s,{id:"abreviation",class:"mb-3 col-12 col-md-6",modelValue:e(a).abreviation,"onUpdate:modelValue":b[3]||(b[3]=C=>e(a).abreviation=C),label:r._lang.label.abreviation,type:e(m).inputs.text,maxlength:16,disabled:e(c)},null,8,["modelValue","label","type","disabled"]),t(s,{id:"organizationId",class:"mb-3 col-12 col-md-6",modelValue:e(a).organization,"onUpdate:modelValue":b[4]||(b[4]=C=>e(a).organization=C),label:r._lang.label.organizationHost,type:e(m).inputs.multiselect,options:e(i).organizationList,disabled:e(c),valueProp:e(m).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),t(s,{id:"name",class:"mb-3 col-12",modelValue:e(a).name,"onUpdate:modelValue":b[5]||(b[5]=C=>e(a).name=C),label:r._lang.label.name,type:e(m).inputs.text,maxlength:45,disabled:e(c)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","disabled","loading"]),t(W,null,{default:S(()=>[t(J,{onSort:z,onChangePage:H,data:e(O),checkbox:!1,loading:e(c),defaultSort:"Code"},{columns:S(()=>[t(U,{name:r._lang.label.code,field:"code",sortable:!0},null,8,["name"]),t(U,{name:r._lang.label.serviceTypeId,field:"serviceType",sortField:"serviceTypeId",sortable:!0},null,8,["name"]),t(U,{name:r._lang.label.abreviation,field:"abreviation",sortable:!0},null,8,["name"]),t(U,{name:r._lang.label.name,field:"name",sortable:!0},null,8,["name"]),t(U,{name:r._lang.label.state,field:"recordStateTypeId",align:e(m).columnAlign.center,custom:de,options:e(u),sortable:!0},null,8,["name","align","options"])]),actions:S(C=>[t(A,{onClick:ie=>R(C.item)},null,8,["onClick"])]),_:1},8,["data","loading"])]),_:1}),(L(),w(e(ge),{collapsed:e(V),class:"mt-5",key:e(k),modelValue:e(I),"onUpdate:modelValue":b[6]||(b[6]=C=>B(I)?I.value=C:I=C),disabled:!0,loading:e(c),selectedLang:e(q),validateForm:!1},null,8,["collapsed","modelValue","loading","selectedLang"]))]),footer:S(()=>[t($,{type:"primary",size:"large",title:r._lang.common.apply,"data-bs-dismiss":"modal",onClick:Q,disabled:!e(I).code},null,8,["title","disabled"]),t($,{type:"secondary",size:"large",title:r._lang.common.cancel,"data-bs-dismiss":"modal",onClick:x},null,8,["title"])]),_:1},8,["title","size"])}}},He=["id"],De={__name:"services",props:{formModel:{Object,required:!0}},setup(f){var r,b;const d=f,n=y(Ve.havePermission(m.permissions.pointOfCare.createEdit)&&(((r=d.formModel)==null?void 0:r.recordStateTypeId)==m.recordStateType.draft||((b=d.formModel)==null?void 0:b.recordStateTypeId)==m.recordStateType.published)),i=T(()=>{let s=Ce.getUser();return!s||!s.name?!1:s.name.toLowerCase()==="guest"});ne(()=>{}),oe(async()=>{V.value=v.decodeId(a.params.pointOfCareId),k.value=v.decodeId(a.params.pointOfCareVersion),h.value=v.convertEnumToArray(o.enums.recordStateType),!V.value||!k.value?u.push({name:constants.router.BACKOFFICE_POINT_OF_CARE_PAGE.name}):(I.pointOfCareId=V.value,I.pointOfCareVersion=k.value,await R(),h.value=v.convertEnumToArray(o.enums.recordStateType),z.value=v.concatItemsBadge(h.value,F.recordStateTypeBadgeOptions))});const l="search-service-modal",g="delete-service",_=v.uuid(),a=Se(),o=te(),u=Oe();let O=y(!0),c=y(0),V=y(0),k=y(0),q=y(v.createEmptyDataSource()),I=ee(H()),N=y(null),h=y([]),z=y([]);function H(){let s=null;return i.value&&(s=[m.recordStateType.published]),{pageNumber:1,sortBy:"ServiceName",active:!0,pointOfCareId:null,pointOfCareVersion:null,recordStateTypeIds:s}}function M(){c.value++,window.setTimeout(function(){v.showModalById(l)},5)}async function D(s){I.sortBy=s,await R()}async function K(s){I.pageNumber=s,await R()}async function R(){O.value=!0;let s=await ae.associationSearch(I);v.validateResponse(s,null,()=>{q.value=s.data,q.value.items.forEach(E=>{E.recordStateTypeId=m.recordStateType.submitted,E.pointOfCareRecordStateTypeId==m.recordStateType.published&&E.serviceRecordStateTypeId==m.recordStateType.published?E.recordStateTypeId=m.recordStateType.published:(E.pointOfCareRecordStateTypeId==m.recordStateType.returned||E.serviceRecordStateTypeId==m.recordStateType.returned)&&(E.recordStateTypeId=m.recordStateType.returned)})}),O.value=!1}async function x(s){N.value=s}async function Q(){if(N.value){O.value=!0;const s=await ae.associationRemove(V.value,k.value,N.value.serviceId,N.value.serviceVersion);v.validateResponse(s,o.backoffice.pointOfCare.serviceRemoved,async()=>{await R()}),O.value=!1}}return(s,E)=>{const G=p("icon-plus"),U=p("table-actions"),A=p("ccolumn"),J=p("table-action-delete"),W=p("ctable"),$=p("container-wrapper"),X=p("confirm-delete-modal");return L(),P(le,null,[t($,null,{default:S(()=>[t(U,{title:s._lang.common.tableActionTitle},{default:S(()=>[n.value?(L(),P("button",{key:0,class:"btn btn-primary",type:"button",id:e(_),onClick:M},[t(G,{color:"#FFF"}),Ie(" "+Te(s._lang.common.addService),1)],8,He)):j("",!0)]),_:1},8,["title"]),t(W,{onSort:D,onChangePage:K,data:e(q),checkbox:!1,loading:e(O),defaultSort:"ServiceName",checkboxField:"code"},{columns:S(()=>[t(A,{name:s._lang.label.code,field:"serviceCode",sortable:!0},null,8,["name"]),t(A,{name:s._lang.label.channelTypeId,field:"serviceType",sortField:"serviceType",sortable:!0},null,8,["name"]),t(A,{name:s._lang.label.abreviation,field:"serviceOrganization",sortField:"serviceOrganizationId",sortable:!0},null,8,["name"]),t(A,{name:s._lang.label.name,field:"serviceName",sortable:!0},null,8,["name"]),t(A,{name:s._lang.label.organizationHost,field:"serviceOrganization",sortField:"serviceOrganizationId",sortable:!0},null,8,["name"]),t(A,{name:s._lang.label.state,field:"recordStateTypeId",align:e(m).columnAlign.center,custom:de,options:e(z),sortable:!0},null,8,["name","align","options"])]),actions:S(C=>[e(i)?j("",!0):(L(),w(J,{key:0,id:g,onClick:ie=>x(C.item)},null,8,["onClick"]))]),_:1},8,["data","loading"])]),_:1}),e(O)?j("",!0):(L(),w(Pe,{key:e(c),pointOfCareId:e(V),pointOfCareVersion:e(k),onApply:R},null,8,["pointOfCareId","pointOfCareVersion"])),t(X,{id:g,title:s._lang.backoffice.pointOfCare.serviceDeleteTitle,message:s._lang.backoffice.pointOfCare.serviceDeleteQuestion,action:Q},null,8,["title","message"])],64)}}},da={__name:"form",props:{formModel:{Object,required:!0},loading:{type:Boolean,required:!0},validateForm:{type:Boolean,required:!0},disabled:{type:Boolean,required:!0},isExternalEdit:{type:Boolean,required:!0},selectedLang:{type:[Number,String],required:!0},rules:{type:Object,required:!0},vuelidate:{Object,default:null},showProgress:{type:Boolean,default:!0},progressValue:{type:[Number],required:!1}},emits:["update:formModel"],setup(f,{emit:d}){const n=f,i=T({get(){return n.formModel},set(l){d("update:formModel",l)}});return(l,g)=>{const _=p("progress-bar"),a=p("container-wrapper"),o=p("tab-content"),u=p("tabs");return L(),w(u,null,{default:S(()=>[t(o,{id:"general",title:l._lang.common.general,active:!0},{default:S(()=>[n.showProgress?(L(),w(a,{key:0,"margin-top":!1},{default:S(()=>[n.showProgress?(L(),w(_,{key:0,value:n.progressValue,label:l._lang.common.fill,class:"mb-4 col-12 float-end"},null,8,["value","label"])):j("",!0)]),_:1})):j("",!0),t($e,{modelValue:e(i),"onUpdate:modelValue":g[0]||(g[0]=O=>B(i)?i.value=O:null),disabled:n.disabled,validateForm:n.validateForm,loading:n.loading,selectedLang:n.selectedLang,rules:n.rules},null,8,["modelValue","disabled","validateForm","loading","selectedLang","rules"])]),_:1},8,["title"]),t(o,{id:"services",title:l._lang.backoffice.menu.services,active:!1,disabled:!1},{default:S(()=>[t(De,{formModel:e(i)},null,8,["formModel"])]),_:1},8,["title"])]),_:1})}}};export{da as _};
