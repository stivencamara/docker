import{g as G,f as K,i as D,h as H,r as s,G as L,s as h,j as C,M as U,K as j,u as v,z as o,N as Y,k as _,c as d,l as c,w as I,n as b,p as e,I as z,y as q}from"./index-a14ad215.js";import{o as E}from"./organization-b89a586c.js";import{u as J}from"./organization-4f7bdfd2.js";import{o as R}from"./helpers-d171baff.js";import{_ as x}from"./detail-actions-e07ee9c0.js";import{_ as Q}from"./form-2869ce5f.js";import"./helpers-71142cd6.js";import"./index.esm-88a1129f.js";import"./refusal-4e803a93.js";import"./helpers-bdeacb10.js";import"./helpers-682b85b1.js";import"./helpers-11fd24aa.js";import"./helpers-a264fdb9.js";import"./helpers-bd233d9c.js";import"./settings-739a4c13.js";import"./contacts-5142be00.js";import"./index.esm-97dcd533.js";import"./location-504e7ab6.js";import"./address-809a8351.js";import"./generic-90322b29.js";import"./point-of-care-4055b36e.js";import"./service-a0c37778.js";import"./document-fd012777.js";const Ee={__name:"detail",setup(W){const V=G(),p=K();D();const y=H(),F=J(),l=s(0),u=s(0);let r=s(!0),i=L(R.newForm()),n=s(h.language.pt);s([]);let S=L(R.formRules()),g=s(null);const T=C(()=>p.path.toLowerCase().indexOf("tarefas")>-1),A=C(()=>p.path.toLowerCase().indexOf("pesquisa")>-1),k=s(U.havePermission(h.permissions.organization.createEdit));j(async()=>{l.value=v.decodeId(p.params.organizationId),u.value=v.decodeId(p.params.organizationVersion),!l.value||!u.value?V.push({name:o.router.BACKOFFICE_ENTITIES_PAGE.name}):(await O(),await B(),w.value&&(await g.value.getHistory(),g.value.setActiveVersion(u.value),g.value.setStep()))});const w=C(()=>!T.value&&k.value&&i.recordStateTypeId!=h.recordStateType.draft);async function B(){const t=await E.getById(l.value,u.value);v.validateResponse(t,null,()=>{Object.assign(i,t.data),y.emit(o.emitter.OBJECT_LOADED,t.data)})}async function O(){r.value=!0;const t=await E.getLists(n.value);v.validateResponse(t,null,()=>{F.setLists(t.data)}),r.value=!1}return Y(()=>n.value,()=>{O()}),(t,m)=>{const f=_("breadcrumb-item"),N=_("breadcrumb"),M=_("ctimeline"),P=_("page");return d(),c(P,{title:t._lang.backoffice.entities.detailPageTitle},{breadcrumb:I(()=>[b(N,{"has-home":!e(A)},{default:I(()=>[e(T)?(d(),c(f,{key:0,label:t._lang.backoffice.tasks.breadcrumbTitle,"router-path":e(o).router.BACKOFFICE_TASKS_PAGE.path},null,8,["label","router-path"])):e(A)?(d(),c(f,{key:1,label:t._lang.search.pageTitle,"router-path":e(o).router.HOME_PAGE.path},null,8,["label","router-path"])):(d(),c(f,{key:2,label:t._lang.backoffice.entities.breadcrumbTitle,"router-path":e(o).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"])),b(f,{label:t._lang.backoffice.entities.detail},null,8,["label"])]),_:1},8,["has-home"])]),actions:I(()=>[b(x,{loading:e(r),"onUpdate:loading":m[0]||(m[0]=a=>z(r)?r.value=a:r=a),selectedLang:e(n),"onUpdate:selectedLang":m[1]||(m[1]=a=>z(n)?n.value=a:n=a),service:e(E),backRoute:e(o).router.BACKOFFICE_ENTITIES_PAGE.name,editRoute:e(o).router.BACKOFFICE_EDIT_ENTITY_PAGE.name,itemIdField:"organizationId",itemVersionField:"organizationVersion",itemId:l.value,itemVersion:u.value,formModel:e(i),"show-record-state-actions":e(T),store:e(F)},null,8,["loading","selectedLang","service","backRoute","editRoute","itemId","itemVersion","formModel","show-record-state-actions","store"])]),default:I(()=>[e(w)?(d(),c(M,{key:0,itemId:l.value,detailRoute:e(o).router.BACKOFFICE_DETAIL_ENTITY_PAGE.name,service:e(E),versionFieldName:"organizationVersion",dateFieldName:"organizationApprovedDate",detailRouteIdField:"organizationId",detailRouteVersionField:"organizationVersion",ref_key:"timeline",ref:g},null,8,["itemId","detailRoute","service"])):q("",!0),b(Q,{formModel:e(i),"onUpdate:formModel":m[2]||(m[2]=a=>z(i)?i.value=a:i=a),disabled:!0,validateForm:!0,selectedLang:e(n),rules:e(S),loading:e(r),organizationId:l.value,organizationVersion:u.value,"show-progress":!1,vuelidate:null,canCreate:k.value},null,8,["formModel","selectedLang","rules","loading","organizationId","organizationVersion","canCreate"])]),_:1},8,["title"])}}};export{Ee as default};
