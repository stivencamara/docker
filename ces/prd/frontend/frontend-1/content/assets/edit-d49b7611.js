import{L as h,u as d,A as L,o as j,r as i,H as y,t as F,i as G,g as K,f as z,w as T,j as w,k as c,c as W,l as q,m as u,p as r,q as a,J as m,W as D}from"./index-af43a57b.js";import{l as V}from"./location-5ea34e4e.js";import{u as J,_ as Q,a as X}from"./address-fe5757d0.js";import{a as Y}from"./refusal-a7068635.js";import{u as Z}from"./index.esm-26e5e98d.js";import{h as C}from"./helpers-817eb43d.js";import{b as $}from"./helpers-0b287b89.js";import{e as x}from"./edit-actions-e0b46285.js";import"./address-7a25e4a7.js";import"./index.esm-7a0fc0c5.js";import"./cancel-confirm-3c568d61.js";import"./settings-da6dde1b.js";/* empty css                                                                     */const ge={__name:"edit",setup(ee){h(async()=>{p.value=d.decodeId(O.params.locationId),g.value=d.decodeId(O.params.locationVersion),!p.value||!g.value?S.push({name:L.router.BACKOFFICE_LOCATION_PAGE.name}):(await B(),await A())}),j(()=>{t.value=!1});let p=i(0),g=i(0),t=i(!0);i([]);let e=y(C.newForm()),n=i(F.language.pt),v=y(C.formRules()),b=i(0),_=i([]),R=i(!1);const f=J();G();const S=K(),O=z(),I=Z(v,e);async function B(){t.value=!0;const o=await V.getById(p.value,g.value);d.validateResponse(o,null,()=>{Object.assign(e,o.data),f.setFormToCompare(d.cloneObject(o.data))}),t.value=!1}async function A(){t.value=!0;const o=await V.getLists(n.value,e.recordStateTypeId!=F.recordStateType.draft);d.validateResponse(o,null,()=>{f.setLists(o.data)}),t.value=!1}T(()=>n.value,()=>{A()}),T(()=>[e.code,e.startDate,e.zipCode,e.islandId,e.countyId,e.parishId,e.locationTypeId,e.locationId,e.organization,e.address,e.locality],()=>{_.value=C.progressFields(),$.calculatePercentage(e,_.value,o=>{f.setProgress(o),b.value=o})});const E=w(()=>b.value===100&&!t.value),P=w(()=>n.value===F.language.en);return(o,s)=>{const k=c("breadcrumb-item"),M=c("breadcrumb"),N=c("progress-bar"),U=c("card"),H=c("page");return W(),q(H,{title:o._lang.backoffice.location.editPageTitle},{actions:u(()=>[r(x,{loading:a(t),"onUpdate:loading":s[0]||(s[0]=l=>m(t)?t.value=l:t=l),canSubmit:a(E),selectedLang:a(n),"onUpdate:selectedLang":s[1]||(s[1]=l=>m(n)?n.value=l:n=l),backRoute:a(L).router.BACKOFFICE_LOCATION_PAGE.name,service:a(V),itemId:a(p),itemVersion:a(g),formModel:a(e),vuelidate:a(I),store:a(f),resource:o._lang.backoffice.location,itemIdField:"locationId",progressFields:a(_),organicOrigin:a(R),isHeritage:!0},null,8,["loading","canSubmit","selectedLang","backRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource","progressFields","organicOrigin"])]),breadcrumb:u(()=>[r(M,{"has-home":!0},{default:u(()=>[r(k,{label:o._lang.backoffice.location.breadcrumbTitle,"router-path":a(L).router.BACKOFFICE_LOCATION_PAGE.path},null,8,["label","router-path"]),r(k,{label:o._lang.backoffice.location.editPageTitle},null,8,["label"])]),_:1})]),default:u(()=>[r(U,{shadow:!0},{body:u(()=>[r(D,{"margin-top":!1},{default:u(()=>[r(N,{value:a(b),label:o._lang.common.fill,class:"mb-4 col-12 float-end"},null,8,["value","label"])]),_:1}),r(Q,{validateForm:!0,modelValue:a(e),"onUpdate:modelValue":s[2]||(s[2]=l=>m(e)?e.value=l:e=l),loading:a(t),rules:a(v),selectedLang:a(n),vuelidate:a(I)},null,8,["modelValue","loading","rules","selectedLang","vuelidate"]),r(X,{validateForm:!0,modelValue:a(e),"onUpdate:modelValue":s[3]||(s[3]=l=>m(e)?e.value=l:e=l),loading:a(t),rules:a(v),disabled:a(P),vuelidate:a(I)},null,8,["modelValue","loading","rules","disabled","vuelidate"]),r(Y,{validateForm:!0,modelValue:a(e),"onUpdate:modelValue":s[4]||(s[4]=l=>m(e)?e.value=l:e=l),loading:a(t),selectedLang:a(n)},null,8,["modelValue","loading","selectedLang"])]),_:1})]),_:1},8,["title"])}}};export{ge as default};
