import{g as Z,i as $,K as ee,r,v as n,j as L,u as i,L as te,o as le,N as ae,l as u,c as b,m as g,n as c,q as d,s as e,U as oe,A as S,W as ne,J as k,M as de,B as E}from"./index-957232d9.js";import{d as U}from"./document-e0533450.js";import{u as se}from"./document-d65044cc.js";import{d as ie}from"./helpers-1d07bcfe.js";import{b as ue}from"./helpers-e58dedc6.js";import"./index.esm-b6709f5c.js";const fe={__name:"index",setup(ce){const T=Z(),w=$(),V=se(),M=ee();let s=r(!1),y=r([]),f=r([]),I=r(n.tableSelectedState.none),o=L(O()),v=r([]),A=r([]),B=r(i.createEmptyDataSource());L({});function O(){return{pageNumber:1,sortBy:"Code",code:null,documentTypeIds:null,abreviation:null,name:null,recordStateIds:[n.recordStateType.published],active:!0,organization:null}}te(async()=>{s.value=!0,v.value=i.convertEnumToArray(w.enums.recordStateType);const t=await U.getLists(M.getLanguage);i.validateResponse(t,null,()=>{V.setLists(t.data),v.value=i.convertEnumToArray(w.enums.recordStateType),A.value=i.concatItemsBadge(v.value,ue.recordStateTypeBadgeOptions)}),s.value=!1}),le(async()=>{await _()});function z(t){T.push({name:E.router.BACKOFFICE_EDIT_DOCUMENT_PAGE.name,params:{documentId:i.encodeId(t.documentId),documentVersion:i.encodeId(t.documentVersion)}})}function N(t){T.push({name:E.router.BACKOFFICE_DETAIL_DOCUMENT_PAGE.name,params:{documentId:i.encodeId(t.documentId),documentVersion:i.encodeId(t.documentVersion)}})}async function P(){Object.assign(o,O()),await F()}async function F(){o.pageNumber=1,await _()}async function D(){s.value=!0;const t=await U.create(ie.newForm());i.validateResponse(t,null,()=>{const a=i.encodeId(t.data.documentId),C=i.encodeId(t.data.documentVersion);T.push({name:E.router.BACKOFFICE_EDIT_DOCUMENT_PAGE.name,params:{documentId:a,documentVersion:C}})}),s.value=!1}async function R(t){o.sortBy=t,await _()}async function G(t){o.pageNumber=t,await _()}async function _(){s.value=!0;let t=await U.search(o);i.validateResponse(t,null,()=>{B.value=t.data}),s.value=!1}const K=r(ae.havePermission(n.permissions.document.createEdit));return(t,a)=>{const C=u("breadcrumb-item"),H=u("breadcrumb"),j=u("cbutton"),m=u("form-field"),x=u("row"),W=u("cfilter"),p=u("ccolumn"),q=u("table-action-edit"),J=u("table-action-detail"),h=u("ctable"),Q=u("card"),X=u("page");return b(),g(X,{title:t._lang.backoffice.document.pageTitle},{breadcrumb:c(()=>[d(H,{"has-home":!0},{default:c(()=>[d(C,{label:t._lang.backoffice.document.breadcrumbTitle},null,8,["label"])]),_:1})]),actions:c(()=>[K.value?(b(),g(j,{key:0,class:"col-12 col-sm-auto",type:e(n).buttonType.secondary,size:e(n).buttonSize.medium,title:t._lang.common.toAdd,icon:oe,onClick:D},null,8,["type","size","title"])):S("",!0)]),default:c(()=>[d(Q,{shadow:!0},{body:c(()=>[d(W,{title:t._lang.common.filter,disabled:e(s),"clear-click":P,"apply-click":F,loading:e(s),collapsed:!0},{default:c(()=>[d(x,null,{default:c(()=>[d(m,{id:"code",modelValue:e(o).code,"onUpdate:modelValue":a[0]||(a[0]=l=>e(o).code=l),class:"mb-3 col-12 col-md-6 col-xl-4",label:t._lang.label.code,type:e(n).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),d(m,{class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).documentTypeIds,"onUpdate:modelValue":a[1]||(a[1]=l=>e(o).documentTypeIds=l),label:t._lang.label.documentTypeId,type:e(n).inputs.multiselect,options:e(V).documentTypeList,disabled:e(s),mode:e(n).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),d(m,{id:"organization",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).organization,"onUpdate:modelValue":a[2]||(a[2]=l=>e(o).organization=l),label:t._lang.label.organizationHost,type:e(n).inputs.multiselect,options:e(V).organizationList,disabled:e(s),valueProp:e(n).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),d(m,{class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).abreviation,"onUpdate:modelValue":a[3]||(a[3]=l=>e(o).abreviation=l),label:t._lang.label.abreviation,type:e(n).inputs.text,maxlength:16,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),d(m,{id:"name",class:"mb-3 col-12 col-md-8",modelValue:e(o).name,"onUpdate:modelValue":a[4]||(a[4]=l=>e(o).name=l),label:t._lang.label.name,type:e(n).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),d(m,{id:"recordStateIds",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).recordStateIds,"onUpdate:modelValue":a[5]||(a[5]=l=>e(o).recordStateIds=l),label:t._lang.label.state,type:e(n).inputs.multiselect,options:e(v),disabled:e(s),mode:e(n).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),t._isGuestLogged?S("",!0):(b(),g(m,{key:0,id:"active",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).active,"onUpdate:modelValue":a[6]||(a[6]=l=>e(o).active=l),label:t._lang.label.public,type:e(n).inputs.checkbox,disabled:e(s)},null,8,["modelValue","label","type","disabled"]))]),_:1})]),_:1},8,["title","disabled","loading"]),d(ne,null,{default:c(()=>[d(h,{onSort:R,onChangePage:G,selectedItems:e(y),"onUpdate:selectedItems":a[7]||(a[7]=l=>k(y)?y.value=l:y=l),unselectedItems:e(f),"onUpdate:unselectedItems":a[8]||(a[8]=l=>k(f)?f.value=l:f=l),selectedState:e(I),"onUpdate:selectedState":a[9]||(a[9]=l=>k(I)?I.value=l:I=l),data:e(B),checkbox:!1,loading:e(s),defaultSort:"pointOfCareId",checkboxField:"code"},{columns:c(()=>[d(p,{name:t._lang.label.code,field:"code",sortable:!0},null,8,["name"]),d(p,{name:t._lang.label.documentTypeId,field:"documentType",sortField:"documentTypeId",sortable:!0},null,8,["name"]),d(p,{name:t._lang.label.abreviation,field:"abreviation",sortable:!0},null,8,["name"]),d(p,{name:t._lang.label.name,field:"name",sortable:!0},null,8,["name"]),d(p,{name:t._lang.label.state,field:"recordStateTypeId",align:e(n).columnAlign.center,custom:de,options:e(A),sortable:!0},null,8,["name","align","options"])]),actions:c(l=>[l.item.recordStateTypeId==e(n).recordStateType.draft?(b(),g(q,{key:0,onClick:Y=>z(l.item)},null,8,["onClick"])):S("",!0),l.item.recordStateTypeId>e(n).recordStateType.draft?(b(),g(J,{key:1,onClick:Y=>N(l.item)},null,8,["onClick"])):S("",!0)]),_:1},8,["selectedItems","unselectedItems","selectedState","data","loading"])]),_:1})]),_:1})]),_:1},8,["title"])}}};export{fe as default};
