import{u as $}from"./index.esm-d064d6e3.js";import{c as k,r as z,e as E,m as M}from"./index.esm-d0811cb6.js";import{v as I,x as T,r as C,m as U,h as N,y as K,a as b,b as f,c as P,w as G,g as d,z as O,f as e,d as r,A,k as B,F as W,t as j,B as F,i as H,C as S,n as h,q as _,s as J}from"./index-920dbb37.js";const Q={login:u=>I.post("/system/login",{clientId:u.clientId,clientSecret:u.clientSecret})},oe="/images/login.svg",X="/images/logo-blue.svg";const Y=d("div",{class:"text-center mb-5"},[d("img",{width:"220",alt:"CES",src:X})],-1),Z={class:"d-grid gap-4 py-3"},x={key:0,class:"m-auto"},ee={class:"d-grid gap-4 py-3"},te={__name:"login",props:{disabled:{type:Boolean,default:!1}},setup(u){const c=u,w=T();let l=C(!1);const V=U(),{executeRecaptcha:q,recaptchaLoaded:D}=N();let o=K({username:"stiven.camara@babelgroup.com",password:"P@ssw0rd",recaptchaToken:null}),t=C(!1);const y=k.withMessage(w.common.requiredField,z),L={username:{required:y,email:E},password:{required:y,minLength:k.withMessage(({$params:a})=>w.common.minLengthField.replace("{0}",a.min),M(8))}},n=$(L,o);async function R(){if(l.value=!0,await n.value.$validate(),!n.value.$error){await D();const a=await q("login");if(a){o.recaptchaToken=a;const s=await S.backofficeLogin(o);h.validateResponse(s,null,()=>{const m=s.data.token,i=s.data.expiration,g=_.create(m,i);_.setUser(g),V.push({name:J.router.BACKOFFICE_TASKS_PAGE.name})})}}l.value=!1}async function v(){l.value=!0;let a=await Q.login({clientId:"B2881296-50A3-4FB2-A16C-2D298A718B3C",clientSecret:"25853D3A-5227-43BA-9449-D1EBC397D9D9"});await h.validateResponseAsync(a,null,async()=>{_.setSys(a.data);let s=await S.getUrl("B2881296-50A3-4FB2-A16C-2D298A718B3C");h.validateResponse(s,null,()=>{window.location.href=s.data})}),l.value=!1}return(a,s)=>{const m=b("form-field"),i=b("cbutton"),g=b("card");return f(),P(g,{"card-login":""},{body:G(()=>[d("form",null,[Y,d("div",{class:O(["login-backoffice",{show:e(t)}])},[r(m,{autocomplete:"email",type:e(A).inputs.email,id:"email",label:a._lang.label.email,required:!0,class:"mb-3",modelValue:e(o).username,"onUpdate:modelValue":s[0]||(s[0]=p=>e(o).username=p),disabled:e(l),"show-error":e(n).username.$error,"error-message":a._errorMessageField(e(n).username),placeholder:a._lang.common.add},null,8,["type","label","modelValue","disabled","show-error","error-message","placeholder"]),r(m,{type:e(A).inputs.password,id:"password",label:a._lang.label.password,required:!0,class:"mb-3",modelValue:e(o).password,"onUpdate:modelValue":s[1]||(s[1]=p=>e(o).password=p),disabled:e(l),"show-error":e(n).password.$error,"error-message":a._errorMessageField(e(n).password),placeholder:a._lang.common.add},null,8,["type","label","modelValue","disabled","show-error","error-message","placeholder"]),d("div",Z,[r(i,{type:"primary",size:"large",title:a._lang.backoffice.login.enter,onClick:R,disabled:c.disabled||e(l)},null,8,["title","disabled"]),r(i,{type:"secondary",size:"large",title:a._lang.backoffice.login.graidAuthentication,onClick:v,disabled:c.disabled||e(l)},null,8,["title","disabled"])])],2),e(t)?F("",!0):(f(),B(W,{key:0},[c.disabled?(f(),B("p",x,j(a._lang.backoffice.login.loading),1)):F("",!0),d("div",ee,[r(i,{type:"secondary",size:"large",title:a._lang.backoffice.login.graidAuthentication,onClick:v,disabled:c.disabled||e(l)},null,8,["title","disabled"]),r(i,{type:"primary",size:"large",title:a._lang.backoffice.login.enterWithAdmin,onClick:s[2]||(s[2]=p=>H(t)?t.value=!e(t):t=!e(t)),disabled:c.disabled||e(l)},null,8,["title","disabled"])])],64))])]),_:1})}}};export{te as _,oe as a};
