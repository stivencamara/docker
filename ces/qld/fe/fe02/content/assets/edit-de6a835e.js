import{_ as N}from"./form-513671f9.js";import{m as j,N as D,x as H,r as i,y as B,A as p,I as R,O as h,L as x,n as u,s as v,a as _,b as T,c as Y,w as I,d as l,f as e,k as L,F as P,i as k}from"./index-920dbb37.js";import{s as y}from"./helpers-65b02008.js";import{u as q}from"./service-e327b247.js";import{u as J}from"./index.esm-d064d6e3.js";import{s as C}from"./service-6e6aa2ba.js";import{b as Q}from"./helpers-4c156364.js";import{e as W}from"./edit-actions-4d0f80fb.js";import"./index.esm-d0811cb6.js";import"./base-information-c108b44d.js";import"./point-of-care-98c47a98.js";import"./form-90b3a9cf.js";import"./settings-bb7269a2.js";import"./comments-3b769030.js";import"./generic-9b68486a.js";import"./point-of-care-5c4c4d1a.js";import"./organization-481d97d6.js";import"./helpers-db4b16e6.js";import"./helpers-6935922b.js";import"./cancel-confirm-33e0b7cc.js";import"./helpers-93ac209f.js";import"./helpers-952742ca.js";import"./helpers-cd5e71d3.js";/* empty css                                                                     */const ke={__name:"edit",setup(X){const S=j(),c=D(),w=H(),g=q();let o=i(!0),a=B(y.newForm()),n=i(p.language.pt);i([]);let F=B(y.formRules()),f=i(0),b=i(0),E=i(0),m=i(0),z=i(0);const O=J(F,a),M=R(()=>E.value===100&&!o.value);async function U(){o.value=!0;const r=await C.getById(f.value,b.value);u.validateResponse(r,null,()=>{let t=r.data;t.eventTypeId=t.lifeEventId?p.eventType.life:p.eventType.business,t.processingTime.type=t.processingTime.weeks?p.processingTimeType.simplified:p.processingTimeType.advanced,Object.assign(a,t),g.setFormToCompare(u.cloneObject(t))}),o.value=!1}async function V(){o.value=!0;const r=await C.getLists(n.value);u.validateResponse(r,null,()=>{g.setLists(r.data)}),o.value=!1}h(()=>n.value,()=>{V()}),x(async()=>{f.value=u.decodeId(c.params.serviceId),b.value=u.decodeId(c.params.serviceVersion),m.value=u.decodeId(c.params.organizationId),z.value=u.decodeId(c.params.organizationVersion),!f.value||!b.value?S.push({name:v.router.BACKOFFICE_SERVICE_PAGE.name}):(await V(),await U())}),h(()=>[a.texts[0].name,a.organization,a.serviceTypeId,a.serviceCategoryId,a.startDate,a.economicActivityId,a.cost,a.virtual,a.serviceUrl],()=>{let r=y.progressFields();a.virtual?r.push("serviceUrl"):a.serviceUrl=null,Q.calculatePercentage(a,r,t=>{g.setProgress(t),E.value=t})});const A=R(()=>m.value>0?`${v.router.BACKOFFICE_EDIT_ENTITY_PAGE.path.replace(":organizationId",c.params.organizationId).replace(":organizationVersion",c.params.organizationVersion)}#servicos`:v.router.BACKOFFICE_SERVICE_PAGE.name);return(r,t)=>{const d=_("breadcrumb-item"),G=_("breadcrumb"),K=_("page");return T(),Y(K,{title:r._lang.backoffice.service.editPageTitle},{breadcrumb:I(()=>[l(G,{"has-home":!0},{default:I(()=>[e(m)>0?(T(),L(P,{key:0},[l(d,{label:r._lang.backoffice.entities.breadcrumbTitle,"router-path":e(v).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),l(d,{label:e(w).common.entity,"router-path":e(A)},null,8,["label","router-path"]),l(d,{label:r._lang.backoffice.service.editPageTitle},null,8,["label"])],64)):(T(),L(P,{key:1},[l(d,{label:r._lang.backoffice.service.breadcrumbTitle,"router-path":e(v).router.BACKOFFICE_SERVICE_PAGE.path},null,8,["label","router-path"]),l(d,{label:r._lang.backoffice.service.editPageTitle},null,8,["label"])],64))]),_:1})]),actions:I(()=>[l(W,{loading:e(o),"onUpdate:loading":t[0]||(t[0]=s=>k(o)?o.value=s:o=s),canSubmit:e(M),selectedLang:e(n),"onUpdate:selectedLang":t[1]||(t[1]=s=>k(n)?n.value=s:n=s),backRoute:e(A),directBackRoute:e(m)>0,service:e(C),itemId:e(f),itemVersion:e(b),itemIdField:"serviceId",formModel:e(a),vuelidate:e(O),store:e(g),resource:r._lang.backoffice.service},null,8,["loading","canSubmit","selectedLang","backRoute","directBackRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource"])]),default:I(()=>[l(N,{formModel:e(a),"onUpdate:formModel":t[2]||(t[2]=s=>k(a)?a.value=s:a=s),disabled:!1,loading:e(o),selectedLang:e(n),validateForm:!0,rules:e(F),isExternalEdit:e(m)>0,progressValue:e(E)},null,8,["formModel","loading","selectedLang","rules","isExternalEdit","progressValue"])]),_:1},8,["title"])}}};export{ke as default};
