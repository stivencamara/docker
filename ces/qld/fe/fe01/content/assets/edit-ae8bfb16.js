import{_ as K}from"./general-76c6c110.js";import{m as j,N as H,x as Y,r as s,y as A,A as q,I as V,O as h,L as x,n as i,s as f,a as m,b as E,c as J,w as c,d as o,f as e,k as w,F as L,i as k}from"./index-920dbb37.js";import{d as F}from"./helpers-cd5e71d3.js";import{u as Q}from"./document-d7f3e26b.js";import{u as W}from"./index.esm-d064d6e3.js";import{d as C}from"./document-875ae5ad.js";import{b as X}from"./helpers-4c156364.js";import{e as Z}from"./edit-actions-4d0f80fb.js";import"./comments-3b769030.js";import"./index.esm-d0811cb6.js";import"./generic-9b68486a.js";import"./cancel-confirm-33e0b7cc.js";import"./settings-bb7269a2.js";import"./helpers-93ac209f.js";import"./helpers-65b02008.js";import"./helpers-6935922b.js";import"./helpers-952742ca.js";import"./helpers-db4b16e6.js";/* empty css                                                                     */const Ie={__name:"edit",setup($){const O=j(),d=H(),P=Y(),p=Q();let r=s(!0),t=A(F.newForm()),n=s(q.language.pt);s([]);let T=A(F.formRules()),_=s(0),I=s(0),g=s(0),v=s(0);const R=W(T,t),z=V(()=>I.value===100&&!r.value);async function M(){r.value=!0;let a=await C.getById(_.value,v.value);i.validateResponse(a,null,async()=>{Object.assign(t,a.data),p.setFormToCompare(i.cloneObject(a.data))}),r.value=!1}async function B(){r.value=!0;const a=await C.getLists(n.value);i.validateResponse(a,null,()=>{p.setLists(a.data),p.setFormToCompare(a.data)}),r.value=!1}h(()=>n.value,()=>{B()}),x(async()=>{_.value=i.decodeId(d.params.documentId),v.value=i.decodeId(d.params.documentVersion),g.value=i.decodeId(d.params.organizationId),!_.value||!v.value?O.push({name:f.router.BACKOFFICE_DOCUMENT_PAGE.name}):(await B(),await M())}),h(()=>[t.texts[0].name,t.organization,t.documentTypeId,t.startDate,t.document],()=>{X.calculatePercentage(t,F.progressFields(),a=>{p.setProgress(a),I.value=a})});const y=V(()=>g.value>0?`${f.router.BACKOFFICE_EDIT_ENTITY_PAGE.path.replace(":organizationId",d.params.organizationId).replace(":organizationVersion",d.params.organizationVersion)}#documentos`:f.router.BACKOFFICE_DOCUMENT_PAGE.name);return(a,u)=>{const b=m("breadcrumb-item"),N=m("breadcrumb"),S=m("progress-bar"),D=m("container-wrapper"),U=m("card"),G=m("page");return E(),J(G,{title:a._lang.backoffice.document.editPageTitle},{breadcrumb:c(()=>[o(N,{"has-home":!0},{default:c(()=>[e(g)>0?(E(),w(L,{key:0},[o(b,{label:a._lang.backoffice.entities.breadcrumbTitle,"router-path":e(f).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),o(b,{label:e(P).common.entity,"router-path":e(y)},null,8,["label","router-path"]),o(b,{label:a._lang.backoffice.document.editPageTitle},null,8,["label"])],64)):(E(),w(L,{key:1},[o(b,{label:a._lang.backoffice.document.breadcrumbTitle,"router-path":e(f).router.BACKOFFICE_DOCUMENT_PAGE.path},null,8,["label","router-path"]),o(b,{label:a._lang.backoffice.document.editPageTitle},null,8,["label"])],64))]),_:1})]),actions:c(()=>[o(Z,{loading:e(r),"onUpdate:loading":u[0]||(u[0]=l=>k(r)?r.value=l:r=l),canSubmit:e(z),selectedLang:e(n),"onUpdate:selectedLang":u[1]||(u[1]=l=>k(n)?n.value=l:n=l),backRoute:e(y),directBackRoute:e(g)>0,service:e(C),itemId:e(_),itemVersion:e(v),formModel:e(t),vuelidate:e(R),store:e(p),resource:a._lang.backoffice.document,itemIdField:"documentId"},null,8,["loading","canSubmit","selectedLang","backRoute","directBackRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource"])]),default:c(()=>[o(U,{shadow:!0},{body:c(()=>[o(D,{"margin-top":!1},{default:c(()=>[o(S,{value:e(I),label:a._lang.common.fill,class:"mb-4 col-12 float-end"},null,8,["value","label"])]),_:1}),o(K,{modelValue:e(t),"onUpdate:modelValue":u[2]||(u[2]=l=>k(t)?t.value=l:t=l),disabled:!1,loading:e(r),selectedLang:e(n),validateForm:!0,rules:e(T),isExternalEdit:e(g)>0},null,8,["modelValue","loading","selectedLang","rules","isExternalEdit"])]),_:1})]),_:1},8,["title"])}}};export{Ie as default};
