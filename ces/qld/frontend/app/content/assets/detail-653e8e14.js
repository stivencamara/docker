import{_ as j}from"./form-c3577b0d.js";import{h as q,C as U,q as x,D as z,i as r,s as V,v as l,E as F,M as J,N as Y,K as Q,j as d,l as s,r as E,o as p,c as v,w as b,a as I,m as e,z as S,y as W}from"./index-d8a56bcc.js";import{s as k}from"./helpers-eb16543c.js";import{u as X}from"./service-3c534453.js";import{s as C}from"./service-123d0948.js";import"./helpers-d89764d1.js";/* empty css                                                                     */import{_ as Z}from"./detail-actions-61125ebe.js";import"./index.esm-d77c3574.js";import"./address.vue_vue_type_style_index_0_scoped_2266ba05_lang-1cc0e248.js";import"./index.esm-90cb40dd.js";import"./point-of-care-da1e0f34.js";import"./form-62456af2.js";import"./settings-55cfd82c.js";import"./refusal-a1b91175.js";import"./generic-0bf4d68e.js";import"./point-of-care-cd3cf399.js";import"./organization-cca91f92.js";import"./helpers-a03e04a5.js";import"./helpers-84e67dcb.js";import"./helpers-1cb82c85.js";import"./helpers-71f72544.js";import"./helpers-3cc5802d.js";const he={__name:"detail",setup($){const w=q(),f=U();x();const O=z(),T=X();let n=r(!0),i=V(k.newForm()),o=r(l.language.pt);r([]);let L=r([]),B=V(k.formRules()),c=r(0),m=r(0),P=r(0),K=r(-1),_=r(null);const h=F(()=>f.path.toLowerCase().indexOf("tarefas")>-1),R=F(()=>f.path.toLowerCase().indexOf("pesquisa")>-1),M=r(J.havePermission(l.permissions.service.createEdit));async function G(){n.value=!0;const t=await C.getById(c.value,m.value);d.validateResponse(t,null,()=>{let a=t.data;a.eventTypeId=a.lifeEventId?l.eventType.life:l.eventType.business,a.processingTime.type=a.processingTime.weeks?l.processingTimeType.simplified:l.processingTimeType.advanced,Object.assign(i,a),O.emit(s.emitter.OBJECT_LOADED,t.data),T.setFormToCompare(d.cloneObject(a))}),n.value=!1}async function y(){n.value=!0;const t=await C.getLists(o.value);d.validateResponse(t,null,()=>{T.setLists(t.data)}),n.value=!1}Y(()=>o.value,()=>{y()}),Q(async()=>{c.value=d.decodeId(f.params.serviceId),m.value=d.decodeId(f.params.serviceVersion),!c.value||!m.value?w.push({name:s.router.BACKOFFICE_SERVICE_PAGE.name}):(await y(),await G(),A.value&&(await _.value.getHistory(),_.value.setActiveVersion(m.value),_.value.setStep()))});const A=F(()=>!h.value&&M.value&&i.recordStateTypeId!=l.recordStateType.draft);return(t,a)=>{const g=E("breadcrumb-item"),D=E("breadcrumb"),N=E("ctimeline"),H=E("page");return p(),v(H,{title:t._lang.backoffice.service.editPageTitle},{breadcrumb:b(()=>[I(D,{"has-home":!e(R)},{default:b(()=>[e(h)?(p(),v(g,{key:0,label:t._lang.backoffice.tasks.breadcrumbTitle,"router-path":e(s).router.BACKOFFICE_TASKS_PAGE.path},null,8,["label","router-path"])):e(R)?(p(),v(g,{key:1,label:t._lang.search.pageTitle,"router-path":e(s).router.BACKOFFICE_SEARCH_HISTORY_PAGE.path},null,8,["label","router-path"])):(p(),v(g,{key:2,label:t._lang.backoffice.service.breadcrumbTitle,"router-path":e(s).router.BACKOFFICE_SERVICE_PAGE.path},null,8,["label","router-path"])),I(g,{label:t._lang.backoffice.service.detailPageTitle},null,8,["label"])]),_:1},8,["has-home"])]),actions:b(()=>[I(Z,{loading:e(n),selectedLang:e(o),"onUpdate:selectedLang":a[0]||(a[0]=u=>S(o)?o.value=u:o=u),service:e(C),backRoute:e(s).router.BACKOFFICE_SERVICE_PAGE.name,editRoute:e(s).router.BACKOFFICE_EDIT_SERVICE_PAGE.name,itemIdField:"serviceId",itemVersionField:"serviceVersion",itemId:e(c),itemVersion:e(m),formModel:e(i),"show-record-state-actions":e(h),store:e(T)},null,8,["loading","selectedLang","service","backRoute","editRoute","itemId","itemVersion","formModel","show-record-state-actions","store"])]),default:b(()=>[e(A)?(p(),v(N,{versions:e(L),key:e(P),activeVersion:e(K),itemId:e(c),detailRoute:e(s).router.BACKOFFICE_DETAIL_SERVICE_PAGE.name,service:e(C),versionFieldName:"serviceVersion",dateFieldName:"serviceApprovedDate",detailRouteIdField:"serviceId",detailRouteVersionField:"serviceVersion",ref_key:"timeline",ref:_},null,8,["versions","activeVersion","itemId","detailRoute","service"])):W("",!0),I(j,{formModel:e(i),"onUpdate:formModel":a[1]||(a[1]=u=>S(i)?i.value=u:i=u),disabled:!0,loading:e(n),selectedLang:e(o),validateForm:!0,rules:e(B),isExternalEdit:!1,showProgress:!1},null,8,["formModel","loading","selectedLang","rules"])]),_:1},8,["title"])}}};export{he as default};
