import{h as re,q as de,J as ce,i as u,v as i,s as U,j as r,M,K as ue,b as me,r as d,o as f,e as pe,a as o,w as c,c as z,m as e,S as be,y as T,U as ge,V as fe,z as k,L as ye,F as _e,l as C}from"./index-a3ba1ed7.js";import{o as O}from"./organization-c85e978d.js";import{_ as ve,i as Ie}from"./import-6de24cfd.js";import{u as ze}from"./organization-ce7c2862.js";import{b as Te}from"./helpers-4d6c1969.js";import{o as Ve}from"./helpers-41fd1e3d.js";import"./index.esm-d7202dd3.js";const Fe={__name:"index",setup(Se){const V=re(),E=de(),N=ze(),R=ce();let D=u("import"),s=u(!1),y=u([]),_=u([]),v=u(i.tableSelectedState.none),n=U(F()),b=u([]),w=u([]),S=u([]),A=u(r.createEmptyDataSource()),B=u([]);U({});const K=u(M.havePermission(i.permissions.organization.createEdit)),h=u(M.havePermission(i.permissions.parameter.createEdit));function F(){return{pageNumber:1,sortBy:"Code",organizationTypeIds:null,abreviation:null,parentOrganization:null,recordStateTypeIds:null,name:null,code:null,active:!0}}ue(async()=>{s.value=!0;const a=await O.getLists(R.getLanguage);r.validateResponse(a,null,()=>{N.setLists(a.data),b.value=[].concat(a.data.organizationRegionalPublicAdministrationTypeList).concat(a.data.organizationLocalAuthoritiesTypeList),b.value=r.removeDuplicateItemsOfArray(b.value),w.value=a.data.organizationList,r.sortArrayOffline("label asc",b.value),S.value=r.convertEnumToArray(E.enums.recordStateType),B.value=r.concatItemsBadge(S.value,Te.recordStateTypeBadgeOptions)}),s.value=!1}),me(async()=>{await I()});function G(a){V.push({name:C.router.BACKOFFICE_EDIT_ENTITY_PAGE.name,params:{organizationId:r.encodeId(a.organizationId),organizationVersion:r.encodeId(a.organizationVersion)}})}function Y(a){V.push({name:C.router.BACKOFFICE_DETAIL_ENTITY_PAGE.name,params:{organizationId:r.encodeId(a.organizationId),organizationVersion:r.encodeId(a.organizationVersion)}})}async function $(){Object.assign(n,F()),await P()}async function P(){n.pageNumber=1,await I()}async function j(){s.value=!0;const a=await O.create(Ve.newForm());r.validateResponse(a,null,()=>{const l=r.encodeId(a.data.organizationId),g=r.encodeId(a.data.organizationVersion);V.push({name:C.router.BACKOFFICE_EDIT_ENTITY_PAGE.name,params:{organizationId:l,organizationVersion:g}})}),s.value=!1}async function H(a){n.sortBy=a,await I()}async function q(a){n.pageNumber=a,await I()}async function I(){s.value=!0;let a=await O.search(n);r.validateResponse(a,null,()=>{A.value=a.data}),s.value=!1}function J(){r.showModalById(D.value)}async function W(a){s.value=!0;let l={data:a.value.data,name:a.value.name},g=await Ie.organization(l);r.validateResponse(g,null,()=>{}),s.value=!1}return(a,l)=>{const g=d("breadcrumb-item"),Q=d("breadcrumb"),X=d("cbutton"),m=d("form-field"),L=d("row"),Z=d("cfilter"),x=d("icon-import"),ee=d("cbutton-options"),ae=d("table-actions"),p=d("ccolumn"),te=d("table-action-edit"),oe=d("table-action-detail"),le=d("ctable"),ne=d("card"),ie=d("page");return f(),pe(_e,null,[o(ie,{title:a._lang.backoffice.entities.pageTitle},{breadcrumb:c(()=>[o(Q,{"has-home":!0},{default:c(()=>[o(g,{label:a._lang.backoffice.entities.breadcrumbTitle},null,8,["label"])]),_:1})]),actions:c(()=>[K.value?(f(),z(X,{key:0,class:"col-12 col-sm-auto",type:e(i).buttonType.secondary,size:e(i).buttonSize.medium,title:a._lang.common.toAdd,icon:be,onClick:j},null,8,["type","size","title"])):T("",!0)]),default:c(()=>[o(ne,{shadow:!0},{body:c(()=>[o(Z,{title:a._lang.common.filter,disabled:e(s),"clear-click":$,"apply-click":P,loading:e(s),collapsed:!0},{default:c(()=>[o(L,null,{default:c(()=>[o(m,{id:"code",modelValue:e(n).code,"onUpdate:modelValue":l[0]||(l[0]=t=>e(n).code=t),class:"mb-3 col-12 col-md-6 col-lg-4",label:a._lang.label.code,type:e(i).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),o(m,{class:"mb-3 col-12 col-md-6 col-lg-4",modelValue:e(n).organizationTypeIds,"onUpdate:modelValue":l[1]||(l[1]=t=>e(n).organizationTypeIds=t),label:a._lang.label.organizationTypeId,type:e(i).inputs.multiselect,options:e(b),disabled:e(s),mode:e(i).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),o(m,{class:"mb-3 col-12 col-lg-4",modelValue:e(n).abreviation,"onUpdate:modelValue":l[2]||(l[2]=t=>e(n).abreviation=t),label:a._lang.label.abreviation,type:e(i).inputs.text,maxlength:16,disabled:e(s)},null,8,["modelValue","label","type","disabled"])]),_:1}),o(L,null,{default:c(()=>[o(m,{class:"mb-3 col-12 col-md-6 col-lg-4",modelValue:e(n).name,"onUpdate:modelValue":l[3]||(l[3]=t=>e(n).name=t),label:a._lang.label.name,type:e(i).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),o(m,{class:"mb-3 col-12 col-md-6 col-lg-4",modelValue:e(n).parentOrganization,"onUpdate:modelValue":l[4]||(l[4]=t=>e(n).parentOrganization=t),label:a._lang.label.parentOrganization,type:e(i).inputs.multiselect,options:e(w),disabled:e(s),valueProp:e(i).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),o(m,{class:"mb-3 col-12 col-lg-4",modelValue:e(n).recordStateTypeIds,"onUpdate:modelValue":l[5]||(l[5]=t=>e(n).recordStateTypeIds=t),label:a._lang.label.state,type:e(i).inputs.multiselect,options:e(S),disabled:e(s),mode:e(i).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),o(m,{id:"active",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(n).active,"onUpdate:modelValue":l[6]||(l[6]=t=>e(n).active=t),label:a._lang.label.active,type:e(i).inputs.checkbox,disabled:e(s)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","disabled","loading"]),o(ge,null,{default:c(()=>[h.value?(f(),z(ae,{key:0,title:a._lang.common.tableActionTitle},{default:c(()=>[o(ee,{type:e(i).buttonType.secondary},{default:c(()=>[o(fe,{title:e(E).common.import,onClick:J},{default:c(()=>[o(x,{color:"#002D74"})]),_:1},8,["title"])]),_:1},8,["type"])]),_:1},8,["title"])):T("",!0),o(le,{onSort:H,onChangePage:q,selectedItems:e(y),"onUpdate:selectedItems":l[7]||(l[7]=t=>k(y)?y.value=t:y=t),unselectedItems:e(_),"onUpdate:unselectedItems":l[8]||(l[8]=t=>k(_)?_.value=t:_=t),selectedState:e(v),"onUpdate:selectedState":l[9]||(l[9]=t=>k(v)?v.value=t:v=t),data:e(A),checkbox:!1,loading:e(s),defaultSort:"OrganizationId",checkboxField:"organizationId"},{columns:c(()=>[o(p,{name:a._lang.label.code,field:"code",sortable:!0},null,8,["name"]),o(p,{name:a._lang.label.organizationTypeId,field:"organizationType",sortField:"organizationTypeId",sortable:!0},null,8,["name"]),o(p,{name:a._lang.label.abreviation,field:"abreviation",sortable:!0},null,8,["name"]),o(p,{name:a._lang.common.name,field:"name",sortable:!0},null,8,["name"]),o(p,{name:a._lang.label.parentOrganization,field:"organizationParent",sortField:"organizationParentId",sortable:!0},null,8,["name"]),o(p,{name:a._lang.common.state,field:"recordStateTypeId",align:e(i).columnAlign.center,custom:ye,options:e(B),sortable:!0},null,8,["name","align","options"])]),actions:c(t=>[t.item.recordStateTypeId==e(i).recordStateType.draft?(f(),z(te,{key:0,onClick:se=>G(t.item)},null,8,["onClick"])):T("",!0),t.item.recordStateTypeId>e(i).recordStateType.draft?(f(),z(oe,{key:1,onClick:se=>Y(t.item)},null,8,["onClick"])):T("",!0)]),_:1},8,["selectedItems","unselectedItems","selectedState","data","loading"])]),_:1})]),_:1})]),_:1},8,["title"]),o(ve,{action:W})],64)}}};export{Fe as default};
