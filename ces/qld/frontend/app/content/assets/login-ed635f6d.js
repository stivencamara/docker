import{u as M}from"./index.esm-90cb40dd.js";import{c as C,r as T,e as U,m as I}from"./index.esm-d77c3574.js";import{n as N,q as P,i as A,h as G,u as K,s as O,r as g,o as h,c as j,w as H,f as t,m as a,l as B,a as i,t as W,v as F,e as S,F as J,x as Q,y as V,z as X,k as f,A as L,j as _}from"./index-d8a56bcc.js";const Y={login:m=>N.post("/system/login",{clientId:m.clientId,clientSecret:m.clientSecret})},re="/images/login.svg",Z="/images/logo-blue.svg";const x={class:"ms-4"},ee=["data-bs-title","alt"],ae=t("div",{class:"text-center mb-5"},[t("img",{width:"220",alt:"CES",src:Z})],-1),se={class:"d-grid gap-4 py-3"},oe={key:0,class:"m-auto"},te={class:"d-grid gap-4 py-3"},de={__name:"login",props:{disabled:{type:Boolean,default:!1}},setup(m){const c=m,w=P();let o=A(!1);const v=G(),{executeRecaptcha:q,recaptchaLoaded:R}=K();let l=O({username:"stiven.camara@babelgroup.com",password:"P@ssw0rd",recaptchaToken:null}),n=A(!1);const y=C.withMessage(w.common.requiredField,T),$={username:{required:y,email:U},password:{required:y,minLength:C.withMessage(({$params:e})=>w.common.minLengthField.replace("{0}",e.min),I(8))}},r=M($,l);async function D(){if(o.value=!0,await r.value.$validate(),!r.value.$error){await R();const e=await q("login");if(e){l.recaptchaToken=e,f.setUser(null);const s=await L.backofficeLogin(l);_.validateResponse(s,null,()=>{const b=s.data.token,p=s.data.expiration,d=f.create(b,p);f.setUser(d),v.push({name:B.router.BACKOFFICE_TASKS_PAGE.name})})}}o.value=!1}async function k(){o.value=!0;let e=await Y.login({clientId:"B2881296-50A3-4FB2-A16C-2D298A718B3C",clientSecret:"25853D3A-5227-43BA-9449-D1EBC397D9D9"});await _.validateResponseAsync(e,null,async()=>{f.setSys(e.data);let s=await L.getUrl("B2881296-50A3-4FB2-A16C-2D298A718B3C");_.validateResponse(s,null,()=>{window.location.href=s.data})}),o.value=!1}function E(e){v.push({name:e})}return(e,s)=>{const b=g("iconArrowLeft"),p=g("form-field"),d=g("cbutton"),z=g("card");return h(),j(z,{"card-login":""},{body:H(()=>[t("div",x,[t("a",{class:"p-hand","data-bs-toggle":"tooltip","data-bs-title":e._lang.common.back,alt:e._lang.header.notifications,onClick:s[0]||(s[0]=u=>E(a(B).router.HOME_PAGE.name)),"aria-controls":"offcanvasRight"},[i(b,{color:"black"})],8,ee)]),t("form",null,[ae,t("div",{class:W(["login-backoffice",{show:a(n)}])},[i(p,{autocomplete:"email",type:a(F).inputs.email,id:"email",label:e._lang.label.email,required:!0,class:"mb-3",modelValue:a(l).username,"onUpdate:modelValue":s[1]||(s[1]=u=>a(l).username=u),disabled:a(o),"show-error":a(r).username.$error,"error-message":e._errorMessageField(a(r).username),placeholder:e._lang.common.add},null,8,["type","label","modelValue","disabled","show-error","error-message","placeholder"]),i(p,{type:a(F).inputs.password,id:"password",label:e._lang.label.password,required:!0,class:"mb-3",modelValue:a(l).password,"onUpdate:modelValue":s[2]||(s[2]=u=>a(l).password=u),disabled:a(o),"show-error":a(r).password.$error,"error-message":e._errorMessageField(a(r).password),placeholder:e._lang.common.add},null,8,["type","label","modelValue","disabled","show-error","error-message","placeholder"]),t("div",se,[i(d,{type:"primary",size:"large",title:e._lang.backoffice.login.enter,onClick:D,disabled:c.disabled||a(o)},null,8,["title","disabled"]),i(d,{type:"secondary",size:"large",title:e._lang.backoffice.login.graidAuthentication,onClick:k,disabled:c.disabled||a(o)},null,8,["title","disabled"])])],2),a(n)?V("",!0):(h(),S(J,{key:0},[c.disabled?(h(),S("p",oe,Q(e._lang.backoffice.login.loading),1)):V("",!0),t("div",te,[i(d,{type:"secondary",size:"large",title:e._lang.backoffice.login.graidAuthentication,onClick:k,disabled:c.disabled||a(o)},null,8,["title","disabled"]),i(d,{type:"primary",size:"large",title:e._lang.backoffice.login.enterWithAdmin,onClick:s[3]||(s[3]=u=>X(n)?n.value=!a(n):n=!a(n)),disabled:c.disabled||a(o)},null,8,["title","disabled"])])],64))])]),_:1})}}};export{de as _,re as a};
