import{h as se,q as ie,i as c,s as U,j as s,v as d,K as ue,b as ce,N as P,E as N,r as i,o as T,c as h,w as r,a as o,m as l,S as re,z as w,L as me,y as M,l as z}from"./index-d8a56bcc.js";import{l as O}from"./location-ff83fe07.js";import{h as pe}from"./helpers-3cc5802d.js";import{b as be}from"./helpers-d89764d1.js";import"./index.esm-d77c3574.js";const _e={__name:"index",setup(Ie){const V=se(),A=ie();let u=c(!0),a=U(L()),F=U(s.createEmptyDataSource()),R=c([]),S=c([]),E=c([]),y=c([]),k=c([]),g=c([]),f=c([]),v=c([]),C=c(d.tableSelectedState.none);async function D(e){a.sortBy=e,await _()}async function K(e){a.pageIndex=e,await _()}function L(){return{pageIndex:1,sortBy:"Code desc",organization:null,locationTypeId:null,abreviation:null,location:null,recordStateIds:null,address:null,islandId:null,countyId:null,parishId:null,zipCode:null,active:!0}}async function G(){Object.assign(a,L()),await B()}async function B(){a.pageNumber=1,await _()}async function _(){u.value=!0;let e=await O.search(a);s.validateResponse(e,null,()=>{F=e.data}),u.value=!1}async function j(){u.value=!0;const e=await O.create(pe.newForm());s.validateResponse(e,null,()=>{const n=s.encodeId(e.data.locationId),b=s.encodeId(e.data.locationVersion);V.push({name:z.router.BACKOFFICE_EDIT_LOCATION_PAGE.name,params:{locationId:n,locationVersion:b}})}),u.value=!1}function H(e){V.push({name:z.router.BACKOFFICE_EDIT_LOCATION_PAGE.name,params:{locationId:s.encodeId(e.locationId),locationVersion:s.encodeId(e.locationVersion)}})}function q(e){V.push({name:z.router.BACKOFFICE_DETAIL_LOCATION_PAGE.name,params:{locationId:s.encodeId(e.locationId),locationVersion:s.encodeId(e.locationVersion)}})}ue(async()=>{await _(),await $()}),ce(async()=>{R.value=s.convertEnumToArray(A.enums.locationType),S.value=s.convertEnumToArray(A.enums.recordStateType),E.value=s.concatItemsBadge(S.value,be.recordStateTypeBadgeOptions)});async function $(){u.value=!0;const e=await O.getLists("pt");s.validateResponse(e,null,()=>{y.value=e.data.divisionList}),u.value=!1}function J(e){return y.value.find(b=>b.value===e).children}function Q(e){return y.value.find(I=>I.value===a.islandId).children.find(I=>I.value===e).children}P(()=>a.islandId,()=>{const e=a.islandId;a.countyId=null,a.parishId=null,a.islandId||(a.countyId=null,a.parishId=null),e?k.value=J(e):(k.value=[],g.value=[])}),P(()=>a.countyId,()=>{const e=a.countyId;a.parishId=null,a.countyId||(a.parishId=null),e?g.value=Q(e):g.value=[]});const W=N(()=>!a.islandId),X=N(()=>!a.countyId);return(e,n)=>{const b=i("breadcrumb-item"),I=i("breadcrumb"),Y=i("cbutton"),m=i("form-field"),Z=i("row"),x=i("cfilter"),p=i("ccolumn"),ee=i("table-action-edit"),le=i("table-action-detail"),ae=i("ctable"),te=i("container-wrapper"),ne=i("card"),oe=i("page");return T(),h(oe,{title:e._lang.backoffice.location.pageTitle},{breadcrumb:r(()=>[o(I,{"has-home":!0},{default:r(()=>[o(b,{label:e._lang.backoffice.location.breadcrumbTitle},null,8,["label"])]),_:1})]),actions:r(()=>[o(Y,{type:l(d).buttonType.secondary,size:l(d).buttonSize.medium,title:e._lang.common.toAdd,icon:re,onClick:j},null,8,["type","size","title"])]),default:r(()=>[o(ne,{shadow:!0},{body:r(()=>[o(x,{title:e._lang.common.filter,"clear-click":G,"apply-click":B,loading:l(u),collapsed:!0},{default:r(()=>[o(Z,null,{default:r(()=>[o(m,{id:"code",class:"mb-3 col-12 col-md-6",label:e._lang.label.code,type:l(d).inputs.text,maxlength:45,modelValue:l(a).organization,"onUpdate:modelValue":n[0]||(n[0]=t=>l(a).organization=t)},null,8,["label","type","modelValue"]),o(m,{id:"islandId",class:"mb-3 col-12 col-md-6",modelValue:l(a).islandId,"onUpdate:modelValue":n[1]||(n[1]=t=>l(a).islandId=t),label:e._lang.label.islandId,loading:l(u),type:l(d).inputs.multiselect,options:l(y)},null,8,["modelValue","label","loading","type","options"]),o(m,{id:"countyId",class:"mb-3 col-12 col-md-6 col-lg-4",modelValue:l(a).countyId,"onUpdate:modelValue":n[2]||(n[2]=t=>l(a).countyId=t),label:e._lang.label.countyId,loading:l(u),type:l(d).inputs.multiselect,options:l(k),disabled:l(W)},null,8,["modelValue","label","loading","type","options","disabled"]),o(m,{id:"parishId",class:"mb-3 col-12 col-md-6 col-lg-4",modelValue:l(a).parishId,"onUpdate:modelValue":n[3]||(n[3]=t=>l(a).parishId=t),label:e._lang.label.parishId,loading:l(u),type:l(d).inputs.multiselect,options:l(g),disabled:l(X)},null,8,["modelValue","label","loading","type","options","disabled"]),o(m,{id:"zipCode",class:"mb-3 col-md-12 col-lg-4",label:e._lang.label.zipCode,type:l(d).inputs.zipCode,maxlength:45,modelValue:l(a).zipCode,"onUpdate:modelValue":n[4]||(n[4]=t=>l(a).zipCode=t)},null,8,["label","type","modelValue"]),o(m,{id:"address",class:"mb-3 col-12 col-md-8",label:e._lang.label.address,type:l(d).inputs.address,maxlength:45,modelValue:l(a).address,"onUpdate:modelValue":n[5]||(n[5]=t=>l(a).address=t)},null,8,["label","type","modelValue"]),o(m,{id:"recordStateIds",class:"mb-3 col-12 col-md-4",label:e._lang.label.state,type:l(d).inputs.multiselect,modelValue:l(a).recordStateIds,"onUpdate:modelValue":n[6]||(n[6]=t=>l(a).recordStateIds=t),options:l(S),mode:l(d).multiselectMode.tags},null,8,["label","type","modelValue","options","mode"]),o(m,{id:"active",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:l(a).active,"onUpdate:modelValue":n[7]||(n[7]=t=>l(a).active=t),label:e._lang.label.active,type:l(d).inputs.checkbox,disabled:l(u)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","loading"]),o(te,{class:"mt-4"},{default:r(()=>[o(ae,{onSort:D,onChangePage:K,data:l(F),loading:l(u),checkbox:!1,selectedItems:l(f),"onUpdate:selectedItems":n[8]||(n[8]=t=>w(f)?f.value=t:f=t),unselectedItems:l(v),"onUpdate:unselectedItems":n[9]||(n[9]=t=>w(v)?v.value=t:v=t),selectedState:l(C),"onUpdate:selectedState":n[10]||(n[10]=t=>w(C)?C.value=t:C=t),checkboxField:"code"},{columns:r(()=>[o(p,{name:e._lang.label.oidCode,field:"code",sortable:!0,maxLength:10},null,8,["name"]),o(p,{name:e._lang.label.islandId,field:"island",sortField:"islandId",sortable:!0},null,8,["name"]),o(p,{name:e._lang.label.countyId,field:"county",sortField:"countyId",sortable:!0},null,8,["name"]),o(p,{name:e._lang.label.parishId,field:"parish",sortField:"parishId",sortable:!0},null,8,["name"]),o(p,{name:e._lang.label.zipCode,field:"zipCode",sortField:"zipCode",sortable:!0},null,8,["name"]),o(p,{name:e._lang.label.address,field:"address",sortField:"address",sortable:!0,maxLength:10},null,8,["name"]),o(p,{name:e._lang.common.state,field:"recordStateTypeId",align:l(d).columnAlign.center,custom:me,options:l(E),sortable:!0},null,8,["name","align","options"])]),actions:r(t=>[t.item.recordStateTypeId==l(d).recordStateType.draft?(T(),h(ee,{key:0,onClick:de=>H(t.item)},null,8,["onClick"])):M("",!0),t.item.recordStateTypeId>l(d).recordStateType.draft?(T(),h(le,{key:1,onClick:de=>q(t.item)},null,8,["onClick"])):M("",!0)]),_:1},8,["data","loading","selectedItems","unselectedItems","selectedState"])]),_:1})]),_:1})]),_:1},8,["title"])}}};export{_e as default};
