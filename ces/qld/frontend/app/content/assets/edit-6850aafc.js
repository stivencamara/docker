import{s as P,L as R,z as B,r as u,a as L,i as V,G as M,J as N,u as n,x as f,N as A,b as v,o as h,l as G,w as c,e as m,g as a,D as b}from"./index-5b4ebf84.js";import{u as K}from"./organization-cd538fe2.js";import{o as I}from"./helpers-991a1d67.js";import{b as U}from"./helpers-4796f1a9.js";import{u as j}from"./index.esm-65642301.js";import{o as _}from"./organization-acc3daab.js";import{e as D}from"./edit-actions-88160b2f.js";import{_ as H}from"./form-d3f02008.js";import"./index.esm-85573352.js";import"./refusal-5d03193c.js";import"./cancel-confirm-46a9e596.js";import"./settings-fd6ffbf1.js";import"./helpers-28a0442c.js";import"./helpers-730fb974.js";import"./helpers-c8652456.js";import"./helpers-138c884f.js";import"./helpers-56107f9e.js";/* empty css                                                                     */import"./contacts-6a9568fc.js";import"./address-167772ff.js";import"./location-7945ac70.js";import"./generic-74ec479d.js";import"./point-of-care-11ca6bee.js";import"./service-09bdae54.js";import"./document-07880ad5.js";const be={__name:"edit",setup(x){const C=P(),z=R();B();const p=K();let l=u(0),d=u(0),o=u(!0),e=L(I.newForm()),s=u(V.language.pt),T=L(I.formRules()),g=u(0);const E=j(T,e,{$stopPropagation:!0}),k=M(()=>g.value===100&&!o.value);N(async()=>{l.value=n.decodeId(z.params.organizationId),d.value=n.decodeId(z.params.organizationVersion),!l.value||!d.value?C.push({name:f.router.BACKOFFICE_ENTITIES_PAGE.name}):(await y(),await w())});async function w(){o.value=!0;const t=await _.getById(l.value,d.value);n.validateResponse(t,null,()=>{Object.assign(e,t.data),p.setFormToCompare(n.cloneObject(t.data))}),o.value=!1}async function y(){o.value=!0;const t=await _.getLists(s.value);n.validateResponse(t,null,()=>{p.setLists(t.data)}),o.value=!1}return A(()=>s.value,()=>{y()}),A(()=>[e.nipc,e.texts[0].name,e.groupName,e.organizationTypeId,e.parentOrganization,e.startDate,e.economicActivityId,e.divisionTypeId,e.divisionId,e.address.zipCode,e.address.islandId,e.address.countyId,e.address.parishId,e.address.locality,e.address.address],()=>{let t=I.progressFields();e.divisionTypeId===V.notApplicable&&n.removeItemOfArray(t,"divisionId"),U.calculatePercentage(e,t,r=>{p.setProgress(r),g.value=r})}),(t,r)=>{const F=v("breadcrumb-item"),S=v("breadcrumb"),O=v("page");return h(),G(O,{title:t._lang.backoffice.entities.editPageTitle},{breadcrumb:c(()=>[m(S,{"has-home":!0},{default:c(()=>[m(F,{label:t._lang.backoffice.entities.breadcrumbTitle,"router-path":a(f).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),m(F,{label:t._lang.backoffice.entities.editPageTitle},null,8,["label"])]),_:1})]),actions:c(()=>[m(D,{loading:a(o),"onUpdate:loading":r[0]||(r[0]=i=>b(o)?o.value=i:o=i),canSubmit:a(k),selectedLang:a(s),"onUpdate:selectedLang":r[1]||(r[1]=i=>b(s)?s.value=i:s=i),backRoute:a(f).router.BACKOFFICE_ENTITIES_PAGE.name,service:a(_),itemId:a(l),itemVersion:a(d),formModel:a(e),vuelidate:a(E),store:a(p),resource:t._lang.backoffice.entities,itemIdField:"organizationId"},null,8,["loading","canSubmit","selectedLang","backRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource"])]),default:c(()=>[m(H,{formModel:a(e),"onUpdate:formModel":r[2]||(r[2]=i=>b(e)?e.value=i:e=i),disabled:!1,validateForm:!0,selectedLang:a(s),rules:a(T),loading:a(o),organizationId:a(l),organizationVersion:a(d),progressValue:a(g),"show-progress":!0,vuelidate:a(E)},null,8,["formModel","selectedLang","rules","loading","organizationId","organizationVersion","progressValue","vuelidate"])]),_:1},8,["title"])}}};export{be as default};
