import{h as P,C as R,q as B,i as u,s as F,v as V,E as M,K as h,j as n,l as f,N as A,r as v,o as N,c as K,w as c,a as m,m as a,z as b}from"./index-d8a56bcc.js";import{u as j}from"./organization-cca91f92.js";import{o as I}from"./helpers-1cb82c85.js";import{b as G}from"./helpers-d89764d1.js";import{u as U}from"./index.esm-90cb40dd.js";import{o as _}from"./organization-7b90e5ff.js";import{e as H}from"./edit-actions-13f6ab30.js";import{_ as q}from"./form-5ae8e89e.js";import"./index.esm-d77c3574.js";import"./refusal-a1b91175.js";import"./cancel-confirm-72811969.js";import"./settings-55cfd82c.js";/* empty css                                                                     */import"./contacts-e5b4fc11.js";import"./address-e1a94fd0.js";import"./location-ff83fe07.js";import"./generic-0bf4d68e.js";import"./point-of-care-cd3cf399.js";import"./helpers-a03e04a5.js";import"./service-123d0948.js";import"./helpers-eb16543c.js";import"./helpers-84e67dcb.js";import"./document-3c516f4f.js";import"./helpers-71f72544.js";const ve={__name:"edit",setup(D){const L=P(),z=R();B();const p=j();let l=u(0),d=u(0),o=u(!0),e=F(I.newForm()),s=u(V.language.pt),E=F(I.formRules()),g=u(0);const T=U(E,e,{$stopPropagation:!0}),k=M(()=>g.value===100&&!o.value);h(async()=>{l.value=n.decodeId(z.params.organizationId),d.value=n.decodeId(z.params.organizationVersion),!l.value||!d.value?L.push({name:f.router.BACKOFFICE_ENTITIES_PAGE.name}):(await y(),await w())});async function w(){o.value=!0;const t=await _.getById(l.value,d.value);n.validateResponse(t,null,()=>{Object.assign(e,t.data),p.setFormToCompare(n.cloneObject(t.data))}),o.value=!1}async function y(){o.value=!0;const t=await _.getLists(s.value);n.validateResponse(t,null,()=>{p.setLists(t.data)}),o.value=!1}return A(()=>s.value,()=>{y()}),A(()=>[e.nipc,e.texts[0].name,e.groupName,e.organizationTypeId,e.parentOrganization,e.startDate,e.economicActivityId,e.divisionTypeId,e.divisionId,e.address.zipCode,e.address.islandId,e.address.countyId,e.address.parishId,e.address.locality,e.address.address],()=>{let t=I.progressFields();e.divisionTypeId===V.notApplicable&&n.removeItemOfArray(t,"divisionId"),G.calculatePercentage(e,t,r=>{p.setProgress(r),g.value=r})}),(t,r)=>{const C=v("breadcrumb-item"),S=v("breadcrumb"),O=v("page");return N(),K(O,{title:t._lang.backoffice.entities.editPageTitle},{breadcrumb:c(()=>[m(S,{"has-home":!0},{default:c(()=>[m(C,{label:t._lang.backoffice.entities.breadcrumbTitle,"router-path":a(f).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),m(C,{label:t._lang.backoffice.entities.editPageTitle},null,8,["label"])]),_:1})]),actions:c(()=>[m(H,{loading:a(o),"onUpdate:loading":r[0]||(r[0]=i=>b(o)?o.value=i:o=i),canSubmit:a(k),selectedLang:a(s),"onUpdate:selectedLang":r[1]||(r[1]=i=>b(s)?s.value=i:s=i),backRoute:a(f).router.BACKOFFICE_ENTITIES_PAGE.name,service:a(_),itemId:a(l),itemVersion:a(d),formModel:a(e),vuelidate:a(T),store:a(p),resource:t._lang.backoffice.entities,itemIdField:"organizationId"},null,8,["loading","canSubmit","selectedLang","backRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource"])]),default:c(()=>[m(q,{formModel:a(e),"onUpdate:formModel":r[2]||(r[2]=i=>b(e)?e.value=i:e=i),disabled:!1,validateForm:!0,selectedLang:a(s),rules:a(E),loading:a(o),organizationId:a(l),organizationVersion:a(d),progressValue:a(g),"show-progress":!0,vuelidate:a(T)},null,8,["formModel","selectedLang","rules","loading","organizationId","organizationVersion","progressValue","vuelidate"])]),_:1},8,["title"])}}};export{ve as default};
