import{u as M}from"./index.esm-65642301.js";import{c as C,r as T,e as I,m as U}from"./index.esm-85573352.js";import{y as N,z as P,r as A,s as G,m as K,a as O,b as g,o as f,l as H,w as W,d as t,g as a,x as B,e as i,A as j,i as F,c as S,F as J,t as Q,B as V,D as X,E as L,u as _,v as h}from"./index-5b4ebf84.js";const Y={login:m=>N.post("/system/login",{clientId:m.clientId,clientSecret:m.clientSecret})},re="/images/login.svg",Z="/images/logo-blue.svg";const x={class:"ms-4"},ee=["data-bs-title","alt"],ae=t("div",{class:"text-center mb-5"},[t("img",{width:"220",alt:"CES",src:Z})],-1),se={class:"d-grid gap-4 py-3"},oe={key:0,class:"m-auto"},te={class:"d-grid gap-4 py-3"},de={__name:"login",props:{disabled:{type:Boolean,default:!1}},setup(m){const c=m,w=P();let o=A(!1);const v=G(),{executeRecaptcha:D,recaptchaLoaded:E}=K();let l=O({username:"stiven.camara@babelgroup.com",password:"P@ssw0rd",recaptchaToken:null}),n=A(!1);const y=C.withMessage(w.common.requiredField,T),R={username:{required:y,email:I},password:{required:y,minLength:C.withMessage(({$params:e})=>w.common.minLengthField.replace("{0}",e.min),U(8))}},r=M(R,l);async function $(){if(o.value=!0,await r.value.$validate(),!r.value.$error){await E();const e=await D("login");if(e){l.recaptchaToken=e;const s=await L.backofficeLogin(l);_.validateResponse(s,null,()=>{const b=s.data.token,p=s.data.expiration,d=h.create(b,p);h.setUser(d),v.push({name:B.router.BACKOFFICE_TASKS_PAGE.name})})}}o.value=!1}async function k(){o.value=!0;let e=await Y.login({clientId:"B2881296-50A3-4FB2-A16C-2D298A718B3C",clientSecret:"25853D3A-5227-43BA-9449-D1EBC397D9D9"});await _.validateResponseAsync(e,null,async()=>{h.setSys(e.data);let s=await L.getUrl("B2881296-50A3-4FB2-A16C-2D298A718B3C");_.validateResponse(s,null,()=>{window.location.href=s.data})}),o.value=!1}function q(e){v.push({name:e})}return(e,s)=>{const b=g("iconArrowLeft"),p=g("form-field"),d=g("cbutton"),z=g("card");return f(),H(z,{"card-login":""},{body:W(()=>[t("div",x,[t("a",{class:"p-hand","data-bs-toggle":"tooltip","data-bs-title":e._lang.common.back,alt:e._lang.header.notifications,onClick:s[0]||(s[0]=u=>q(a(B).router.HOME_PAGE.name)),"aria-controls":"offcanvasRight"},[i(b,{color:"black"})],8,ee)]),t("form",null,[ae,t("div",{class:j(["login-backoffice",{show:a(n)}])},[i(p,{autocomplete:"email",type:a(F).inputs.email,id:"email",label:e._lang.label.email,required:!0,class:"mb-3",modelValue:a(l).username,"onUpdate:modelValue":s[1]||(s[1]=u=>a(l).username=u),disabled:a(o),"show-error":a(r).username.$error,"error-message":e._errorMessageField(a(r).username),placeholder:e._lang.common.add},null,8,["type","label","modelValue","disabled","show-error","error-message","placeholder"]),i(p,{type:a(F).inputs.password,id:"password",label:e._lang.label.password,required:!0,class:"mb-3",modelValue:a(l).password,"onUpdate:modelValue":s[2]||(s[2]=u=>a(l).password=u),disabled:a(o),"show-error":a(r).password.$error,"error-message":e._errorMessageField(a(r).password),placeholder:e._lang.common.add},null,8,["type","label","modelValue","disabled","show-error","error-message","placeholder"]),t("div",se,[i(d,{type:"primary",size:"large",title:e._lang.backoffice.login.enter,onClick:$,disabled:c.disabled||a(o)},null,8,["title","disabled"]),i(d,{type:"secondary",size:"large",title:e._lang.backoffice.login.graidAuthentication,onClick:k,disabled:c.disabled||a(o)},null,8,["title","disabled"])])],2),a(n)?V("",!0):(f(),S(J,{key:0},[c.disabled?(f(),S("p",oe,Q(e._lang.backoffice.login.loading),1)):V("",!0),t("div",te,[i(d,{type:"secondary",size:"large",title:e._lang.backoffice.login.graidAuthentication,onClick:k,disabled:c.disabled||a(o)},null,8,["title","disabled"]),i(d,{type:"primary",size:"large",title:e._lang.backoffice.login.enterWithAdmin,onClick:s[3]||(s[3]=u=>X(n)?n.value=!a(n):n=!a(n)),disabled:c.disabled||a(o)},null,8,["title","disabled"])])],64))])]),_:1})}}};export{de as _,re as a};
