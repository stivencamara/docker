import{h as te,q as ae,J as oe,i as m,v as s,s as F,j as d,M as se,K as ne,b as ie,r,o as C,c as _,w as u,a as n,m as e,S as de,y as U,U as re,z as A,L as ce,l as L}from"./index-a3ba1ed7.js";import{s as S}from"./service-dc586f40.js";import{u as ue}from"./service-e931ab78.js";import{s as me}from"./helpers-10c1d19c.js";import{b as pe}from"./helpers-4d6c1969.js";import"./helpers-0cd9b2b2.js";import"./index.esm-d7202dd3.js";const _e={__name:"index",setup(be){const E=te(),k=ae(),p=ue(),O=oe(),P="confirm-delete";let i=m(!1),v=m([]),f=m([]),g=m(s.tableSelectedState.none),o=F(M()),y=m([]),B=m([]),T=m(d.createEmptyDataSource()),I=F({});const R=m(se.havePermission(s.permissions.service.createEdit));function M(){return{pageNumber:1,sortBy:"Code",code:null,serviceTypeIds:null,serviceCategoryIds:null,businessEventIds:null,lifeEventIds:null,abreviation:null,name:null,organization:null,recordStateIds:null,active:!0}}async function D(){if(I){i.value=!0;const l=await S.delete(I.serviceId);d.validateResponse(l,k.backoffice.service.deleted,()=>{d.removeItemOfArray(T.value.items,I)}),I=null,i.value=!1}}ne(async()=>{i.value=!0,y.value=d.convertEnumToArray(k.enums.recordStateType);const l=await S.getLists(O.getLanguage);d.validateResponse(l,null,()=>{p.setLists(l.data),y.value=d.convertEnumToArray(k.enums.recordStateType),B.value=d.concatItemsBadge(y.value,pe.recordStateTypeBadgeOptions)}),i.value=!1}),ie(async()=>{await V()});function N(l){E.push({name:L.router.BACKOFFICE_EDIT_SERVICE_PAGE.name,params:{serviceId:d.encodeId(l.serviceId),serviceVersion:d.encodeId(l.serviceVersion)}})}function K(l){E.push({name:L.router.BACKOFFICE_DETAIL_SERVICE_PAGE.name,params:{serviceId:d.encodeId(l.serviceId),serviceVersion:d.encodeId(l.serviceVersion)}})}async function G(){Object.assign(o,M()),await z()}async function z(){o.pageNumber=1,await V()}async function H(){i.value=!0;const l=await S.create(me.newForm());d.validateResponse(l,null,()=>{const a=d.encodeId(l.data.serviceId),w=d.encodeId(l.data.serviceVersion);E.push({name:L.router.BACKOFFICE_EDIT_SERVICE_PAGE.name,params:{serviceId:a,serviceVersion:w}})}),i.value=!1}async function j(l){o.sortBy=l,await V()}async function x(l){o.pageNumber=l,await V()}async function V(){i.value=!0;let l=await S.search(o);d.validateResponse(l,null,()=>{T.value=l.data}),i.value=!1}return(l,a)=>{const w=r("breadcrumb-item"),q=r("breadcrumb"),J=r("cbutton"),c=r("form-field"),Q=r("row"),W=r("cfilter"),b=r("ccolumn"),$=r("table-action-edit"),X=r("table-action-detail"),Y=r("ctable"),Z=r("card"),h=r("confirm-delete-modal"),ee=r("page");return C(),_(ee,{title:l._lang.backoffice.service.pageTitle},{breadcrumb:u(()=>[n(q,{"has-home":!0},{default:u(()=>[n(w,{label:l._lang.backoffice.service.breadcrumbTitle},null,8,["label"])]),_:1})]),actions:u(()=>[R.value?(C(),_(J,{key:0,class:"col-12 col-sm-auto",type:e(s).buttonType.secondary,size:e(s).buttonSize.medium,title:l._lang.common.toAdd,icon:de,onClick:H},null,8,["type","size","title"])):U("",!0)]),default:u(()=>[n(Z,{shadow:!0},{body:u(()=>[n(W,{title:l._lang.common.filter,disabled:e(i),"clear-click":G,"apply-click":z,loading:e(i),collapsed:!0},{default:u(()=>[n(Q,null,{default:u(()=>[n(c,{id:"code",modelValue:e(o).code,"onUpdate:modelValue":a[0]||(a[0]=t=>e(o).code=t),class:"mb-3 col-12 col-md-6 col-xl-4",label:l._lang.label.code,type:e(s).inputs.text,maxlength:45,disabled:e(i)},null,8,["modelValue","label","type","disabled"]),n(c,{id:"serviceTypeId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).serviceTypeIds,"onUpdate:modelValue":a[1]||(a[1]=t=>e(o).serviceTypeIds=t),label:l._lang.label.serviceTypeId,type:e(s).inputs.multiselect,options:e(p).serviceTypeList,disabled:e(i),mode:e(s).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),n(c,{id:"serviceCategoryId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).serviceCategoryIds,"onUpdate:modelValue":a[2]||(a[2]=t=>e(o).serviceCategoryIds=t),label:l._lang.label.serviceCategoryId,type:e(s).inputs.multiselect,options:e(p).serviceCategoryList,disabled:e(i),mode:e(s).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),n(c,{id:"lifeEventId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).lifeEventIds,"onUpdate:modelValue":a[3]||(a[3]=t=>e(o).lifeEventIds=t),label:l._lang.label.lifeEventId,type:e(s).inputs.multiselect,options:e(p).lifeEventList,disabled:e(i),mode:e(s).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),n(c,{id:"businessEventId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).businessEventIds,"onUpdate:modelValue":a[4]||(a[4]=t=>e(o).businessEventIds=t),label:l._lang.label.businessEventId,type:e(s).inputs.multiselect,options:e(p).businessEventList,disabled:e(i),mode:e(s).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),n(c,{id:"abreviation",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).abreviation,"onUpdate:modelValue":a[5]||(a[5]=t=>e(o).abreviation=t),label:l._lang.label.abreviation,type:e(s).inputs.text,maxlength:16,disabled:e(i)},null,8,["modelValue","label","type","disabled"]),n(c,{id:"name",class:"mb-3 col-12 col-xl-4",modelValue:e(o).name,"onUpdate:modelValue":a[6]||(a[6]=t=>e(o).name=t),label:l._lang.label.name,type:e(s).inputs.text,maxlength:45,disabled:e(i)},null,8,["modelValue","label","type","disabled"]),n(c,{id:"organizationId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).organization,"onUpdate:modelValue":a[7]||(a[7]=t=>e(o).organization=t),label:l._lang.label.organizationHost,type:e(s).inputs.multiselect,options:e(p).organizationList,disabled:e(i),valueProp:e(s).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),n(c,{id:"recordStateId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).recordStateIds,"onUpdate:modelValue":a[8]||(a[8]=t=>e(o).recordStateIds=t),label:l._lang.label.state,type:e(s).inputs.multiselect,options:e(y),disabled:e(i),mode:e(s).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),n(c,{id:"active",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(o).active,"onUpdate:modelValue":a[9]||(a[9]=t=>e(o).active=t),label:l._lang.label.active,type:e(s).inputs.checkbox,disabled:e(i)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","disabled","loading"]),n(re,null,{default:u(()=>[n(Y,{onSort:j,onChangePage:x,selectedItems:e(v),"onUpdate:selectedItems":a[10]||(a[10]=t=>A(v)?v.value=t:v=t),unselectedItems:e(f),"onUpdate:unselectedItems":a[11]||(a[11]=t=>A(f)?f.value=t:f=t),selectedState:e(g),"onUpdate:selectedState":a[12]||(a[12]=t=>A(g)?g.value=t:g=t),data:e(T),checkbox:!1,loading:e(i),defaultSort:"pointOfCareId",checkboxField:"code"},{columns:u(()=>[n(b,{name:l._lang.label.code,field:"code",sortable:!0},null,8,["name"]),n(b,{name:l._lang.label.serviceTypeId,field:"serviceType",sortField:"serviceTypeId",sortable:!0},null,8,["name"]),n(b,{name:l._lang.label.abreviation,field:"abreviation",sortable:!0},null,8,["name"]),n(b,{name:l._lang.label.name,field:"name",sortable:!0},null,8,["name"]),n(b,{name:l._lang.label.state,field:"recordStateTypeId",align:e(s).columnAlign.center,custom:ce,options:e(B),sortable:!0},null,8,["name","align","options"])]),actions:u(t=>[t.item.recordStateTypeId==e(s).recordStateType.draft?(C(),_($,{key:0,onClick:le=>N(t.item)},null,8,["onClick"])):U("",!0),t.item.recordStateTypeId>e(s).recordStateType.draft?(C(),_(X,{key:1,onClick:le=>K(t.item)},null,8,["onClick"])):U("",!0)]),_:1},8,["selectedItems","unselectedItems","selectedState","data","loading"])]),_:1})]),_:1}),n(h,{id:P,title:l._lang.backoffice.service.delete,message:l._lang.backoffice.service.deleteQuestion,action:D},null,8,["title","message"])]),_:1},8,["title"])}}};export{_e as default};
