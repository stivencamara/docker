import{_ as G}from"./form-4c9fd557.js";import{h as D,C as H,q as j,D as q,i,s as P,v as I,E as F,M as U,K as x,j as C,l as a,N as z,r as O,o as m,c as p,w as v,a as g,m as e,z as k,y as J}from"./index-d8a56bcc.js";import{p as w}from"./helpers-a03e04a5.js";import{u as Y}from"./point-of-care-da1e0f34.js";import{p as b}from"./point-of-care-cd3cf399.js";import"./helpers-d89764d1.js";import{_ as Q}from"./detail-actions-61125ebe.js";import"./contacts-e5b4fc11.js";import"./index.esm-90cb40dd.js";import"./address-e1a94fd0.js";import"./organization-cca91f92.js";import"./location-ff83fe07.js";import"./address.vue_vue_type_style_index_0_scoped_2266ba05_lang-1cc0e248.js";import"./service-3c534453.js";import"./refusal-a1b91175.js";import"./index.esm-d77c3574.js";import"./generic-0bf4d68e.js";import"./service-123d0948.js";import"./helpers-eb16543c.js";import"./helpers-84e67dcb.js";import"./helpers-1cb82c85.js";import"./helpers-71f72544.js";import"./helpers-3cc5802d.js";import"./settings-55cfd82c.js";const Ee={__name:"detail",setup(W){const L=D(),d=H();j();const y=q(),A=Y();let s=i(!0),r=P(w.newForm()),o=i(I.language.pt);i([]);let B=P(w.formRules()),l=i(0),n=i(0),c=i(null);const E=F(()=>d.path.toLowerCase().indexOf("tarefas")>-1),h=F(()=>d.path.toLowerCase().indexOf("pesquisa")>-1),V=i(U.havePermission(I.permissions.pointOfCare.createEdit));async function S(){s.value=!0;const t=await b.getById(l.value,n.value);C.validateResponse(t,null,()=>{Object.assign(r,t.data),y.emit(a.emitter.OBJECT_LOADED,t.data)}),s.value=!1}async function R(){s.value=!0;const t=await b.getLists(o.value);C.validateResponse(t,null,()=>{A.setLists(t.data)}),s.value=!1}x(async()=>{l.value=C.decodeId(d.params.pointOfCareId),n.value=C.decodeId(d.params.pointOfCareVersion),!l.value||!n.value?L.push({name:a.router.BACKOFFICE_POINT_OF_CARE_PAGE.name}):(await R(),await S(),T.value&&(await c.value.getHistory(),c.value.setActiveVersion(n.value),c.value.setStep()))}),z(()=>o.value,()=>{R()});const T=F(()=>!E.value&&V.value&&r.recordStateTypeId!=I.recordStateType.draft);return(t,f)=>{const _=O("breadcrumb-item"),N=O("breadcrumb"),K=O("ctimeline"),M=O("page");return m(),p(M,{title:t._lang.backoffice.pointOfCare.detailPageTitle},{breadcrumb:v(()=>[g(N,{"has-home":!e(h)},{default:v(()=>[e(E)?(m(),p(_,{key:0,label:t._lang.backoffice.tasks.breadcrumbTitle,"router-path":e(a).router.BACKOFFICE_TASKS_PAGE.path},null,8,["label","router-path"])):e(h)?(m(),p(_,{key:1,label:t._lang.search.pageTitle,"router-path":e(a).router.BACKOFFICE_SEARCH_HISTORY_PAGE.path},null,8,["label","router-path"])):(m(),p(_,{key:2,label:t._lang.backoffice.pointOfCare.breadcrumbTitle,"router-path":e(a).router.BACKOFFICE_POINT_OF_CARE_PAGE.path},null,8,["label","router-path"])),g(_,{label:t._lang.backoffice.pointOfCare.detailPageTitle},null,8,["label"])]),_:1},8,["has-home"])]),actions:v(()=>[g(Q,{loading:e(s),selectedLang:e(o),"onUpdate:selectedLang":f[0]||(f[0]=u=>k(o)?o.value=u:o=u),service:e(b),backRoute:e(a).router.BACKOFFICE_POINT_OF_CARE_PAGE.name,editRoute:e(a).router.BACKOFFICE_EDIT_POINT_OF_CARE_PAGE.name,itemIdField:"pointOfCareId",itemVersionField:"pointOfCareVersion",itemId:e(l),itemVersion:e(n),formModel:e(r),"show-record-state-actions":e(E),store:e(A)},null,8,["loading","selectedLang","service","backRoute","editRoute","itemId","itemVersion","formModel","show-record-state-actions","store"])]),default:v(()=>[e(T)?(m(),p(K,{key:0,itemId:e(l),detailRoute:e(a).router.BACKOFFICE_DETAIL_POINT_OF_CARE_PAGE.name,service:e(b),versionFieldName:"pointOfCareVersion",dateFieldName:"pointOfCareApprovedDate",detailRouteIdField:"pointOfCareId",detailRouteVersionField:"pointOfCareVersion",ref_key:"timeline",ref:c},null,8,["itemId","detailRoute","service"])):J("",!0),g(G,{formModel:e(r),"onUpdate:formModel":f[1]||(f[1]=u=>k(r)?r.value=u:r=u),disabled:!0,validateForm:!1,loading:e(s),selectedLang:e(o),rules:e(B),isExternalEdit:!1,showProgress:!1},null,8,["formModel","loading","selectedLang","rules"])]),_:1},8,["title"])}}};export{Ee as default};
