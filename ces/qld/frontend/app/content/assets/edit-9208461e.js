import{h as P,C as R,q as B,i as u,s as F,v as V,E as M,K as h,j as n,l as f,N as A,r as v,o as N,c as K,w as c,a as m,m as a,z as b}from"./index-a3ba1ed7.js";import{o as I}from"./organization-c85e978d.js";import{u as j}from"./organization-ce7c2862.js";import{o as _}from"./helpers-41fd1e3d.js";import{b as G}from"./helpers-4d6c1969.js";import{u as U}from"./index.esm-9dd2f6da.js";import{e as H}from"./edit-actions-8e0463cd.js";import{_ as q}from"./form-ae035c90.js";import"./index.esm-d7202dd3.js";import"./refusal-478c260d.js";import"./cancel-confirm-f95c31ca.js";import"./settings-4e9392c0.js";/* empty css                                                                     */import"./contacts-b2bccd25.js";import"./location-bed63be3.js";import"./address-238902c8.js";import"./generic-4e94cd3a.js";import"./point-of-care-748eca52.js";import"./helpers-ae560b5a.js";import"./service-dc586f40.js";import"./helpers-10c1d19c.js";import"./helpers-0cd9b2b2.js";import"./document-11fa5b48.js";import"./helpers-2771532d.js";const ve={__name:"edit",setup(D){const L=P(),z=R();B();const p=j();let l=u(0),d=u(0),o=u(!0),e=F(_.newForm()),s=u(V.language.pt),E=F(_.formRules()),g=u(0);const T=U(E,e,{$stopPropagation:!0}),k=M(()=>g.value===100&&!o.value);h(async()=>{l.value=n.decodeId(z.params.organizationId),d.value=n.decodeId(z.params.organizationVersion),!l.value||!d.value?L.push({name:f.router.BACKOFFICE_ENTITIES_PAGE.name}):(await y(),await w())});async function w(){o.value=!0;const t=await I.getById(l.value,d.value);n.validateResponse(t,null,()=>{Object.assign(e,t.data),p.setFormToCompare(n.cloneObject(t.data))}),o.value=!1}async function y(){o.value=!0;const t=await I.getLists(s.value);n.validateResponse(t,null,()=>{p.setLists(t.data)}),o.value=!1}return A(()=>s.value,()=>{y()}),A(()=>[e.nipc,e.texts[0].name,e.groupName,e.organizationTypeId,e.parentOrganization,e.startDate,e.economicActivityId,e.divisionTypeId,e.divisionId,e.address.zipCode,e.address.islandId,e.address.countyId,e.address.parishId,e.address.locality,e.address.address],()=>{let t=_.progressFields();e.divisionTypeId===V.notApplicable&&n.removeItemOfArray(t,"divisionId"),G.calculatePercentage(e,t,r=>{p.setProgress(r),g.value=r})}),(t,r)=>{const C=v("breadcrumb-item"),S=v("breadcrumb"),O=v("page");return N(),K(O,{title:t._lang.backoffice.entities.editPageTitle},{breadcrumb:c(()=>[m(S,{"has-home":!0},{default:c(()=>[m(C,{label:t._lang.backoffice.entities.breadcrumbTitle,"router-path":a(f).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),m(C,{label:t._lang.backoffice.entities.editPageTitle},null,8,["label"])]),_:1})]),actions:c(()=>[m(H,{loading:a(o),"onUpdate:loading":r[0]||(r[0]=i=>b(o)?o.value=i:o=i),canSubmit:a(k),selectedLang:a(s),"onUpdate:selectedLang":r[1]||(r[1]=i=>b(s)?s.value=i:s=i),backRoute:a(f).router.BACKOFFICE_ENTITIES_PAGE.name,service:a(I),itemId:a(l),itemVersion:a(d),formModel:a(e),vuelidate:a(T),store:a(p),resource:t._lang.backoffice.entities,itemIdField:"organizationId"},null,8,["loading","canSubmit","selectedLang","backRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource"])]),default:c(()=>[m(q,{formModel:a(e),"onUpdate:formModel":r[2]||(r[2]=i=>b(e)?e.value=i:e=i),disabled:!1,validateForm:!0,selectedLang:a(s),rules:a(E),loading:a(o),organizationId:a(l),organizationVersion:a(d),progressValue:a(g),"show-progress":!0,vuelidate:a(T)},null,8,["formModel","selectedLang","rules","loading","organizationId","organizationVersion","progressValue","vuelidate"])]),_:1},8,["title"])}}};export{ve as default};
