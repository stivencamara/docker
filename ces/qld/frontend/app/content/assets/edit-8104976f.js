import{_ as N}from"./form-84163000.js";import{s as D,L as j,z as H,r as i,a as R,i as p,G as A,N as h,J as x,u,x as v,b as _,o as T,l as J,w as I,e as l,g as e,c as L,F as P,D as k}from"./index-5b4ebf84.js";import{s as y}from"./helpers-28a0442c.js";import{u as Y}from"./service-ddb39df3.js";import{u as q}from"./index.esm-65642301.js";import{s as C}from"./service-09bdae54.js";import{b as Q}from"./helpers-4796f1a9.js";import{e as W}from"./edit-actions-88160b2f.js";import"./index.esm-85573352.js";import"./address.vue_vue_type_style_index_0_scoped_ab5200bc_lang-84b5de6f.js";import"./point-of-care-640dbae0.js";import"./form-3f3e5c38.js";import"./settings-fd6ffbf1.js";import"./refusal-5d03193c.js";import"./generic-74ec479d.js";import"./point-of-care-11ca6bee.js";import"./organization-cd538fe2.js";import"./helpers-56107f9e.js";import"./helpers-730fb974.js";import"./cancel-confirm-46a9e596.js";import"./helpers-991a1d67.js";import"./helpers-c8652456.js";import"./helpers-138c884f.js";/* empty css                                                                     */const ke={__name:"edit",setup(X){const S=D(),c=j(),z=H(),g=Y();let o=i(!0),a=R(y.newForm()),n=i(p.language.pt);i([]);let F=R(y.formRules()),f=i(0),b=i(0),E=i(0),m=i(0),w=i(0);const M=q(F,a),O=A(()=>E.value===100&&!o.value);async function G(){o.value=!0;const r=await C.getById(f.value,b.value);u.validateResponse(r,null,()=>{let t=r.data;t.eventTypeId=t.lifeEventId?p.eventType.life:p.eventType.business,t.processingTime.type=t.processingTime.weeks?p.processingTimeType.simplified:p.processingTimeType.advanced,Object.assign(a,t),g.setFormToCompare(u.cloneObject(t))}),o.value=!1}async function V(){o.value=!0;const r=await C.getLists(n.value);u.validateResponse(r,null,()=>{g.setLists(r.data)}),o.value=!1}h(()=>n.value,()=>{V()}),x(async()=>{f.value=u.decodeId(c.params.serviceId),b.value=u.decodeId(c.params.serviceVersion),m.value=u.decodeId(c.params.organizationId),w.value=u.decodeId(c.params.organizationVersion),!f.value||!b.value?S.push({name:v.router.BACKOFFICE_SERVICE_PAGE.name}):(await V(),await G())}),h(()=>[a.texts[0].name,a.organization,a.serviceTypeId,a.serviceCategoryId,a.startDate,a.economicActivityId,a.cost,a.virtual,a.serviceUrl],()=>{let r=y.progressFields();a.virtual?r.push("serviceUrl"):a.serviceUrl=null,Q.calculatePercentage(a,r,t=>{g.setProgress(t),E.value=t})});const B=A(()=>m.value>0?`${v.router.BACKOFFICE_EDIT_ENTITY_PAGE.path.replace(":organizationId",c.params.organizationId).replace(":organizationVersion",c.params.organizationVersion)}#servicos`:v.router.BACKOFFICE_SERVICE_PAGE.name);return(r,t)=>{const d=_("breadcrumb-item"),U=_("breadcrumb"),K=_("page");return T(),J(K,{title:r._lang.backoffice.service.editPageTitle},{breadcrumb:I(()=>[l(U,{"has-home":!0},{default:I(()=>[e(m)>0?(T(),L(P,{key:0},[l(d,{label:r._lang.backoffice.entities.breadcrumbTitle,"router-path":e(v).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),l(d,{label:e(z).common.entity,"router-path":e(B)},null,8,["label","router-path"]),l(d,{label:r._lang.backoffice.service.editPageTitle},null,8,["label"])],64)):(T(),L(P,{key:1},[l(d,{label:r._lang.backoffice.service.breadcrumbTitle,"router-path":e(v).router.BACKOFFICE_SERVICE_PAGE.path},null,8,["label","router-path"]),l(d,{label:r._lang.backoffice.service.editPageTitle},null,8,["label"])],64))]),_:1})]),actions:I(()=>[l(W,{loading:e(o),"onUpdate:loading":t[0]||(t[0]=s=>k(o)?o.value=s:o=s),canSubmit:e(O),selectedLang:e(n),"onUpdate:selectedLang":t[1]||(t[1]=s=>k(n)?n.value=s:n=s),backRoute:e(B),directBackRoute:e(m)>0,service:e(C),itemId:e(f),itemVersion:e(b),itemIdField:"serviceId",formModel:e(a),vuelidate:e(M),store:e(g),resource:r._lang.backoffice.service},null,8,["loading","canSubmit","selectedLang","backRoute","directBackRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource"])]),default:I(()=>[l(N,{formModel:e(a),"onUpdate:formModel":t[2]||(t[2]=s=>k(a)?a.value=s:a=s),disabled:!1,loading:e(o),selectedLang:e(n),validateForm:!0,rules:e(F),isExternalEdit:e(m)>0,progressValue:e(E)},null,8,["formModel","loading","selectedLang","rules","isExternalEdit","progressValue"])]),_:1},8,["title"])}}};export{ke as default};
