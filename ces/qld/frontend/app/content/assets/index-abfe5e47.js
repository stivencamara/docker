import{h as be,q as Ie,i as u,s as P,j as s,v as i,K as ye,b as fe,N as M,E as N,M as ge,r as d,o as V,e as _e,a as n,w as r,m as l,S as ve,c as w,V as Ce,z,L as Ve,y as A,F as ke,l as F}from"./index-60da5de7.js";import{l as O}from"./location-a7353a63.js";import{_ as Se,i as Te}from"./import-486de267.js";import{h as he}from"./helpers-48506bdb.js";import{b as we}from"./helpers-870863ae.js";import"./index.esm-eed786a6.js";const Ue={__name:"index",setup(ze){const k=be(),S=Ie();let c=u(!0),t=P(L()),E=P(s.createEmptyDataSource()),R=u([]),T=u([]),B=u([]),y=u([]),h=u([]),f=u([]),g=u([]),_=u([]),v=u(i.tableSelectedState.none),D=u("import");async function K(e){t.sortBy=e,await C()}async function G(e){t.pageIndex=e,await C()}function L(){return{pageIndex:1,sortBy:"Code desc",organization:null,locationTypeId:null,abreviation:null,location:null,recordStateIds:null,address:null,islandId:null,countyId:null,parishId:null,zipCode:null,active:!0}}async function $(){Object.assign(t,L()),await U()}async function U(){t.pageNumber=1,await C()}async function C(){c.value=!0;let e=await O.search(t);s.validateResponse(e,null,()=>{E=e.data}),c.value=!1}async function j(){c.value=!0;const e=await O.create(he.newForm());s.validateResponse(e,null,()=>{const o=s.encodeId(e.data.locationId),m=s.encodeId(e.data.locationVersion);k.push({name:F.router.BACKOFFICE_EDIT_LOCATION_PAGE.name,params:{locationId:o,locationVersion:m}})}),c.value=!1}function H(e){k.push({name:F.router.BACKOFFICE_EDIT_LOCATION_PAGE.name,params:{locationId:s.encodeId(e.locationId),locationVersion:s.encodeId(e.locationVersion)}})}function q(e){k.push({name:F.router.BACKOFFICE_DETAIL_LOCATION_PAGE.name,params:{locationId:s.encodeId(e.locationId),locationVersion:s.encodeId(e.locationVersion)}})}ye(async()=>{await C(),await J()}),fe(async()=>{R.value=s.convertEnumToArray(S.enums.locationType),T.value=s.convertEnumToArray(S.enums.recordStateType),B.value=s.concatItemsBadge(T.value,we.recordStateTypeBadgeOptions)});async function J(){c.value=!0;const e=await O.getLists("pt");s.validateResponse(e,null,()=>{y.value=e.data.divisionList}),c.value=!1}function Q(e){return y.value.find(m=>m.value===e).children}function W(e){return y.value.find(I=>I.value===t.islandId).children.find(I=>I.value===e).children}M(()=>t.islandId,()=>{const e=t.islandId;t.countyId=null,t.parishId=null,t.islandId||(t.countyId=null,t.parishId=null),e?h.value=Q(e):(h.value=[],f.value=[])}),M(()=>t.countyId,()=>{const e=t.countyId;t.parishId=null,t.countyId||(t.parishId=null),e?f.value=W(e):f.value=[]});const X=N(()=>!t.islandId),Y=N(()=>!t.countyId);function Z(){s.showModalById(D.value)}async function x(e){c.value=!0;let o={data:e.value.data,name:e.value.name},m=await Te.location(o);s.validateResponse(m,null,()=>{}),c.value=!1}const ee=u(ge.havePermission(i.permissions.parameter.createEdit));return(e,o)=>{const m=d("breadcrumb-item"),I=d("breadcrumb"),le=d("cbutton"),p=d("form-field"),te=d("row"),ae=d("cfilter"),oe=d("icon-import"),ne=d("cbutton-options"),ie=d("table-actions"),b=d("ccolumn"),de=d("table-action-edit"),se=d("table-action-detail"),ce=d("ctable"),re=d("container-wrapper"),ue=d("card"),me=d("page");return V(),_e(ke,null,[n(me,{title:e._lang.backoffice.location.pageTitle},{breadcrumb:r(()=>[n(I,{"has-home":!0},{default:r(()=>[n(m,{label:e._lang.backoffice.location.breadcrumbTitle},null,8,["label"])]),_:1})]),actions:r(()=>[n(le,{type:l(i).buttonType.secondary,size:l(i).buttonSize.medium,title:e._lang.common.toAdd,icon:ve,onClick:j},null,8,["type","size","title"])]),default:r(()=>[n(ue,{shadow:!0},{body:r(()=>[n(ae,{title:e._lang.common.filter,"clear-click":$,"apply-click":U,loading:l(c),collapsed:!0},{default:r(()=>[n(te,null,{default:r(()=>[n(p,{id:"code",class:"mb-3 col-12 col-md-6",label:e._lang.label.code,type:l(i).inputs.text,maxlength:45,modelValue:l(t).organization,"onUpdate:modelValue":o[0]||(o[0]=a=>l(t).organization=a)},null,8,["label","type","modelValue"]),n(p,{id:"islandId",class:"mb-3 col-12 col-md-6",modelValue:l(t).islandId,"onUpdate:modelValue":o[1]||(o[1]=a=>l(t).islandId=a),label:e._lang.label.islandId,loading:l(c),type:l(i).inputs.multiselect,options:l(y)},null,8,["modelValue","label","loading","type","options"]),n(p,{id:"countyId",class:"mb-3 col-12 col-md-6 col-lg-4",modelValue:l(t).countyId,"onUpdate:modelValue":o[2]||(o[2]=a=>l(t).countyId=a),label:e._lang.label.countyId,loading:l(c),type:l(i).inputs.multiselect,options:l(h),disabled:l(X)},null,8,["modelValue","label","loading","type","options","disabled"]),n(p,{id:"parishId",class:"mb-3 col-12 col-md-6 col-lg-4",modelValue:l(t).parishId,"onUpdate:modelValue":o[3]||(o[3]=a=>l(t).parishId=a),label:e._lang.label.parishId,loading:l(c),type:l(i).inputs.multiselect,options:l(f),disabled:l(Y)},null,8,["modelValue","label","loading","type","options","disabled"]),n(p,{id:"zipCode",class:"mb-3 col-md-12 col-lg-4",label:e._lang.label.zipCode,type:l(i).inputs.zipCode,maxlength:45,modelValue:l(t).zipCode,"onUpdate:modelValue":o[4]||(o[4]=a=>l(t).zipCode=a)},null,8,["label","type","modelValue"]),n(p,{id:"address",class:"mb-3 col-12 col-md-8",label:e._lang.label.address,type:l(i).inputs.address,maxlength:45,modelValue:l(t).address,"onUpdate:modelValue":o[5]||(o[5]=a=>l(t).address=a)},null,8,["label","type","modelValue"]),n(p,{id:"recordStateIds",class:"mb-3 col-12 col-md-4",label:e._lang.label.state,type:l(i).inputs.multiselect,modelValue:l(t).recordStateIds,"onUpdate:modelValue":o[6]||(o[6]=a=>l(t).recordStateIds=a),options:l(T),mode:l(i).multiselectMode.tags},null,8,["label","type","modelValue","options","mode"]),n(p,{id:"active",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:l(t).active,"onUpdate:modelValue":o[7]||(o[7]=a=>l(t).active=a),label:e._lang.label.active,type:l(i).inputs.checkbox,disabled:l(c)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","loading"]),ee.value?(V(),w(re,{key:0,class:"mt-4"},{default:r(()=>[n(ie,{title:e._lang.common.tableActionTitle},{default:r(()=>[n(ne,{type:l(i).buttonType.secondary},{default:r(()=>[n(Ce,{title:l(S).common.import,onClick:Z},{default:r(()=>[n(oe,{color:"#002D74"})]),_:1},8,["title"])]),_:1},8,["type"])]),_:1},8,["title"]),n(ce,{onSort:K,onChangePage:G,data:l(E),loading:l(c),checkbox:!1,selectedItems:l(g),"onUpdate:selectedItems":o[8]||(o[8]=a=>z(g)?g.value=a:g=a),unselectedItems:l(_),"onUpdate:unselectedItems":o[9]||(o[9]=a=>z(_)?_.value=a:_=a),selectedState:l(v),"onUpdate:selectedState":o[10]||(o[10]=a=>z(v)?v.value=a:v=a),checkboxField:"code"},{columns:r(()=>[n(b,{name:e._lang.label.oidCode,field:"code",sortable:!0,maxLength:10},null,8,["name"]),n(b,{name:e._lang.label.islandId,field:"island",sortField:"islandId",sortable:!0},null,8,["name"]),n(b,{name:e._lang.label.countyId,field:"county",sortField:"countyId",sortable:!0},null,8,["name"]),n(b,{name:e._lang.label.parishId,field:"parish",sortField:"parishId",sortable:!0},null,8,["name"]),n(b,{name:e._lang.label.zipCode,field:"zipCode",sortField:"zipCode",sortable:!0},null,8,["name"]),n(b,{name:e._lang.label.address,field:"address",sortField:"address",sortable:!0,maxLength:10},null,8,["name"]),n(b,{name:e._lang.common.state,field:"recordStateTypeId",align:l(i).columnAlign.center,custom:Ve,options:l(B),sortable:!0},null,8,["name","align","options"])]),actions:r(a=>[a.item.recordStateTypeId==l(i).recordStateType.draft?(V(),w(de,{key:0,onClick:pe=>H(a.item)},null,8,["onClick"])):A("",!0),a.item.recordStateTypeId>l(i).recordStateType.draft?(V(),w(se,{key:1,onClick:pe=>q(a.item)},null,8,["onClick"])):A("",!0)]),_:1},8,["data","loading","selectedItems","unselectedItems","selectedState"])]),_:1})):A("",!0)]),_:1})]),_:1},8,["title"]),n(Se,{action:x})],64)}}};export{Ue as default};
