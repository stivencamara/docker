import{h as M,C as G,q as D,D as H,i,s as R,v as C,E as T,M as Y,K as j,j as _,l as a,N as q,r as v,o as u,c as m,w as I,a as b,m as e,z as k,y as U}from"./index-d8a56bcc.js";import{u as J}from"./organization-cca91f92.js";import{o as w}from"./helpers-1cb82c85.js";import{o as E}from"./organization-7b90e5ff.js";import{_ as x}from"./detail-actions-61125ebe.js";import{_ as Q}from"./form-5ae8e89e.js";import"./helpers-d89764d1.js";import"./index.esm-d77c3574.js";import"./refusal-a1b91175.js";import"./helpers-a03e04a5.js";import"./helpers-71f72544.js";import"./helpers-eb16543c.js";import"./helpers-84e67dcb.js";import"./helpers-3cc5802d.js";import"./settings-55cfd82c.js";import"./contacts-e5b4fc11.js";import"./index.esm-90cb40dd.js";import"./address-e1a94fd0.js";import"./location-ff83fe07.js";import"./generic-0bf4d68e.js";import"./point-of-care-cd3cf399.js";import"./service-123d0948.js";import"./document-3c516f4f.js";const Ee={__name:"detail",setup(W){const L=M(),d=G();D();const S=H(),F=J(),n=i(0),s=i(0);let c=i(!0),o=R(w.newForm()),r=i(C.language.pt);i([]);let V=R(w.formRules()),p=i(null);const h=T(()=>d.path.toLowerCase().indexOf("tarefas")>-1),z=T(()=>d.path.toLowerCase().indexOf("pesquisa")>-1),y=i(Y.havePermission(C.permissions.organization.createEdit));j(async()=>{n.value=_.decodeId(d.params.organizationId),s.value=_.decodeId(d.params.organizationVersion),!n.value||!s.value?L.push({name:a.router.BACKOFFICE_ENTITIES_PAGE.name}):(await O(),await B(),A.value&&(await p.value.getHistory(),p.value.setActiveVersion(s.value),p.value.setStep()))});const A=T(()=>!h.value&&y.value&&o.recordStateTypeId!=C.recordStateType.draft);async function B(){const t=await E.getById(n.value,s.value);_.validateResponse(t,null,()=>{Object.assign(o,t.data),S.emit(a.emitter.OBJECT_LOADED,t.data)})}async function O(){c.value=!0;const t=await E.getLists(r.value);_.validateResponse(t,null,()=>{F.setLists(t.data)}),c.value=!1}return q(()=>r.value,()=>{O()}),(t,g)=>{const f=v("breadcrumb-item"),N=v("breadcrumb"),K=v("ctimeline"),P=v("page");return u(),m(P,{title:t._lang.backoffice.entities.detailPageTitle},{breadcrumb:I(()=>[b(N,{"has-home":!e(z)},{default:I(()=>[e(h)?(u(),m(f,{key:0,label:t._lang.backoffice.tasks.breadcrumbTitle,"router-path":e(a).router.BACKOFFICE_TASKS_PAGE.path},null,8,["label","router-path"])):e(z)?(u(),m(f,{key:1,label:t._lang.search.pageTitle,"router-path":e(a).router.BACKOFFICE_SEARCH_HISTORY_PAGE.path},null,8,["label","router-path"])):(u(),m(f,{key:2,label:t._lang.backoffice.entities.breadcrumbTitle,"router-path":e(a).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"])),b(f,{label:t._lang.backoffice.entities.detail},null,8,["label"])]),_:1},8,["has-home"])]),actions:I(()=>[b(x,{loading:e(c),selectedLang:e(r),"onUpdate:selectedLang":g[0]||(g[0]=l=>k(r)?r.value=l:r=l),service:e(E),backRoute:e(a).router.BACKOFFICE_ENTITIES_PAGE.name,editRoute:e(a).router.BACKOFFICE_EDIT_ENTITY_PAGE.name,itemIdField:"organizationId",itemVersionField:"organizationVersion",itemId:n.value,itemVersion:s.value,formModel:e(o),"show-record-state-actions":e(h),store:e(F)},null,8,["loading","selectedLang","service","backRoute","editRoute","itemId","itemVersion","formModel","show-record-state-actions","store"])]),default:I(()=>[e(A)?(u(),m(K,{key:0,itemId:n.value,detailRoute:e(a).router.BACKOFFICE_DETAIL_ENTITY_PAGE.name,service:e(E),versionFieldName:"organizationVersion",dateFieldName:"organizationApprovedDate",detailRouteIdField:"organizationId",detailRouteVersionField:"organizationVersion",ref_key:"timeline",ref:p},null,8,["itemId","detailRoute","service"])):U("",!0),b(Q,{formModel:e(o),"onUpdate:formModel":g[1]||(g[1]=l=>k(o)?o.value=l:o=l),disabled:!0,validateForm:!0,selectedLang:e(r),rules:e(V),loading:e(c),organizationId:n.value,organizationVersion:s.value,"show-progress":!1,vuelidate:null},null,8,["formModel","selectedLang","rules","loading","organizationId","organizationVersion"])]),_:1},8,["title"])}}};export{Ee as default};
