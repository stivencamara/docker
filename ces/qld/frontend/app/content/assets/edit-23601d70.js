import{_ as j}from"./form-c3577b0d.js";import{h as D,C as H,q,i as o,s as h,v,E as B,N as R,K as Y,j as i,l as g,r as T,o as F,c as x,w as E,a as n,m as e,e as P,F as z,z as S}from"./index-d8a56bcc.js";import{s as y}from"./helpers-eb16543c.js";import{u as J}from"./service-3c534453.js";import{u as Q}from"./index.esm-90cb40dd.js";import{s as k}from"./service-123d0948.js";import{b as W}from"./helpers-d89764d1.js";import{e as X}from"./edit-actions-13f6ab30.js";import"./index.esm-d77c3574.js";import"./address.vue_vue_type_style_index_0_scoped_2266ba05_lang-1cc0e248.js";import"./point-of-care-da1e0f34.js";import"./form-62456af2.js";import"./settings-55cfd82c.js";import"./refusal-a1b91175.js";import"./generic-0bf4d68e.js";import"./point-of-care-cd3cf399.js";import"./organization-cca91f92.js";import"./helpers-a03e04a5.js";import"./helpers-84e67dcb.js";import"./cancel-confirm-72811969.js";/* empty css                                                                     */const _e={__name:"edit",setup(Z){const L=D(),p=H(),w=q(),f=J();let s=o(!0),a=h(y.newForm()),u=o(v.language.pt);o([]);let C=h(y.formRules()),b=o(0),I=o(0),_=o(0),m=o(0),O=o(0),c=o([]);const M=Q(C,a),U=B(()=>_.value===100&&!s.value);async function K(){s.value=!0;const t=await k.getById(b.value,I.value);i.validateResponse(t,null,()=>{let r=t.data;r.eventTypeId=r.lifeEventId?v.eventType.life:v.eventType.business,r.processingTime.type=r.processingTime.weeks?v.processingTimeType.simplified:v.processingTimeType.advanced,Object.assign(a,r),f.setFormToCompare(i.cloneObject(r))}),s.value=!1}async function V(){s.value=!0;const t=await k.getLists(u.value);i.validateResponse(t,null,()=>{f.setLists(t.data)}),s.value=!1}R(()=>u.value,()=>{V()}),Y(async()=>{b.value=i.decodeId(p.params.serviceId),I.value=i.decodeId(p.params.serviceVersion),m.value=i.decodeId(p.params.organizationId),O.value=i.decodeId(p.params.organizationVersion),!b.value||!I.value?L.push({name:g.router.BACKOFFICE_SERVICE_PAGE.name}):(await V(),await K())}),R(()=>[a.texts[0].name,a.organization,a.serviceTypeId,a.serviceCategoryId,a.startDate,a.economicActivityId,a.virtual.isVirtual,a.stateSupport.isStateSupport],()=>{c.value=y.progressFields(),a.virtual.isVirtual?c.value.push("virtualUrl"):(i.removeItemOfArray(c.value,"virtualUrl"),a.virtual.url=null),a.stateSupport.isStateSupport?c.value.push("stateSupportUrl"):(i.removeItemOfArray(c.value,"stateSupportUrl"),a.stateSupport.url=null),W.calculatePercentage(a,c.value,t=>{f.setProgress(t),_.value=t})});const A=B(()=>m.value>0?`${g.router.BACKOFFICE_EDIT_ENTITY_PAGE.path.replace(":organizationId",p.params.organizationId).replace(":organizationVersion",p.params.organizationVersion)}#servicos`:g.router.BACKOFFICE_SERVICE_PAGE.name);return(t,r)=>{const d=T("breadcrumb-item"),G=T("breadcrumb"),N=T("page");return F(),x(N,{title:t._lang.backoffice.service.editPageTitle},{breadcrumb:E(()=>[n(G,{"has-home":!0},{default:E(()=>[e(m)>0?(F(),P(z,{key:0},[n(d,{label:t._lang.backoffice.entities.breadcrumbTitle,"router-path":e(g).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),n(d,{label:e(w).common.entity,"router-path":e(A)},null,8,["label","router-path"]),n(d,{label:t._lang.backoffice.service.editPageTitle},null,8,["label"])],64)):(F(),P(z,{key:1},[n(d,{label:t._lang.backoffice.service.breadcrumbTitle,"router-path":e(g).router.BACKOFFICE_SERVICE_PAGE.path},null,8,["label","router-path"]),n(d,{label:t._lang.backoffice.service.editPageTitle},null,8,["label"])],64))]),_:1})]),actions:E(()=>[n(X,{loading:e(s),"onUpdate:loading":r[0]||(r[0]=l=>S(s)?s.value=l:s=l),canSubmit:e(U),selectedLang:e(u),"onUpdate:selectedLang":r[1]||(r[1]=l=>S(u)?u.value=l:u=l),backRoute:e(A),directBackRoute:e(m)>0,service:e(k),itemId:e(b),itemVersion:e(I),itemIdField:"serviceId",formModel:e(a),vuelidate:e(M),store:e(f),resource:t._lang.backoffice.service,progressFields:e(c)},null,8,["loading","canSubmit","selectedLang","backRoute","directBackRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource","progressFields"])]),default:E(()=>[n(j,{formModel:e(a),"onUpdate:formModel":r[2]||(r[2]=l=>S(a)?a.value=l:a=l),disabled:!1,loading:e(s),selectedLang:e(u),validateForm:!0,rules:e(C),isExternalEdit:e(m)>0,progressValue:e(_)},null,8,["formModel","loading","selectedLang","rules","isExternalEdit","progressValue"])]),_:1},8,["title"])}}};export{_e as default};
