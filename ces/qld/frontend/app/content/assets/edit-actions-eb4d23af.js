import{_ as j}from"./cancel-confirm-46a9e596.js";import{J as D,s as T,z as F,r as E,a as N,n as H,G as C,u as n,b as i,o as c,c as $,e as s,l as p,g as o,D as Q,B as g,i as l,F as V,Q as G}from"./index-5b4ebf84.js";import{s as J}from"./settings-fd6ffbf1.js";const P={__name:"edit-actions",props:{loading:{Boolean,required:!0},selectedLang:{type:[String,Number],required:!1},formModel:{type:Object,required:!0},service:{type:Object,required:!0},itemId:{type:[String,Number],required:!0},vuelidate:{type:Object,required:!0},store:{type:Object,required:!0},resource:{type:Object},backRoute:{type:String,required:!0},showLangSelector:{Boolean,required:!0},canEdit:{type:Boolean,required:!0},canDelete:{type:Boolean,required:!0}},emits:["update:selectedLang","update:loading"],setup(I,{emit:f}){const e=I;D(async()=>{await q()});const r=T(),L=F(),y="confirm-cancel",b="confirm-delete";let v=E([]),k=N({});H(()=>{Object.assign(k,e.formModel)});const d=C({get(){return e.selectedLang},set(t){f("update:selectedLang",t)}}),a=C({get(){return e.loading},set(t){f("update:loading",t)}});async function q(){let t=await J.getLanguages();n.validateResponse(t,null,()=>{v.value=t.data})}function w(){n.compareObjectIsDirty(e.store.formToCompare,e.formModel)?n.showModalById(y):r.push({name:e.backRoute})}function B(){r.push({name:e.backRoute})}async function S(){e.canDelete&&n.showModalById(b)}async function z(){if(e.canDelete){a.value=!0;const t=await e.service.delete(e.itemId);n.validateResponse(t,e.resource.deleted,()=>{r.push({name:e.backRoute})}),a.value=!1}}async function u(){if(e.canEdit){if(a.value=!0,e.formModel.validateForm=!0,await e.vuelidate.$validate(),e.vuelidate.$error)G.warning(L.common.requiredFields);else{let t=null;console.log("props.itemId",e.itemId),console.log("!props.itemId",!e.itemId),!e.itemId||e.itemId===-1?t=await e.service.create(e.formModel):t=await e.service.update(e.formModel),n.validateResponse(t,e.resource.saved,()=>{Object.assign(k,e.formModel),e.store.setFormToCompare(e.formModel),r.push({name:e.backRoute})})}a.value=!1}}return(t,_)=>{const M=i("Hotkeys"),R=i("lang-selector"),m=i("cbutton"),h=i("confirm-delete-modal");return c(),$(V,null,[s(M,{shortcuts:["S"],debug:!0,onTriggered:u}),e.showLangSelector?(c(),p(R,{key:0,options:o(v),selectedLang:o(d),"onUpdate:selectedLang":_[0]||(_[0]=O=>Q(d)?d.value=O:null),disabled:o(a)},null,8,["options","selectedLang","disabled"])):g("",!0),s(m,{class:"col-12 col-sm-auto",type:o(l).buttonType.secondary,size:o(l).buttonSize.large,title:t._lang.common.cancel,onClick:w,disabled:o(a)},null,8,["type","size","title","disabled"]),e.canDelete?(c(),p(m,{key:1,class:"col-12 col-sm-auto",type:o(l).buttonType.secondary,size:o(l).buttonSize.large,title:t._lang.common.delete,onClick:S,disabled:o(a)},null,8,["type","size","title","disabled"])):g("",!0),e.canEdit?(c(),p(m,{key:2,class:"col-12 col-sm-auto",title:t._lang.common.save,type:o(l).buttonType.primary,size:o(l).buttonSize.large,onClick:u,disabled:o(a)},null,8,["title","type","size","disabled"])):g("",!0),s(j,{id:y,title:t._lang.common.cancel,action:B},null,8,["title"]),s(h,{id:b,title:t._lang.common.deleteTitle,message:t._lang.common.deleteQuestion,action:z},null,8,["title","message"]),s(M,{shortcuts:["S"],debug:!0,onTriggered:u})],64)}}};export{P as _};
