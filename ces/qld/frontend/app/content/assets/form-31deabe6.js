import{x as S,u as A,y as O,r as U,I as V,a as u,b as F,c as j,w as g,d as r,f as e,A as m,n as E,R as h,k as G,S as P,T,F as D}from"./index-920dbb37.js";import{u as H}from"./index.esm-d064d6e3.js";import{b}from"./helpers-4c156364.js";import{u as N}from"./users-c4c4ce38.js";const Q={formRules(){return{name:{required:b.requiredMessage()},displayName:{required:b.requiredMessage()},email:{required:b.requiredMessage(),email:b.emailMessage()}}},newProfileRules(){return{profileId:{required:b.requiredMessage()},organization:{required:b.requiredMessage()}}}},J={__name:"create-profile-modal",props:{modelValue:{type:Array,required:!0}},emits:["update:modelValue"],setup(z,{emit:k}){const a=z,q=S();A();const v="create-profile",y=N();let t=O(s()),$=Q.newProfileRules(),i=U(!1);const p=H($,t,{$scope:!1}),I=V({get(){return a.modelValue},set(l){k("update:modelValue",l)}});function s(){return{profileId:null,organization:null}}function C(){t=Object.assign(t,s()),p.value.$reset()}async function M(){if(i.value=!0,await p.value.$validate(),!p.value.$error){const l={profileId:t.profileId,organizationId:t.organization.id};I.value.filter(n=>n.profileId===t.profileId&&n.organizationId===t.organization.id).length?h.warning(q.common.profileExists):(I.value.push(l),t=Object.assign(t,s()),p.value.$reset(),E.closeModalById(v),h.success(q.common.profileAdded))}i.value=!1}return(l,o)=>{const n=u("form-field"),f=u("row"),c=u("cbutton"),w=u("modal");return F(),j(w,{id:v,title:l._lang.common.addContact,size:e(m).modalSize.extraLarge},{body:g(()=>[r(f,null,{default:g(()=>[r(n,{id:"profileId",class:"mb-3 col-12 col-md-6",modelValue:e(t).profileId,"onUpdate:modelValue":o[0]||(o[0]=_=>e(t).profileId=_),label:l._lang.label.profile,disabled:a.disabled,loading:a.loading,type:e(m).inputs.multiselect,options:e(y).profileList,required:!0,"show-error":e(p).profileId.$error,"error-message":l._errorMessageField(e(p).profileId)},null,8,["modelValue","label","disabled","loading","type","options","show-error","error-message"]),r(n,{id:"organization",class:"mb-3 col-12 col-md-6",modelValue:e(t).organization,"onUpdate:modelValue":o[1]||(o[1]=_=>e(t).organization=_),label:l._lang.label.organization,disabled:a.disabled,loading:a.loading,type:e(m).inputs.multiselect,required:!0,"show-error":e(p).organization.$error,options:e(y).organizationList,"error-message":l._errorMessageField(e(p).organization),"value-prop":e(m).multiselectValueProp.value3},null,8,["modelValue","label","disabled","loading","type","show-error","options","error-message","value-prop"])]),_:1})]),footer:g(()=>[r(c,{title:l._lang.common.cancel,type:e(m).buttonType.secondary,"data-bs-dismiss":"modal","aria-label":"Close",disabled:e(i),onClick:C},null,8,["title","type","disabled"]),r(c,{title:l._lang.common.save,onClick:M,disabled:e(i)},null,8,["title","disabled"])]),_:1},8,["title","size"])}}},x={__name:"form",props:{modelValue:{type:Object,required:!0,default:{name:"",email:"",profiles:[],active:!0}},loading:{type:Boolean,default:!1},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},vuelidator:{type:Object,default:{}}},emits:["update:modelValue"],setup(z,{emit:k}){const a=z,q=S(),v=N(),y="delete-profile";let t=U(null),$=U(!1);const i=V({get(){return a.modelValue},set(l){k("update:modelValue",l)}}),p=V(()=>E.createEmptyDataSource(I.value)),I=V(()=>{let l=[];return i.value.profiles.forEach(o=>{const n=v.profileList.find(c=>c.value===o.profileId),f=v.organizationList.find(c=>c.value3.id===o.organizationId);n&&f&&l.push({profile:n.label,organization:f.label})}),l}),s=V(()=>a.loading||$.value);function C(l){t.value=l}function M(){t.value&&(E.removeItemOfArray(i.value.profiles,t),h.success(q.common.contactRemoved),t.value=null)}return(l,o)=>{const n=u("form-field"),f=u("row"),c=u("table-actions"),w=u("ccolumn"),_=u("table-action-delete"),B=u("ctable"),R=u("container-wrapper"),L=u("confirm-delete-modal");return F(),G(D,null,[r(R,null,{default:g(()=>[r(f,null,{default:g(()=>[r(n,{id:"email",class:"mb-3 col-12 col-md-6",modelValue:e(i).email,"onUpdate:modelValue":o[0]||(o[0]=d=>e(i).email=d),label:l._lang.label.email,loading:e(s),type:e(m).inputs.text,required:a.required,disabled:e(s)||a.disabled,maxlength:150,showError:a.required&&a.vuelidator.email.$error,"error-message":l._errorMessageField(a.vuelidator.email)},null,8,["modelValue","label","loading","type","required","disabled","showError","error-message"]),r(n,{id:"name",class:"mb-3 col-12 col-md-6",modelValue:e(i).name,"onUpdate:modelValue":o[1]||(o[1]=d=>e(i).name=d),label:l._lang.label.name,loading:e(s),type:e(m).inputs.text,required:a.required,disabled:e(s)||a.disabled,maxlength:150,showError:a.required&&a.vuelidator.name.$error,"error-message":l._errorMessageField(a.vuelidator.name)},null,8,["modelValue","label","loading","type","required","disabled","showError","error-message"]),r(n,{id:"displayName",class:"mb-3 col-12",modelValue:e(i).displayName,"onUpdate:modelValue":o[2]||(o[2]=d=>e(i).displayName=d),label:l._lang.label.displayName,loading:e(s),type:e(m).inputs.text,required:a.required,disabled:e(s)||a.disabled,maxlength:150,showError:a.required&&a.vuelidator.displayName.$error,"error-message":l._errorMessageField(a.vuelidator.displayName)},null,8,["modelValue","label","loading","type","required","disabled","showError","error-message"]),r(n,{id:"active",class:"mb-3 col-12 col-lg-3",modelValue:e(i).active,"onUpdate:modelValue":o[3]||(o[3]=d=>e(i).active=d),label:l._lang.label.active,disabled:a.disabled,loading:e(s),type:e(m).inputs.checkbox},null,8,["modelValue","label","disabled","loading","type"]),r(n,{id:"isGraUser",class:"mb-3 col-12 col-lg-3",modelValue:e(i).isGraUser,"onUpdate:modelValue":o[4]||(o[4]=d=>e(i).isGraUser=d),label:l._lang.label.isGraUser,disabled:!0,loading:e(s),type:e(m).inputs.checkbox},null,8,["modelValue","label","loading","type"])]),_:1}),r(c,null,{default:g(()=>[r(P,{target:"create-profile",class:"d-inline",type:e(m).buttonType.secondary,title:l._lang.common.toAdd,disabled:a.disabled,icon:T},null,8,["type","title","disabled"])]),_:1}),r(B,{data:e(p),loading:e(s),checkbox:!1,showPagination:!1},{columns:g(()=>[r(w,{name:l._lang.label.profile,field:"profile",fieldSort:"profileId",sortable:!0},null,8,["name"]),r(w,{name:l._lang.label.organization,field:"organization",fieldSort:"organizationId",sortable:!0},null,8,["name"])]),actions:g(d=>[r(_,{id:y,onClick:K=>C(d.item),disabled:a.disabled},null,8,["onClick","disabled"])]),_:1},8,["data","loading"])]),_:1}),r(J,{modelValue:e(i).profiles,"onUpdate:modelValue":o[5]||(o[5]=d=>e(i).profiles=d)},null,8,["modelValue"]),r(L,{id:y,title:l._lang.common.deleteContact,message:l._lang.common.deleteContactQuestion,action:M},null,8,["title","message"])],64)}}};export{x as _,Q as h};
