import{s as D,z as K,r as y,U as x,i as p,I as J,u as f,a as q,J as H,b as a,o as w,l as h,w as n,e as t,g as o,S as Q,B as W,x as E}from"./index-5b4ebf84.js";import{u as I}from"./users-d8dbf72b.js";import{u as X}from"./users-f6b26c46.js";const ne={__name:"index",setup(Y){const S=D();K();const N=y(x.havePermission(p.permissions.users.createEdit)),_=X(),T=J();let b=y(f.createEmptyDataSource()),l=y(!1),s=q(C());async function B(){l.value=!0;const e=await I.getLists(T.getLanguage);f.validateResponse(e,null,()=>{_.setLists(e.data)}),l.value=!1}H(async()=>{await B(),await c()});function C(){return{pageNumber:1,sortBy:"name",usersIds:null,name:null,active:null,deleted:null}}async function c(){l.value=!0;let e=await I.search(s);f.validateResponse(e,null,async()=>{b.value=e.data,await F()}),l.value=!1}async function L(e){s.sortBy=e,await c()}async function R(e){s.pageNumber=e,await c()}function z(e){S.push({name:E.router.BACKOFFICE_SETTINGS_USERS_EDIT_PAGE.name,params:{userId:f.encodeId(e.userId)}})}function A(){S.push({name:E.router.BACKOFFICE_SETTINGS_USERS_CREATE_PAGE.name})}async function P(){Object.assign(s,C()),await k()}async function k(){s.pageNumber=1,await c()}async function F(){b.value.items.forEach(e=>{let i=[];e.profiles.forEach(u=>{const m=_.profileList.find(r=>r.value===u.profileId),d=_.organizationList.find(r=>r.value3.id===u.organizationId);m&&d&&i.push(`${m.label} (${d.label})`)}),e.profilesStr="",e.profilesStr=i.join(", ")})}return(e,i)=>{const u=a("breadcrumb-item"),m=a("breadcrumb"),d=a("cbutton"),r=a("form-field"),U=a("row"),V=a("cfilter"),v=a("ccolumn"),G=a("table-action-edit"),$=a("ctable"),M=a("container-wrapper"),O=a("card"),j=a("page");return w(),h(j,{title:e._lang.backoffice.settings.users.pageTitle},{breadcrumb:n(()=>[t(m,{"has-home":!0},{default:n(()=>[t(u,{label:e._lang.backoffice.settings.users.pageTitle},null,8,["label"])]),_:1})]),actions:n(()=>[N.value?(w(),h(d,{key:0,class:"col-12 col-sm-auto",type:o(p).buttonType.secondary,size:o(p).buttonSize.medium,title:e._lang.common.toAdd,icon:Q,onClick:A},null,8,["type","size","title"])):W("",!0)]),default:n(()=>[t(O,{shadow:!0},{body:n(()=>[t(V,{title:e._lang.common.filter,disabled:o(l),"clear-click":P,"apply-click":k,loading:o(l),collapsed:!0},{default:n(()=>[t(U,null,{default:n(()=>[t(r,{id:"perfilName",modelValue:o(s).name,"onUpdate:modelValue":i[0]||(i[0]=g=>o(s).name=g),class:"mb-3 col-12",label:e._lang.label.perfilName,type:o(p).inputs.text,maxlength:150,disabled:o(l)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","disabled","loading"]),t(M,null,{default:n(()=>[t($,{onSort:L,onChangePage:R,data:o(b),checkbox:!1,loading:o(l),defaultSort:"userId"},{columns:n(()=>[t(v,{name:e._lang.label.name,field:"name",sortable:!0},null,8,["name"]),t(v,{name:e._lang.label.profile,field:"profilesStr",sortable:!1},null,8,["name"])]),actions:n(g=>[t(G,{onClick:Z=>z(g.item)},null,8,["onClick"])]),_:1},8,["data","loading"])]),_:1})]),_:1})]),_:1},8,["title"])}}};export{ne as default};
