import{g as R,f as B,i as h,r as i,E as k,s as v,j as N,M as K,K as j,u as l,z as b,N as A,k as I,c as G,l as H,w as g,n as m,p as a,H as _}from"./index-074485c3.js";import{o as z}from"./organization-77309d9d.js";import{u as U}from"./organization-0a1af671.js";import{o as E}from"./helpers-6136d4cb.js";import{b as D}from"./helpers-9f106e00.js";import{u as q}from"./index.esm-ba4feb27.js";import{e as x}from"./edit-actions-9284da32.js";import{_ as J}from"./form-0aac030e.js";import"./index.esm-da08cc71.js";import"./refusal-f524e0ab.js";import"./cancel-confirm-7618a353.js";import"./settings-c1957f95.js";/* empty css                                                                     */import"./contacts-6b20bf02.js";import"./location-bb510207.js";import"./address-7818ed07.js";import"./generic-9fc3b9dd.js";import"./point-of-care-69e1e40c.js";import"./helpers-3438087c.js";import"./service-1dc5fd50.js";import"./helpers-1bacd47d.js";import"./helpers-d98c457a.js";import"./document-70e5cc70.js";import"./helpers-130c44c2.js";const _e={__name:"edit",setup(Q){const L=R(),F=B();h();const p=U();let d=i(0),u=i(0),o=i(!0),e=k(E.newForm()),s=i(v.language.pt),C=k(E.formRules()),f=i(0),c=i([]);const T=q(C,e,{$stopPropagation:!0}),w=N(()=>f.value===100&&!o.value),P=i(K.havePermission(v.permissions.organization.createEdit));j(async()=>{d.value=l.decodeId(F.params.organizationId),u.value=l.decodeId(F.params.organizationVersion),!d.value||!u.value?L.push({name:b.router.BACKOFFICE_ENTITIES_PAGE.name}):(await y(),await S())});async function S(){o.value=!0;const t=await z.getById(d.value,u.value);l.validateResponse(t,null,()=>{Object.assign(e,t.data),p.setFormToCompare(l.cloneObject(t.data))}),o.value=!1}async function y(){o.value=!0;const t=await z.getLists(s.value);l.validateResponse(t,null,()=>{p.setLists(t.data)}),o.value=!1}return A(()=>s.value,()=>{y()}),A(()=>[e.nipc,e.texts[0].name,e.groupName,e.organizationTypeId,e.parentOrganization,e.startDate,e.economicActivityId,e.divisionTypeId,e.divisionId,e.address.zipCode,e.address.islandId,e.address.countyId,e.address.parishId,e.address.locality,e.address.address],()=>{c.value=E.progressFields(),e.divisionTypeId===v.notApplicable&&l.removeItemOfArray(c.value,"divisionId"),D.calculatePercentage(e,c.value,t=>{p.setProgress(t),f.value=t})}),(t,n)=>{const V=I("breadcrumb-item"),M=I("breadcrumb"),O=I("page");return G(),H(O,{title:t._lang.backoffice.entities.editPageTitle},{breadcrumb:g(()=>[m(M,{"has-home":!0},{default:g(()=>[m(V,{label:t._lang.backoffice.entities.breadcrumbTitle,"router-path":a(b).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),m(V,{label:t._lang.backoffice.entities.editPageTitle},null,8,["label"])]),_:1})]),actions:g(()=>[m(x,{loading:a(o),"onUpdate:loading":n[0]||(n[0]=r=>_(o)?o.value=r:o=r),canSubmit:a(w),selectedLang:a(s),"onUpdate:selectedLang":n[1]||(n[1]=r=>_(s)?s.value=r:s=r),backRoute:a(b).router.BACKOFFICE_ENTITIES_PAGE.name,service:a(z),itemId:a(d),itemVersion:a(u),formModel:a(e),vuelidate:a(T),store:a(p),resource:t._lang.backoffice.entities,itemIdField:"organizationId",progressFields:a(c)},null,8,["loading","canSubmit","selectedLang","backRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource","progressFields"])]),default:g(()=>[m(J,{formModel:a(e),"onUpdate:formModel":n[2]||(n[2]=r=>_(e)?e.value=r:e=r),disabled:!1,validateForm:!0,selectedLang:a(s),rules:a(C),loading:a(o),organizationId:a(d),organizationVersion:a(u),progressValue:a(f),"show-progress":!0,vuelidate:a(T),canCreate:P.value},null,8,["formModel","selectedLang","rules","loading","organizationId","organizationVersion","progressValue","vuelidate","canCreate"])]),_:1},8,["title"])}}};export{_e as default};
