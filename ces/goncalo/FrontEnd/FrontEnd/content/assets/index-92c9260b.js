import{g as Q,i as Y,K as Z,W as $,r as u,v as d,u as c,j as ee,L as te,o as ae,N as oe,l as m,c as b,m as g,n as r,q as n,s as e,U as le,A as v,X as ne,J as C,M as de,B as k}from"./index-eb4a79b4.js";import{d as h}from"./document-7bd6141e.js";import{u as se}from"./document-17481a2b.js";import{d as ce}from"./helpers-48cafe05.js";import{b as me}from"./helpers-e0a01141.js";import"./index.esm-da6c7db5.js";const fe={__name:"index",setup(re){const V=Q(),E=Y(),F=se(),B=Z(),l=$();let s=u(!1),y=u([]),f=u([]),S=u(d.tableSelectedState.none),I=u([]),U=u([]),w=u(c.createEmptyDataSource());ee({}),te(async()=>{s.value=!0,I.value=c.convertEnumToArray(E.enums.recordStateType);const t=await h.getLists(B.getLanguage);c.validateResponse(t,null,()=>{F.setLists(t.data),I.value=c.convertEnumToArray(E.enums.recordStateType),U.value=c.concatItemsBadge(I.value,me.recordStateTypeBadgeOptions)}),s.value=!1}),ae(async()=>{await _()});function L(t){V.push({name:k.router.BACKOFFICE_EDIT_DOCUMENT_PAGE.name,params:{documentId:c.encodeId(t.documentId),documentVersion:c.encodeId(t.documentVersion)}})}function O(t){V.push({name:k.router.BACKOFFICE_DETAIL_DOCUMENT_PAGE.name,params:{documentId:c.encodeId(t.documentId),documentVersion:c.encodeId(t.documentVersion)}})}async function D(){l.resetDocumentSearchForm(),await A()}async function A(){l.documentSearchForm.pageNumber=1,await _()}async function P(){s.value=!0;const t=await h.create(ce.newForm());c.validateResponse(t,null,()=>{const o=c.encodeId(t.data.documentId),T=c.encodeId(t.data.documentVersion);V.push({name:k.router.BACKOFFICE_EDIT_DOCUMENT_PAGE.name,params:{documentId:o,documentVersion:T}})}),s.value=!1}async function z(t){l.documentSearchForm.sortBy=t,await _()}async function M(t){l.documentSearchForm.pageNumber=t,await _()}async function _(){s.value=!0;let t=await h.search(l.documentSearchForm);c.validateResponse(t,null,()=>{w.value=t.data}),s.value=!1}const N=u(oe.havePermission(d.permissions.document.createEdit));return(t,o)=>{const T=m("breadcrumb-item"),R=m("breadcrumb"),G=m("cbutton"),i=m("form-field"),K=m("row"),H=m("cfilter"),p=m("ccolumn"),x=m("table-action-edit"),W=m("table-action-detail"),j=m("ctable"),q=m("card"),J=m("page");return b(),g(J,{title:t._lang.backoffice.document.pageTitle},{breadcrumb:r(()=>[n(R,{"has-home":!0},{default:r(()=>[n(T,{label:t._lang.backoffice.document.breadcrumbTitle},null,8,["label"])]),_:1})]),actions:r(()=>[N.value?(b(),g(G,{key:0,class:"col-12 col-sm-auto",type:e(d).buttonType.secondary,size:e(d).buttonSize.medium,title:t._lang.common.toAdd,icon:le,onClick:P},null,8,["type","size","title"])):v("",!0)]),default:r(()=>[n(q,{shadow:!0},{body:r(()=>[n(H,{title:t._lang.common.filter,disabled:e(s),"clear-click":D,"apply-click":A,loading:e(s),collapsed:!0},{default:r(()=>[n(K,null,{default:r(()=>[n(i,{id:"code",modelValue:e(l).documentSearchForm.code,"onUpdate:modelValue":o[0]||(o[0]=a=>e(l).documentSearchForm.code=a),class:"mb-3 col-12 col-md-6 col-xl-4",label:t._lang.label.code,type:e(d).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),n(i,{class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(l).documentSearchForm.documentTypeIds,"onUpdate:modelValue":o[1]||(o[1]=a=>e(l).documentSearchForm.documentTypeIds=a),label:t._lang.label.documentTypeId,type:e(d).inputs.multiselect,options:e(F).documentTypeList,disabled:e(s),mode:e(d).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),n(i,{id:"organization",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(l).documentSearchForm.organization,"onUpdate:modelValue":o[2]||(o[2]=a=>e(l).documentSearchForm.organization=a),label:t._lang.label.organizationHost,type:e(d).inputs.multiselect,options:e(F).organizationList,disabled:e(s),valueProp:e(d).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),n(i,{class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(l).documentSearchForm.abreviation,"onUpdate:modelValue":o[3]||(o[3]=a=>e(l).documentSearchForm.abreviation=a),label:t._lang.label.abreviation,type:e(d).inputs.text,maxlength:16,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),n(i,{id:"name",class:"mb-3 col-12 col-md-8",modelValue:e(l).documentSearchForm.name,"onUpdate:modelValue":o[4]||(o[4]=a=>e(l).documentSearchForm.name=a),label:t._lang.label.name,type:e(d).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),n(i,{id:"recordStateIds",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(l).documentSearchForm.recordStateIds,"onUpdate:modelValue":o[5]||(o[5]=a=>e(l).documentSearchForm.recordStateIds=a),label:t._lang.label.state,type:e(d).inputs.multiselect,options:e(I),disabled:e(s),mode:e(d).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),t._isGuestLogged?v("",!0):(b(),g(i,{key:0,id:"active",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(l).documentSearchForm.active,"onUpdate:modelValue":o[6]||(o[6]=a=>e(l).documentSearchForm.active=a),label:t._lang.label.public,type:e(d).inputs.checkbox,disabled:e(s)},null,8,["modelValue","label","type","disabled"]))]),_:1})]),_:1},8,["title","disabled","loading"]),n(ne,null,{default:r(()=>[n(j,{onSort:z,onChangePage:M,selectedItems:e(y),"onUpdate:selectedItems":o[7]||(o[7]=a=>C(y)?y.value=a:y=a),unselectedItems:e(f),"onUpdate:unselectedItems":o[8]||(o[8]=a=>C(f)?f.value=a:f=a),selectedState:e(S),"onUpdate:selectedState":o[9]||(o[9]=a=>C(S)?S.value=a:S=a),data:e(w),checkbox:!1,loading:e(s),defaultSort:"pointOfCareId",checkboxField:"code"},{columns:r(()=>[n(p,{name:t._lang.label.code,field:"code",sortable:!0},null,8,["name"]),n(p,{name:t._lang.label.documentTypeId,field:"documentType",sortField:"documentTypeId",sortable:!0},null,8,["name"]),n(p,{name:t._lang.label.abreviation,field:"abreviation",sortable:!0},null,8,["name"]),n(p,{name:t._lang.label.name,field:"name",sortable:!0},null,8,["name"]),n(p,{name:t._lang.label.state,field:"recordStateTypeId",align:e(d).columnAlign.center,custom:de,options:e(U),sortable:!0},null,8,["name","align","options"])]),actions:r(a=>[a.item.recordStateTypeId==e(d).recordStateType.draft?(b(),g(x,{key:0,onClick:X=>L(a.item)},null,8,["onClick"])):v("",!0),a.item.recordStateTypeId>e(d).recordStateType.draft?(b(),g(W,{key:1,onClick:X=>O(a.item)},null,8,["onClick"])):v("",!0)]),_:1},8,["selectedItems","unselectedItems","selectedState","data","loading"])]),_:1})]),_:1})]),_:1},8,["title"])}}};export{fe as default};
