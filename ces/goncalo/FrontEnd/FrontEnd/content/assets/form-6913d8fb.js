import{u as ue}from"./index.esm-cb674bb3.js";import{_ as ce,a as me,b as pe}from"./contacts-d3b588bb.js";import{_ as ge,a as fe}from"./address.vue_vue_type_style_index_0_scoped_5480b292_lang-47e90e58.js";import{k as O,l as p,c as I,m as h,n as C,q as t,s as e,L as F,v as m,_ as be,u as y,r as g,w as ve,e as D,p as Y,Q as ye,S as _e,F as le,i as ne,M as Ve,j as ee,N as de,o as Ce,O as se,P as oe,H as Se,f as Oe,g as Ie,y as Te,x as Le,A as $}from"./index-4697834f.js";import{b as w}from"./helpers-dd41a15e.js";import{u as ke}from"./organization-7b91c1de.js";import{u as ie}from"./point-of-care-85a572b5.js";import{_ as Be}from"./address-abee3728.js";import{_ as Fe,a as we}from"./refusal-33cbc43b.js";import{r as Ne}from"./index.esm-168b7626.js";import{_ as he}from"./generic-c72c98c8.js";import{p as ae}from"./point-of-care-819dce5d.js";import{s as Z}from"./service-ee40d3dc.js";import{u as Ae}from"./service-46584954.js";import{s as Ee}from"./helpers-e69c6c3b.js";const Me={__name:"description",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},selectedLang:{type:[String,Number],required:!0},validateForm:{type:Boolean,default:!1},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(b,{emit:d}){const n=b;ke();const i=O({get(){return n.modelValue},set(l){d("update:modelValue",l)}}),a=O(()=>n.selectedLang),f=O({get(){return w.getFieldByLangAndName(i.value,a.value,"description")},set(l){w.setFieldByLangAndName(i.value,a.value,"description",l)}}),v=O({get(){return w.getFieldByLangAndName(i.value,a.value,"preConditions")},set(l){w.setFieldByLangAndName(i.value,a.value,"preConditions",l)}});return O({get(){return w.getFieldByLangAndName(i.value,a.value,"keywords")},set(l){w.setFieldByLangAndName(i.value,a.value,"keywords",l)}}),(l,o)=>{const r=p("form-field"),B=p("accordion");return I(),h(B,{id:"description",title:l._lang.common.description,collapsed:!1,class:"mb-4"},{default:C(()=>[t(r,{id:"description",class:"mb-3 col-12",modelValue:e(f),"onUpdate:modelValue":o[0]||(o[0]=s=>F(f)?f.value=s:null),label:l._lang.label.description,disabled:n.disabled,loading:n.loading,type:e(m).inputs.text,maxlength:255,language:e(a)},null,8,["modelValue","label","disabled","loading","type","language"]),t(r,{id:"preConditions",class:"mb-3 col-12",modelValue:e(v),"onUpdate:modelValue":o[1]||(o[1]=s=>F(v)?v.value=s:null),label:l._lang.label.preConditions,disabled:n.disabled,loading:n.loading,type:e(m).inputs.text,maxlength:255,language:e(a)},null,8,["modelValue","label","disabled","loading","type","language"])]),_:1},8,["title"])}}},qe={class:"input-group mb-3"},Re=["aria-describedby"],Ue=["id","disabled"],je={__name:"address",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},validateForm:{type:Boolean,default:!1},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(b,{emit:d}){const n=b,i=ie(),a=y.uuid();let f=g(0),v=g(0);const l=g(!1);g(!1);const o=O({get(){return n.modelValue},set(S){d("update:modelValue",S)}}),r="search-location";function B(S){Object.assign(o.value.address,S),f.value++}function s(){v.value++,window.setTimeout(function(){y.showModalById(r)},5)}return ve(o.value,S=>{S.address.locationId!=null&&(l.value?(S.address.locationId=null,S.address.code=null,l.value=!1):l.value=!0)}),(S,k)=>{const A=p("icon-search"),T=p("accordion");return I(),D(le,null,[t(T,{id:"address-accordion",title:S._lang.backoffice.entities.address,collapsed:!1,class:"mb-4"},{default:C(()=>[Y("div",qe,[ye(Y("input",{ref:"locationQuery",id:"location-query",type:"text",class:"form-control",placeholder:"Código do património","aria-label":"placeholder","aria-describedby":e(a),disabled:"","onUpdate:modelValue":k[0]||(k[0]=N=>e(o).address.code=N)},null,8,Re),[[_e,e(o).address.code]]),Y("button",{class:"btn btn-primary",type:"button",id:e(a),disabled:n.disabled,onClick:s},[t(A,{color:"#FFF"})],8,Ue)]),(I(),h(Be,{key:e(f),modelValue:e(o).address,"onUpdate:modelValue":k[1]||(k[1]=N=>e(o).address=N),disabled:n.disabled,rules:n.rules,loading:n.loading,"validate-form":n.validateForm&&e(o).address.isRequired,store:e(i),vuelidate:n.vuelidate},null,8,["modelValue","disabled","rules","loading","validate-form","store","vuelidate"]))]),_:1},8,["title"]),(I(),h(ce,{key:e(v),onApply:B}))],64)}}},$e=be(je,[["__scopeId","data-v-5480b292"]]),ze={__name:"service-channel-requirements",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},validateForm:{type:Boolean,default:!1},selectedLang:{type:[String,Number],required:!0},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(b,{emit:d}){const n=b,i=O({get(){return n.modelValue},set(l){d("update:modelValue",l)}}),a=O(()=>n.selectedLang),f=O({get(){return w.getFieldByLangAndName(i.value,a.value,"openingHours")},set(l){w.setFieldByLangAndName(i.value,a.value,"openingHours",l)}}),v=O({get(){return w.getFieldByLangAndName(i.value,a.value,"attendanceRestrictions")},set(l){w.setFieldByLangAndName(i.value,a.value,"attendanceRestrictions",l)}});return(l,o)=>{const r=p("form-field"),B=p("accordion");return I(),h(B,{id:"attendance-restrictions",title:l._lang.backoffice.pointOfCare.serviceChannelRequirements,collapsed:!1,class:"mb-4"},{default:C(()=>[t(r,{id:"openingHours",class:"mb-3 col-12",modelValue:e(f),"onUpdate:modelValue":o[0]||(o[0]=s=>F(f)?f.value=s:null),label:l._lang.label.openingHours,disabled:n.disabled,loading:n.loading,type:e(m).inputs.textarea,rows:3,language:e(a),maxlength:2e3},null,8,["modelValue","label","disabled","loading","type","language"]),t(r,{id:"attendanceRestrictions",class:"mb-3 col-12",modelValue:e(v),"onUpdate:modelValue":o[1]||(o[1]=s=>F(v)?v.value=s:null),label:l._lang.label.attendanceRestrictions,disabled:n.disabled,loading:n.loading,type:e(m).inputs.textarea,rows:3,language:e(a),maxlength:2e3},null,8,["modelValue","label","disabled","loading","type","language"])]),_:1},8,["title"])}}},Pe={__name:"general",props:{modelValue:{type:Object,required:!0},selectedLang:Ne,disabled:{Boolean,default:!0},rules:{Boolean,default:!0},validateForm:{Boolean,default:!1},loading:{Object,default:{}},isExternalEdit:{type:Boolean,default:!1},vuelidate:{type:Object,default:null}},setup(b){const d=b,n=ie(),i=ue(d.rules,d.modelValue),a=O({get(){return d.modelValue},set(l){emit("update:modelValue",l)}}),f=O(()=>d.selectedLang),v=O(()=>d.selectedLang===m.language.en);return(l,o)=>(I(),D(le,null,[t(Fe,{modelValue:e(a),"onUpdate:modelValue":o[0]||(o[0]=r=>F(a)?a.value=r:null),store:e(n)},null,8,["modelValue","store"]),t(e(ge),{modelValue:e(a),"onUpdate:modelValue":o[1]||(o[1]=r=>F(a)?a.value=r:null),disabled:d.disabled,loading:b.loading,selectedLang:d.selectedLang,validateForm:d.validateForm,rules:d.rules,isExternalEdit:d.isExternalEdit,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","validateForm","rules","isExternalEdit","vuelidate"]),t(e(Me),{modelValue:e(a),"onUpdate:modelValue":o[2]||(o[2]=r=>F(a)?a.value=r:null),disabled:d.disabled,loading:b.loading,selectedLang:d.selectedLang,validateForm:d.validateForm,rules:d.rules,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","validateForm","rules","vuelidate"]),t(e($e),{modelValue:d.modelValue,"onUpdate:modelValue":o[3]||(o[3]=r=>d.modelValue=r),disabled:d.disabled,loading:b.loading||e(v),rules:d.rules,validateForm:d.validateForm,vuelidate:e(i)},null,8,["modelValue","disabled","loading","rules","validateForm","vuelidate"]),t(e(ze),{modelValue:e(a),"onUpdate:modelValue":o[4]||(o[4]=r=>F(a)?a.value=r:null),disabled:d.disabled,loading:b.loading,selectedLang:d.selectedLang,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","vuelidate"]),t(e(pe),{modelValue:e(a).contacts,"onUpdate:modelValue":o[5]||(o[5]=r=>e(a).contacts=r),disabled:d.disabled||e(v),modal:me,store:e(n),loading:b.loading},null,8,["modelValue","disabled","store","loading"]),t(e(we),{modelValue:e(a),"onUpdate:modelValue":o[6]||(o[6]=r=>F(a)?a.value=r:null),disabled:d.disabled,loading:b.loading,selectedLang:d.selectedLang,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","vuelidate"]),t(he,{modelValue:e(a),"onUpdate:modelValue":o[7]||(o[7]=r=>F(a)?a.value=r:null),disabled:d.disabled,loading:b.loading,selectedLang:e(f),vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","vuelidate"])],64))}},He={__name:"search-service-modal",props:{pointOfCareId:{Number,required:!0},pointOfCareVersion:{Number,required:!0}},emits:["apply"],setup(b,{emit:d}){const n=b,i=Ae(),a="search-service-modal",f=ne(),v=Ve();let l=ee(R()),o=g([]),r=g([]),B=g(y.createEmptyDataSource()),s=g(!1),S=g(!1),k=g(0),A=g("pt"),T=ee(N());function N(){return Ee.newForm()}function R(){return{pageNumber:1,sortBy:"Code",code:null,serviceTypeIds:null,serviceCategoryIds:null,businessEventIds:null,lifeEventIds:null,abreviation:null,name:null,organization:null,recordStateIds:[m.recordStateType.published],active:!0}}de(async()=>{s.value=!0,o.value=y.convertEnumToArray(f.enums.recordStateType);const u=await Z.getLists(v.getLanguage);y.validateResponse(u,null,()=>{i.setLists(u.data),o.value=y.convertEnumToArray(f.enums.recordStateType),r.value=y.concatItemsBadge(o.value,w.recordStateTypeBadgeOptions)}),s.value=!1}),Ce(async()=>{await M()});async function j(u){l.sortBy=u,await M()}async function z(u){l.pageNumber=u,await M()}async function M(){s.value=!0;let u=await Z.search(l);y.validateResponse(u,null,()=>{B.value=u.data}),s.value=!1}async function x(){Object.assign(l,R()),await M()}async function K(){await M()}async function Q(u){const _=await Z.getById(u.serviceId,u.serviceVersion);y.validateResponse(_,null,()=>{Object.assign(T,_.data),S.value=!0}),k.value++}function G(){}async function U(){s.value=!0;const u=await ae.associationCreate(n.pointOfCareId,n.pointOfCareVersion,T.serviceId,T.serviceVersion);y.validateResponse(u,f.backoffice.pointOfCare.serviceAdded,()=>{d("apply")}),s.value=!1}return(u,_)=>{const E=p("form-field"),P=p("row"),c=p("cfilter"),L=p("ccolumn"),J=p("table-action-detail"),W=p("ctable"),q=p("container-wrapper"),H=p("cbutton"),X=p("modal");return I(),h(X,{id:a,title:u._lang.backoffice.service.searchTitle,size:e(m).modalSize.extraLarge,"remove-padding":!0},{body:C(()=>[t(c,{title:u._lang.common.filter,disabled:e(s),"clear-click":x,"apply-click":K,loading:e(s),collapsed:!0},{default:C(()=>[t(P,null,{default:C(()=>[t(E,{id:"code",modelValue:e(l).code,"onUpdate:modelValue":_[0]||(_[0]=V=>e(l).code=V),class:"mb-3 col-12 col-md-6 col-xl-4",label:u._lang.label.code,type:e(m).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),t(E,{id:"serviceTypeId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(l).serviceTypeIds,"onUpdate:modelValue":_[1]||(_[1]=V=>e(l).serviceTypeIds=V),label:u._lang.label.serviceTypeId,type:e(m).inputs.multiselect,options:e(i).serviceTypeList,disabled:e(s),mode:e(m).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),t(E,{id:"serviceCategoryId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(l).serviceCategoryIds,"onUpdate:modelValue":_[2]||(_[2]=V=>e(l).serviceCategoryIds=V),label:u._lang.label.serviceCategoryId,type:e(m).inputs.multiselect,options:e(i).serviceCategoryList,disabled:e(s),mode:e(m).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),t(E,{id:"abreviation",class:"mb-3 col-12 col-md-6",modelValue:e(l).abreviation,"onUpdate:modelValue":_[3]||(_[3]=V=>e(l).abreviation=V),label:u._lang.label.abreviation,type:e(m).inputs.text,maxlength:16,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),t(E,{id:"organizationId",class:"mb-3 col-12 col-md-6",modelValue:e(l).organization,"onUpdate:modelValue":_[4]||(_[4]=V=>e(l).organization=V),label:u._lang.label.organizationHost,type:e(m).inputs.multiselect,options:e(i).organizationList,disabled:e(s),valueProp:e(m).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),t(E,{id:"name",class:"mb-3 col-12",modelValue:e(l).name,"onUpdate:modelValue":_[5]||(_[5]=V=>e(l).name=V),label:u._lang.label.name,type:e(m).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","disabled","loading"]),t(q,null,{default:C(()=>[t(W,{onSort:j,onChangePage:z,data:e(B),checkbox:!1,loading:e(s),defaultSort:"Code"},{columns:C(()=>[t(L,{name:u._lang.label.code,field:"code",sortable:!0},null,8,["name"]),t(L,{name:u._lang.label.serviceTypeId,field:"serviceType",sortField:"serviceTypeId",sortable:!0},null,8,["name"]),t(L,{name:u._lang.label.abreviation,field:"abreviation",sortable:!0},null,8,["name"]),t(L,{name:u._lang.label.name,field:"name",sortable:!0},null,8,["name"]),t(L,{name:u._lang.label.state,field:"recordStateTypeId",align:e(m).columnAlign.center,custom:se,options:e(r),sortable:!0},null,8,["name","align","options"])]),actions:C(V=>[t(J,{onClick:te=>Q(V.item)},null,8,["onClick"])]),_:1},8,["data","loading"])]),_:1}),(I(),h(e(fe),{collapsed:e(S),class:"mt-5",key:e(k),modelValue:e(T),"onUpdate:modelValue":_[6]||(_[6]=V=>F(T)?T.value=V:T=V),disabled:!0,loading:e(s),selectedLang:e(A),validateForm:!1},null,8,["collapsed","modelValue","loading","selectedLang"]))]),footer:C(()=>[t(H,{type:"primary",size:"large",title:u._lang.common.apply,"data-bs-dismiss":"modal",onClick:U,disabled:!e(T).code},null,8,["title","disabled"]),t(H,{type:"secondary",size:"large",title:u._lang.common.cancel,"data-bs-dismiss":"modal",onClick:G},null,8,["title"])]),_:1},8,["title","size"])}}},De=["id"],xe={__name:"services",props:{formModel:{Object,required:!0}},setup(b){var E,P;const d=b,n=g(oe.havePermission(m.permissions.pointOfCare.createEdit)&&(((E=d.formModel)==null?void 0:E.recordStateTypeId)==m.recordStateType.draft||((P=d.formModel)==null?void 0:P.recordStateTypeId)==m.recordStateType.published)),i=g(oe.havePermission(m.permissions.pointOfCare.approve)),a=O(()=>{let c=Se.getUser();return!c||!c.name?!1:c.name.toLowerCase()==="guest"});de(async()=>{k.value=y.decodeId(o.params.pointOfCareId),A.value=y.decodeId(o.params.pointOfCareVersion),j.value=y.convertEnumToArray(r.enums.recordStateType),!k.value||!A.value?B.push({name:constants.router.BACKOFFICE_POINT_OF_CARE_PAGE.name}):(N.pointOfCareId=k.value,N.pointOfCareVersion=A.value,await U(),j.value=y.convertEnumToArray(r.enums.recordStateType),z.value=y.concatItemsBadge(j.value,w.recordStateTypeBadgeOptions))});const f="search-service-modal",v="delete-service",l=y.uuid(),o=Oe(),r=ne(),B=Ie();let s=g(!0),S=g(0),k=g(0),A=g(0),T=g(y.createEmptyDataSource()),N=ee(x()),R=g(null),j=g([]),z=g([]),M=g(!1);function x(){let c=null;return a.value&&(c=[m.recordStateType.published]),{pageNumber:1,sortBy:"ServiceName",active:!0,pointOfCareId:null,pointOfCareVersion:null,recordStateTypeIds:c}}function K(){S.value++,M.value=!0,window.setTimeout(function(){y.showModalById(f)},5)}async function Q(c){N.sortBy=c,await U()}async function G(c){N.pageNumber=c,await U()}async function U(){s.value=!0;let c=await ae.associationSearch(N);y.validateResponse(c,null,()=>{T.value=c.data,T.value.items.forEach(L=>{L.recordStateTypeId=m.recordStateType.submitted,L.pointOfCareRecordStateTypeId===m.recordStateType.published&&L.serviceRecordStateTypeId===m.recordStateType.published?L.recordStateTypeId=m.recordStateType.published:(L.pointOfCareRecordStateTypeId===m.recordStateType.returned||L.serviceRecordStateTypeId===m.recordStateType.returned)&&(L.recordStateTypeId=m.recordStateType.returned)})}),s.value=!1}async function u(c){R.value=c}async function _(){if(R.value){s.value=!0;const c=await ae.associationRemove(k.value,A.value,R.value.serviceId,R.value.serviceVersion);y.validateResponse(c,r.backoffice.pointOfCare.serviceRemoved,async()=>{await U()}),s.value=!1}}return(c,L)=>{const J=p("icon-plus"),W=p("table-actions"),q=p("ccolumn"),H=p("table-action-delete"),X=p("ctable"),V=p("container-wrapper"),te=p("confirm-delete-modal");return I(),D(le,null,[t(V,null,{default:C(()=>[t(W,{title:c._lang.common.tableActionTitle},{default:C(()=>[n.value?(I(),D("button",{key:0,class:"btn btn-primary",type:"button",id:e(l),onClick:K},[t(J,{color:"#FFF"}),Te(" "+Le(c._lang.common.addService),1)],8,De)):$("",!0)]),_:1},8,["title"]),t(X,{onSort:Q,onChangePage:G,data:e(T),checkbox:!1,loading:e(s),defaultSort:"ServiceName",checkboxField:"serviceCode"},{columns:C(()=>[t(q,{name:c._lang.label.code,field:"serviceCode",sortable:!0},null,8,["name"]),t(q,{name:c._lang.label.serviceTypeId,field:"serviceType",sortField:"serviceType",sortable:!0},null,8,["name"]),t(q,{name:c._lang.label.abreviation,field:"serviceOrganization",sortField:"serviceOrganizationId",sortable:!0},null,8,["name"]),t(q,{name:c._lang.label.name,field:"serviceName",sortable:!0},null,8,["name"]),t(q,{name:c._lang.label.organizationHost,field:"serviceOrganization",sortField:"serviceOrganizationId",sortable:!0},null,8,["name"]),t(q,{name:c._lang.label.state,field:"recordStateTypeId",align:e(m).columnAlign.center,custom:se,options:e(z),sortable:!0},null,8,["name","align","options"])]),actions:C(re=>[i.value?(I(),h(H,{key:0,id:v,onClick:Ke=>u(re.item)},null,8,["onClick"])):$("",!0)]),_:1},8,["data","loading"])]),_:1}),!e(s)&&e(M)?(I(),h(He,{key:e(S),pointOfCareId:e(k),pointOfCareVersion:e(A),onApply:U},null,8,["pointOfCareId","pointOfCareVersion"])):$("",!0),t(te,{id:v,title:c._lang.backoffice.pointOfCare.serviceDeleteTitle,message:c._lang.backoffice.pointOfCare.serviceDeleteQuestion,action:_},null,8,["title","message"])],64)}}},ia={__name:"form",props:{formModel:{Object,required:!0},loading:{type:Boolean,required:!0},validateForm:{type:Boolean,required:!0},disabled:{type:Boolean,required:!0},isExternalEdit:{type:Boolean,required:!0},selectedLang:{type:[Number,String],required:!0},rules:{type:Object,required:!0},vuelidate:{Object,default:null},showProgress:{type:Boolean,default:!0},progressValue:{type:[Number],required:!1}},emits:["update:formModel"],setup(b,{emit:d}){const n=b,i=O({get(){return n.formModel},set(a){d("update:formModel",a)}});return(a,f)=>{const v=p("progress-bar"),l=p("container-wrapper"),o=p("tab-content"),r=p("tabs");return I(),h(r,null,{default:C(()=>[t(o,{id:"general",title:a._lang.common.general,active:!0,"always-refresh":!0},{default:C(()=>[n.showProgress?(I(),h(l,{key:0,"margin-top":!1},{default:C(()=>[n.showProgress?(I(),h(v,{key:0,value:n.progressValue,label:a._lang.common.fill,class:"mb-4 col-12 float-end"},null,8,["value","label"])):$("",!0)]),_:1})):$("",!0),t(Pe,{modelValue:e(i),"onUpdate:modelValue":f[0]||(f[0]=B=>F(i)?i.value=B:null),disabled:n.disabled,validateForm:n.validateForm,loading:n.loading,selectedLang:n.selectedLang,rules:n.rules},null,8,["modelValue","disabled","validateForm","loading","selectedLang","rules"])]),_:1},8,["title"]),t(o,{id:"services",title:a._lang.backoffice.menu.services,active:!1,disabled:!1,"always-refresh":!0},{default:C(()=>[t(xe,{formModel:e(i)},null,8,["formModel"])]),_:1},8,["title"])]),_:1})}}};export{ia as _};
