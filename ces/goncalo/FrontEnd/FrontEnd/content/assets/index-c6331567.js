import{b as Y,d as J,u as c,r as _,o as D,a as Q,c as v,e as I,_ as W,f as X,g as Z,h as ee,i as ae,j as B,w as te,k as T,l as x,m as b,n as l,p as d,q as t,s as se,t as C,v as i,x as y,F as O,y as oe,z as A,A as z,B as ne,C as le}from"./index-61b82425.js";const re={search:s=>Y.post("/es/search",s)},ie=J("SearchStore",{state:()=>({objectTypes:[],organizationParents:[],items:[],filterModel:c.createFilterModel(),pageCount:0,page:0}),getters:{},actions:{setObjectTypes(s){this.objectTypes=[];for(let p in s)this.objectTypes.some(f=>f.value===s[p].index)||this.objectTypes.push({value:s[p].index,label:s[p].title})},setOrganizationParents(s){this.organizationParents=[];for(let p in s)this.organizationParents.some(f=>f.value===s[p].organizationParent)||this.organizationParents.push({value:s[p].organizationParent,label:s[p].organizationParent})},setFilterModel(s){this.filterModel=s},setItems(s){this.items=s},setPageCount(s){this.pageCount=s},setPage(s){this.page=s}}}),ue={__name:"observer",props:{options:Object},emits:["intersect"],setup(s,{emit:p}){const f=s,r=_(null),k=_(null);return D(()=>{const h=f.options||{};r.value=new IntersectionObserver(([m])=>{m&&m.isIntersecting&&p("intersect")},h),r.value.observe(k.value)}),Q(()=>{r.value.disconnect()}),(h,m)=>(v(),I("div",{class:"observer",ref_key:"observerRef",ref:k},null,512))}};const P=s=>(ne("data-v-f6fb4e05"),s=s(),le(),s),ce={class:"image-back-home px-5"},de=P(()=>l("div",{class:"col-12 mt-5"},[l("h1",null,"Bem-vindo")],-1)),pe={class:"col-12"},_e={class:"col-12 search-btn"},ve={class:"col-12"},me=["innerHTML"],ge={class:"mt-3"},be=["onClick"],fe={class:"title"},he={class:"description"},ye={key:0,class:"f-14"},Ie=P(()=>l("br",null,null,-1)),Ce=P(()=>l("br",null,null,-1)),Pe={key:0,class:"f-14"},Ee=P(()=>l("br",null,null,-1)),Ae=P(()=>l("br",null,null,-1)),ke=P(()=>l("br",null,null,-1)),Ve={class:"date"},ze=P(()=>l("hr",{class:"rounded"},null,-1)),Te=["innerHTML"],Fe={__name:"search",setup(s){const p=X(),f=Z(),r=ie();ee();const k=ae();let h=_(!1),m=_(!1),F=_(!1),M=_(!1),n=_(c.createFilterModel()),E=_(0),S=_(999),g=_([]),R=_(0);const N=B(()=>k.common.emptyResult.replace("{0}",`<strong>${n.value.query}</strong>`)),j=B(()=>k.common.totalRecords.replace("{0}",`<strong>${R.value}</strong>`)),w=async()=>{F.value=!1,n.value.query&&(E.value=0,r.setFilterModel(n.value),g.value=[],await L(),m.value=!1,F.value=!1)},L=async()=>{M.value=!0,n.value.pageNumber=E.value;let a=await re.search(n.value);a.code!==0&&await q(),c.validateResponse(a,null,()=>{g.value.push(...K(a.data.items)),E.value++,R.value=a.data.total,S.value=Math.ceil(a.data.total/n.value.pageSize),r.setObjectTypes(g.value),r.setOrganizationParents(g.value),r.setItems(g.value),r.setPageCount(S.value),r.setPage(E.value),M.value=!1,h.value=!0})};D(()=>{F.value=!1,p.hash==="#history"&&(m.value=!0,r.filterModel.query&&(g.value.push(...r.items),E.value=r.page,S.value=r.pageCount,n.value=r.filterModel,h.value=!0,F.value=!0,m.value=!1))});const q=async()=>{n.value.query=null,n.value.pageNumber=0,n.value.name=null,n.value.abreviation=null,n.value.organizationParents=null,n.value.index=null,h.value=!1};function H(a){let e="",u={};switch(a.index){case"organization":e=z.router.BACKOFFICE_SEARCH_DETAIL_ENTITY_PAGE.name,u={organizationId:c.encodeId(a.id),organizationVersion:c.encodeId(a.version)};break;case"pointofcare":e=z.router.BACKOFFICE_SEARCH_DETAIL_POINT_OF_CARE_PAGE.name,u={pointOfCareId:c.encodeId(a.id),pointOfCareVersion:c.encodeId(a.version)};break;case"service":e=z.router.BACKOFFICE_SEARCH_DETAIL_SERVICE_PAGE.name,u={serviceId:c.encodeId(a.id),serviceVersion:c.encodeId(a.version)};break;case"location":e=z.router.BACKOFFICE_SEARCH_DETAIL_LOCATION_PAGE.name,u={locationId:c.encodeId(a.id),locationVersion:c.encodeId(a.version)};break;case"document":e=z.router.BACKOFFICE_SEARCH_DETAIL_DOCUMENT_PAGE.name,u={documentId:c.encodeId(a.id),documentVersion:c.encodeId(a.version)};break}f.push({name:e,params:u})}function K(a){return a.map(e=>({id:e.id,version:e.version,title:e.pt.type,name:e.pt.name,organizationParent:e.organizationParent,address:e.address,date:c.formatDate(e.startDate),index:e.index,economicActivity:e.economicActivity,category:e.category,type:e.type}))}async function U(){E.value<S.value&&await L()}return te(()=>n.value.query,()=>{n.value.query||(h.value=!1)}),(a,e)=>{const u=T("row"),V=T("form-field"),G=T("icon-search"),$=T("card");return v(),x($,{shadow:!0,class:"card-home",padding:!1},{body:b(()=>[l("div",ce,[d(u,null,{default:b(()=>[de]),_:1}),d(u,{class:"mt-5 mb-3"},{default:b(()=>[l("div",pe,[d(V,{id:"query",label:"Pesquisar",modelValue:t(n).query,"onUpdate:modelValue":e[0]||(e[0]=o=>t(n).query=o),placeholder:a._lang.backoffice.home.placeholderSearch,onKeyup:se(w,["enter"]),type:t(C).inputs.search},null,8,["modelValue","placeholder","onKeyup","type"])])]),_:1}),d(u,null,{default:b(()=>[d(V,{id:"abreviation",class:"mb-3 col-12 col-md-6",label:a._lang.label.abreviation,type:t(C).inputs.text,maxlength:45,modelValue:t(n).abreviation,"onUpdate:modelValue":e[1]||(e[1]=o=>t(n).abreviation=o)},null,8,["label","type","modelValue"]),d(V,{id:"types",class:"mb-3 col-12 col-md-6",modelValue:t(n).index,"onUpdate:modelValue":e[2]||(e[2]=o=>t(n).index=o),label:a._lang.label.type,loading:t(m),type:t(C).inputs.multiselect,mode:t(C).multiselectMode.tags,options:t(r).objectTypes},null,8,["modelValue","label","loading","type","mode","options"])]),_:1}),d(u,null,{default:b(()=>[d(V,{id:"name",class:"mb-3 col-12 col-md-6",label:a._lang.label.name,type:t(C).inputs.text,maxlength:45,modelValue:t(n).name,"onUpdate:modelValue":e[3]||(e[3]=o=>t(n).name=o)},null,8,["label","type","modelValue"]),d(V,{id:"organizationParents",class:"mb-3 col-12 col-md-6",modelValue:t(n).organizationParents,"onUpdate:modelValue":e[4]||(e[4]=o=>t(n).organizationParents=o),label:a._lang.label.parentOrganization,loading:t(m),type:t(C).inputs.multiselect,mode:t(C).multiselectMode.tags,options:t(r).organizationParents},null,8,["modelValue","label","loading","type","mode","options"])]),_:1}),d(u,{class:"mt-2 pb-3"},{default:b(()=>[l("div",_e,[l("button",{class:"btn btn-secondary medium mb-3 me-3",type:"button",onClick:q},i(a._lang.common.clear),1),l("button",{class:"btn btn-primary medium mb-3",type:"button",onClick:w},[d(G,{color:"#FFF"}),y(" "+i(a._lang.common.search),1)])])]),_:1})]),t(h)?(v(),x(u,{key:0,class:"px-5"},{default:b(()=>[l("div",ve,[t(g).length?(v(),I(O,{key:0},[d(u,null,{default:b(()=>[l("div",{class:"mt-3",innerHTML:t(j)},null,8,me)]),_:1}),l("div",ge,[l("ul",null,[(v(!0),I(O,null,oe(t(g),o=>(v(),I("li",{class:"infinite-scroll-item p-hand",onClick:Me=>H(o)},[l("h4",fe,i(o.title),1),l("p",he,[l("i",null,i(o.organizationParent),1),y(", "),l("strong",null,i(o.name),1)]),o.address?(v(),I("p",ye,[y(i(o.address.zipCode)+" - "+i(o.address.island)+" ",1),Ie,y(" "+i(o.address.county)+", "+i(o.address.parish)+", "+i(o.address.location)+" ",1),Ce,y(" "+i(o.address.address),1)])):A("",!0),o.index==="service"?(v(),I(O,{key:1},[o.category?(v(),I("p",Pe,[y(i(o.type)+" ",1),Ee,y(" "+i(o.category)+" ",1),Ae,y(" "+i(o.economicActivity)+" ",1),ke])):A("",!0)],64)):A("",!0),l("p",Ve,i(a._lang.label.startDate)+": "+i(o.date),1),ze],8,be))),256))]),d(ue,{onIntersect:U})])],64)):A("",!0),!t(g).length&&!t(M)?(v(),I("div",{key:1,class:"mt-4 pb-4",innerHTML:t(N)},null,8,Te)):A("",!0)])]),_:1})):A("",!0)]),_:1})}}},Se=W(Fe,[["__scopeId","data-v-f6fb4e05"]]),xe={__name:"index",setup(s){return(p,f)=>{const r=T("page");return v(),x(r,{title:p._lang.backoffice.home.pageTitle},{default:b(()=>[d(Se)]),_:1},8,["title"])}}};export{xe as default};
