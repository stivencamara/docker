import{b as W,r as l,o as $,u as n,k as m,c as A,l as R,w as _,e as H,F as q,x as ie,p as e,d as de,J as ee,i as te,g as ae,E as Z,s as i,K as le,n as o,H as P,L as x,z,t as ue,v as pe,y as re}from"./index-4fe030fb.js";import{_ as ce}from"./custom-label-0a0f7a9b.js";import{b as oe}from"./helpers-79f72589.js";import{p as me}from"./point-of-care-9174b5ec.js";import{s as be}from"./service-6ce3c872.js";import"./index.esm-bce4ceba.js";const K={cards:()=>W.get("/task/cards"),search:f=>W.post("/task/search",f),cardsAssociations:()=>W.get("/task/cards/associations"),searchAssociations:f=>W.post("/task/search/associations",f),getLists:f=>W.get(`/task/lists/${f}`)},fe={__name:"cards",props:{filter:{type:Function,required:!0},selected:{type:Object}},setup(f,{expose:T}){const O=f;let v=l(!0),c=l([]),s=l(null);$(async()=>{v.value=!0;const d=await K.cards();s.value=O.selected,n.validateResponse(d,null,()=>{c.value=d.data}),v.value=!1});const u=d=>{s.value=d,O.filter(d)};return T({clearSelection:()=>{s.value=null}}),(d,S)=>{const C=m("filter-card"),L=m("filter-cards");return A(),R(L,null,{default:_(()=>[(A(!0),H(q,null,ie(e(c),I=>(A(),R(C,{label:d._lang.enums.recordStateType[I.recordStateId],counter:I.total,active:I.recordStateId===e(s).recordStateId,loading:e(v),onClick:w=>u(I)},null,8,["label","counter","active","loading","onClick"]))),256))]),_:1})}}},ne=de("TasksStore",{state:()=>({stateTypeList:[],objectTypeList:[],organizationList:[],formToCompare:null}),getters:{getAll:f=>({stateTypeList:f.stateTypeList,objectTypeList:f.objectTypeList,organizationList:f.organizationList})},actions:{setLists(f){this.stateTypeList=f.stateTypeList,this.objectTypeList=f.objectTypeList,this.organizationList=f.organizationList},setFormToCompare(f){this.formToCompare=f}}}),ge={__name:"index",setup(f){const T=ee(),O=ne();te();const v=ae(),c=Z(M());let s=l(!1),u=l([]),k=l([]),d=l(i.tableSelectedState.none),S=l(n.createEmptyDataSource()),C=l([]),L=l([]),I=l([]),w=l([]),j=l(0),U=l({recordStateId:i.recordStateType.draft}),E=l(null);function M(){return{pageNumber:0,sortBy:"Name",objectTypeIds:[],organization:null,recordStateTypeIds:[],name:null}}const Y=async a=>{c.sortBy=a,await N()},F=()=>{Object.assign(c,M())},D=async(a=!0)=>{E.value.clearSelection(),F(),a&&await B()},B=async()=>{await N()},N=async()=>{s.value=!0;const a=await K.search(c);n.validateResponse(a,null,()=>{S.value=a.data}),s.value=!1},J=async a=>{U.value=a,F();const t=L.value.find(y=>a.recordStateId===y.value);c.recordStateTypeIds.push(t.value),j.value++,await N()},r=async a=>{c.pageNumber=a,await N()};le(async()=>{s.value=!0;const a=await K.getLists(T.getLanguage);n.validateResponse(a,null,()=>{O.setLists(a.data),C.value=a.data.organizationList,L.value=a.data.stateTypeList,I.value=a.data.objectTypeList,w.value=n.concatItemsBadge(L.value,oe.recordStateTypeBadgeOptions)}),s.value=!1}),$(async()=>{c.recordStateTypeIds.push(i.recordStateType.draft),await N()});function b(a){let t=null,y=null;switch(a.objectTypeId){case 2:t=z.router.BACKOFFICE_TASKS_DETAIL_ENTITY_PAGE.name,y={organizationId:n.encodeId(a.id.id),organizationVersion:n.encodeId(a.id.version)};break;case 3:t=z.router.BACKOFFICE_TASKS_DETAIL_SERVICE_PAGE.name,y={serviceId:n.encodeId(a.id.id),serviceVersion:n.encodeId(a.id.version)};break;case 4:t=z.router.BACKOFFICE_TASKS_DETAIL_POINT_OF_CARE_PAGE.name,y={pointOfCareId:n.encodeId(a.id.id),pointOfCareVersion:n.encodeId(a.id.version)};break;case 5:t=z.router.BACKOFFICE_TASKS_DETAIL_DOCUMENT_PAGE.name,y={documentId:n.encodeId(a.id.id),documentVersion:n.encodeId(a.id.version)};break;case 6:t=z.router.BACKOFFICE_DETAIL_LOCATION_PAGE.name,y={locationId:n.encodeId(a.id.id),locationVersion:n.encodeId(a.id.version)};break}v.push({name:t,params:y})}return(a,t)=>{const y=m("form-field"),V=m("row"),G=m("cfilter"),h=m("ccolumn"),Q=m("table-action-detail"),g=m("ctable"),X=m("container-wrapper");return A(),H(q,null,[o(fe,{filter:J,ref_key:"cardsRef",ref:E,selected:e(U)},null,8,["selected"]),(A(),R(G,{title:a._lang.common.filter,disabled:e(s),"clear-click":D,"apply-click":B,loading:e(s),class:"mt-30",key:e(j)},{default:_(()=>[o(V,null,{default:_(()=>[o(y,{id:"name",class:"mb-3 col-12 col-md-6",modelValue:c.name,"onUpdate:modelValue":t[0]||(t[0]=p=>c.name=p),label:a._lang.label.name,type:e(i).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),o(y,{id:"objectTypeIds",class:"mb-3 col-12 col-md-6",modelValue:c.objectTypeIds,"onUpdate:modelValue":t[1]||(t[1]=p=>c.objectTypeIds=p),label:a._lang.label.objectTypeId,type:e(i).inputs.multiselect,options:e(I),disabled:e(s),mode:e(i).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"])]),_:1}),o(V,null,{default:_(()=>[o(y,{id:"organization",class:"mb-3 col-12",modelValue:c.organization,"onUpdate:modelValue":t[2]||(t[2]=p=>c.organization=p),label:a._lang.label.parentOrganization,type:e(i).inputs.multiselect,options:e(C),disabled:e(s),valueProp:e(i).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"])]),_:1})]),_:1},8,["title","disabled","loading"])),o(X,null,{default:_(()=>[o(g,{onSort:Y,onChangePage:r,selectedItems:e(u),"onUpdate:selectedItems":t[3]||(t[3]=p=>P(u)?u.value=p:u=p),unselectedItems:e(k),"onUpdate:unselectedItems":t[4]||(t[4]=p=>P(k)?k.value=p:k=p),selectedState:e(d),"onUpdate:selectedState":t[5]||(t[5]=p=>P(d)?d.value=p:d=p),data:e(S),checkbox:!1,loading:e(s),defaultSort:"Name",checkboxField:"Name"},{columns:_(()=>[o(h,{name:a._lang.label.objectTypeId,field:"objectTypeId",align:e(i).columnAlign.center,custom:ce,options:e(I),sortable:!0},null,8,["name","align","options"]),o(h,{name:a._lang.label.name,field:"name",sortable:!0},null,8,["name"]),o(h,{name:a._lang.label.state,field:"recordStateTypeId",align:e(i).columnAlign.center,custom:x,options:e(w),sortable:!0},null,8,["name","align","options"])]),actions:_(p=>[o(Q,{onClick:se=>b(p.item)},null,8,["onClick"])]),_:1},8,["selectedItems","unselectedItems","selectedState","data","loading"])]),_:1})],64)}}},_e={__name:"cards",props:{filter:{type:Function,required:!0},selected:{type:Object}},setup(f,{expose:T}){const O=f;let v=l(!0),c=l([]),s=l(null);$(async()=>{v.value=!0,s.value=O.selected;const d=await K.cards();n.validateResponse(d,null,()=>{c.value=d.data.filter(C=>C.recordStateId==i.recordStateType.approval).map(C=>({id:0,recordStateId:C.recordStateId,label:"Objectos",total:C.total}))});const S=await K.cardsAssociations();n.validateResponse(S,null,()=>{S.data.length>0?c.value.push({id:1,recordStateId:S.data[0].recordStateId,label:"Associações",total:S.data[0].total}):c.value.push({id:1,recordStateId:i.recordStateType.draft,label:"Associações",total:0})}),v.value=!1});const u=d=>{s.value=d,O.filter(d)};return T({clearSelection:()=>{s.value=null}}),(d,S)=>{const C=m("filter-card"),L=m("filter-cards");return A(),R(L,{style:{"justify-content":"start !important"}},{default:_(()=>[(A(!0),H(q,null,ie(e(c),(I,w)=>(A(),R(C,{key:w,label:I.label,counter:I.total,active:I.recordStateId===e(s).recordStateId,loading:e(v),onClick:j=>u(I)},null,8,["label","counter","active","loading","onClick"]))),128))]),_:1})}}},ye={__name:"objects",setup(f){const T=ee(),O=ne(),v=te(),c=ae(),s=Z(E());let u=l(!1),k=l([]),d=l([]),S=l(i.tableSelectedState.none),C=l(n.createEmptyDataSource()),L=l([]),I=l([]),w=l([]),j=l([]),U=l(0);l({recordStateId:i.recordStateType.draft});function E(){return{pageNumber:0,sortBy:"Name",objectTypeIds:[],organization:null,recordStateTypeIds:[i.recordStateType.approval],name:null}}const M=async r=>{s.sortBy=r,await B()},Y=()=>{Object.assign(s,E())},F=async(r=!0)=>{Y(),r&&await D()},D=async()=>{await B()},B=async()=>{u.value=!0;const r=await K.search(s);n.validateResponse(r,null,()=>{C.value=r.data}),u.value=!1},N=async r=>{s.pageNumber=r,await B()};le(async()=>{u.value=!0;const r=await K.getLists(T.getLanguage);n.validateResponse(r,null,()=>{O.setLists(r.data),L.value=r.data.organizationList,I.value=n.convertEnumToArray(v.enums.recordStateType),w.value=r.data.objectTypeList,j.value=n.concatItemsBadge(I.value,oe.recordStateTypeBadgeOptions)}),u.value=!1}),$(async()=>{await B()});function J(r){let b=null,a=null;switch(r.objectTypeId){case 2:b=z.router.BACKOFFICE_TASKS_DETAIL_ENTITY_PAGE.name,a={organizationId:n.encodeId(r.id.id),organizationVersion:n.encodeId(r.id.version)};break;case 3:b=z.router.BACKOFFICE_TASKS_DETAIL_SERVICE_PAGE.name,a={serviceId:n.encodeId(r.id.id),serviceVersion:n.encodeId(r.id.version)};break;case 4:b=z.router.BACKOFFICE_TASKS_DETAIL_POINT_OF_CARE_PAGE.name,a={pointOfCareId:n.encodeId(r.id.id),pointOfCareVersion:n.encodeId(r.id.version)};break;case 5:b=z.router.BACKOFFICE_TASKS_DETAIL_DOCUMENT_PAGE.name,a={documentId:n.encodeId(r.id.id),documentVersion:n.encodeId(r.id.version)};break;case 6:b=z.router.BACKOFFICE_DETAIL_LOCATION_PAGE.name,a={locationId:n.encodeId(r.id.id),locationVersion:n.encodeId(r.id.version)};break}c.push({name:b,params:a})}return(r,b)=>{const a=m("form-field"),t=m("row"),y=m("cfilter"),V=m("ccolumn"),G=m("table-action-detail"),h=m("ctable"),Q=m("container-wrapper");return A(),H(q,null,[(A(),R(y,{title:r._lang.common.filter,disabled:e(u),"clear-click":F,"apply-click":D,loading:e(u),class:"mt-30",key:e(U)},{default:_(()=>[o(t,null,{default:_(()=>[o(a,{class:"mb-3 col-12 col-md-6",modelValue:s.name,"onUpdate:modelValue":b[0]||(b[0]=g=>s.name=g),label:r._lang.label.name,type:e(i).inputs.text,maxlength:45,disabled:e(u)},null,8,["modelValue","label","type","disabled"]),o(a,{class:"mb-3 col-12 col-md-6",modelValue:s.objectTypeIds,"onUpdate:modelValue":b[1]||(b[1]=g=>s.objectTypeIds=g),label:r._lang.label.objectTypeId,type:e(i).inputs.multiselect,options:e(w),disabled:e(u),mode:e(i).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"])]),_:1}),o(t,null,{default:_(()=>[o(a,{class:"mb-3 col-12 col-md-6",modelValue:s.organization,"onUpdate:modelValue":b[2]||(b[2]=g=>s.organization=g),label:r._lang.label.parentOrganization,type:e(i).inputs.multiselect,options:e(L),disabled:e(u),valueProp:e(i).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),o(a,{class:"mb-3 col-12 col-md-6",modelValue:s.recordStateTypeIds,"onUpdate:modelValue":b[3]||(b[3]=g=>s.recordStateTypeIds=g),label:r._lang.label.state,type:e(i).inputs.multiselect,options:e(I),disabled:e(u),mode:e(i).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"])]),_:1})]),_:1},8,["title","disabled","loading"])),o(Q,null,{default:_(()=>[o(h,{onSort:M,onChangePage:N,selectedItems:e(k),"onUpdate:selectedItems":b[4]||(b[4]=g=>P(k)?k.value=g:k=g),unselectedItems:e(d),"onUpdate:unselectedItems":b[5]||(b[5]=g=>P(d)?d.value=g:d=g),selectedState:e(S),"onUpdate:selectedState":b[6]||(b[6]=g=>P(S)?S.value=g:S=g),data:e(C),checkbox:!1,loading:e(u),defaultSort:"Name",checkboxField:"Name"},{columns:_(()=>[o(V,{name:r._lang.label.objectTypeId,field:"objectTypeId",align:e(i).columnAlign.center,custom:ce,options:e(w),sortable:!0},null,8,["name","align","options"]),o(V,{name:r._lang.label.name,field:"name",sortable:!0},null,8,["name"]),o(V,{name:r._lang.label.state,field:"recordStateTypeId",align:e(i).columnAlign.center,custom:x,options:e(j),sortable:!0},null,8,["name","align","options"])]),actions:_(g=>[o(G,{onClick:X=>J(g.item)},null,8,["onClick"])]),_:1},8,["selectedItems","unselectedItems","selectedState","data","loading"])]),_:1})],64)}}},ve={__name:"associations",setup(f){const T=ee(),O=ne(),v=te();ae();const c=Z(M()),s="confirm-verify";let u=l(!1),k=l([]),d=l([]),S=l(i.tableSelectedState.none),C=l(n.createEmptyDataSource()),L=l([]),I=l([]),w=l([]),j=l([]);l(0);let U=l(!1);l({recordStateId:i.recordStateType.draft});let E=Z({pointOfCareId:null,pointOfCareVersion:null,serviceId:null,serviceVersion:null,approve:null});function M(){return{pageNumber:0,sortBy:"ServiceName",objectTypeIds:[],organization:null,recordStateTypeIds:[i.recordStateType.approval],name:null}}const Y=async t=>{c.sortBy=t,await F()},F=async()=>{u.value=!0;const t=await K.searchAssociations(c);n.validateResponse(t,null,()=>{C.value=t.data}),u.value=!1},D=async t=>{c.pageNumber=t,await F()};le(async()=>{u.value=!0;const t=await K.getLists(T.getLanguage);n.validateResponse(t,null,()=>{O.setLists(t.data),L.value=t.data.organizationList,I.value=n.convertEnumToArray(v.enums.recordStateType),w.value=t.data.objectTypeList,j.value=n.concatItemsBadge(I.value,oe.recordStateTypeBadgeOptions)}),u.value=!1}),$(async()=>{await F()});function B(t){E.pointOfCareId=t.pointOfCare.id,E.pointOfCareVersion=t.pointOfCare.version,E.serviceId=t.service.id,E.serviceVersion=t.service.version}function N(t){B(t),U.value=!0,n.showModalById(s)}function J(t){B(t),U.value=!1,n.showModalById(s)}async function r(){E.approve=!0,await a(),await F()}async function b(){E.approve=!1,await a(),await F()}async function a(){u.value=!0;let t;U.value?t=await be.associationApprove(E):t=await me.associationApprove(E),n.validateResponse(t,null,()=>{console.log(t)}),u.value=!1}return(t,y)=>{const V=m("ccolumn"),G=m("table-action-approve"),h=m("ctable"),Q=m("container-wrapper"),g=m("cbutton"),X=m("modal");return A(),H(q,null,[o(Q,{class:"mt-30"},{default:_(()=>[o(h,{onSort:Y,onChangePage:D,selectedItems:e(k),"onUpdate:selectedItems":y[0]||(y[0]=p=>P(k)?k.value=p:k=p),unselectedItems:e(d),"onUpdate:unselectedItems":y[1]||(y[1]=p=>P(d)?d.value=p:d=p),selectedState:e(S),"onUpdate:selectedState":y[2]||(y[2]=p=>P(S)?S.value=p:S=p),data:e(C),checkbox:!1,loading:e(u),defaultSort:"pointOfCareName",checkboxField:"Name"},{columns:_(()=>[o(V,{name:t._lang.label.pointOfCare,field:"pointOfCareName",sortable:!0},null,8,["name"]),o(V,{name:t._lang.label.state,field:"pointOfCareRecordStateTypeId",align:e(i).columnAlign.center,custom:x,options:e(j),sortable:!0},null,8,["name","align","options"]),o(V,{name:t._lang.label.service,field:"serviceName",sortable:!0},null,8,["name"]),o(V,{name:t._lang.label.state,field:"serviceRecordStateTypeId",align:e(i).columnAlign.center,custom:x,options:e(j),sortable:!0},null,8,["name","align","options"])]),actions:_(p=>[o(G,{onClick:se=>N(p.item),"data-bs-toggle":"tooltip","data-bs-title":t._lang.common.verifyServiço,"data-bs-placement":"top"},null,8,["onClick","data-bs-title"]),o(G,{onClick:se=>J(p.item),"data-bs-toggle":"tooltip","data-bs-title":t._lang.common.verifyPointOfCare,"data-bs-placement":"top"},null,8,["onClick","data-bs-title"])]),_:1},8,["selectedItems","unselectedItems","selectedState","data","loading"])]),_:1}),o(X,{id:s,size:e(i).modalSize.medium,title:t._lang.common.confirmation},{body:_(()=>[ue(pe(t._lang.common.notEmptyAlertTemplate),1)]),footer:_(()=>[o(g,{title:t._lang.common.close,type:e(i).buttonType.secondary,"data-bs-dismiss":"modal","aria-label":"Close",disabled:!1},null,8,["title","type"]),o(g,{onClick:b,title:t._lang.common.refuse,disabled:!1,"data-bs-dismiss":"modal","aria-label":"Close"},null,8,["title"]),o(g,{onClick:r,title:t._lang.common.approve,disabled:!1,"data-bs-dismiss":"modal","aria-label":"Close"},null,8,["title"])]),_:1},8,["size","title"])],64)}}},Ie={__name:"index",setup(f){ee(),te(),ae();let T=l({recordStateId:i.recordStateType.approval,id:0});le(async()=>{}),$(async()=>{});const O=async v=>{T.value=v,console.log(v)};return(v,c)=>(A(),H(q,null,[o(_e,{filter:O,ref:"cardsRef",selected:e(T)},null,8,["selected"]),e(T).id==0?(A(),R(ye,{key:0})):re("",!0),e(T).id==1?(A(),R(ve,{key:1})):re("",!0)],64))}},Ee={__name:"index",setup(f){return(T,O)=>{const v=m("tab-content"),c=m("tabs"),s=m("page");return A(),R(s,{title:T._lang.backoffice.tasks.pageTitle},{default:_(()=>[o(c,null,{default:_(()=>[o(v,{id:"edicao",title:T._lang.backoffice.tasks.inEdition,active:!0,"always-refresh":!0},{default:_(()=>[o(ge)]),_:1},8,["title"]),o(v,{id:"aprovacao",title:T._lang.backoffice.tasks.toApprove,icon:e(i).tabIcons.plus,"always-refresh":!0},{default:_(()=>[o(Ie)]),_:1},8,["title","icon"])]),_:1})]),_:1},8,["title"])}}};export{Ee as default};
