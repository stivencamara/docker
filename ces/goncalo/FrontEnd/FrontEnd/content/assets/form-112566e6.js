import{u as de}from"./index.esm-97dcd533.js";import{_ as ie,a as re,b as ue}from"./contacts-5142be00.js";import{_ as ce,a as me}from"./address.vue_vue_type_style_index_0_scoped_5480b292_lang-b87b4179.js";import{j as I,k as c,c as k,l as N,w as y,n as o,p as e,I as S,s as v,_ as pe,u as V,r as _,N as ge,e as M,m as x,O as be,Q as fe,F as W,i as ee,J as ve,G,K as le,o as ae,L as ye,M as _e,f as Ve,g as Ce,t as Oe,v as Le,y as $}from"./index-a14ad215.js";import{b as w}from"./helpers-71142cd6.js";import{u as Ie}from"./organization-4f7bdfd2.js";import{u as te}from"./point-of-care-86564745.js";import{_ as ke}from"./address-809a8351.js";import{_ as Fe,a as Be}from"./refusal-4e803a93.js";import{r as Se}from"./index.esm-88a1129f.js";import{_ as we}from"./generic-90322b29.js";import{p as J}from"./point-of-care-4055b36e.js";import{s as Q}from"./service-a0c37778.js";import{u as Ne}from"./service-9ca2bd37.js";import{s as Te}from"./helpers-11fd24aa.js";const Ee={__name:"description",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},selectedLang:{type:[String,Number],required:!0},validateForm:{type:Boolean,default:!1},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(g,{emit:s}){const n=g;Ie();const i=I({get(){return n.modelValue},set(a){s("update:modelValue",a)}}),l=I(()=>n.selectedLang),m=I({get(){return w.getFieldByLangAndName(i.value,l.value,"description")},set(a){w.setFieldByLangAndName(i.value,l.value,"description",a)}}),b=I({get(){return w.getFieldByLangAndName(i.value,l.value,"preConditions")},set(a){w.setFieldByLangAndName(i.value,l.value,"preConditions",a)}});return I({get(){return w.getFieldByLangAndName(i.value,l.value,"keywords")},set(a){w.setFieldByLangAndName(i.value,l.value,"keywords",a)}}),(a,t)=>{const u=c("form-field"),C=c("accordion");return k(),N(C,{id:"description",title:a._lang.common.description,collapsed:!1,class:"mb-4"},{default:y(()=>[o(u,{id:"description",class:"mb-3 col-12",modelValue:e(m),"onUpdate:modelValue":t[0]||(t[0]=r=>S(m)?m.value=r:null),label:a._lang.label.description,disabled:n.disabled,loading:n.loading,type:e(v).inputs.text,maxlength:255,language:e(l)},null,8,["modelValue","label","disabled","loading","type","language"]),o(u,{id:"preConditions",class:"mb-3 col-12",modelValue:e(b),"onUpdate:modelValue":t[1]||(t[1]=r=>S(b)?b.value=r:null),label:a._lang.label.preConditions,disabled:n.disabled,loading:n.loading,type:e(v).inputs.text,maxlength:255,language:e(l)},null,8,["modelValue","label","disabled","loading","type","language"])]),_:1},8,["title"])}}},Ue={class:"input-group mb-3"},qe=["aria-describedby"],Ae=["id","disabled"],je={__name:"address",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},validateForm:{type:Boolean,default:!1},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(g,{emit:s}){const n=g,i=te(),l=V.uuid();let m=_(0),b=_(0);const a=_(!1);_(!1);const t=I({get(){return n.modelValue},set(L){s("update:modelValue",L)}}),u="search-location";function C(L){Object.assign(t.value.address,L),m.value++}function r(){b.value++,window.setTimeout(function(){V.showModalById(u)},5)}return ge(t.value,L=>{L.address.locationId!=null&&(a.value?(L.address.locationId=null,L.address.code=null,a.value=!1):a.value=!0)}),(L,F)=>{const T=c("icon-search"),B=c("accordion");return k(),M(W,null,[o(B,{id:"address-accordion",title:L._lang.backoffice.entities.address,collapsed:!1,class:"mb-4"},{default:y(()=>[x("div",Ue,[be(x("input",{ref:"locationQuery",id:"location-query",type:"text",class:"form-control",placeholder:"Código do património","aria-label":"placeholder","aria-describedby":e(l),disabled:"","onUpdate:modelValue":F[0]||(F[0]=U=>e(t).address.code=U)},null,8,qe),[[fe,e(t).address.code]]),x("button",{class:"btn btn-primary",type:"button",id:e(l),disabled:n.disabled,onClick:r},[o(T,{color:"#FFF"})],8,Ae)]),(k(),N(ke,{key:e(m),modelValue:e(t).address,"onUpdate:modelValue":F[1]||(F[1]=U=>e(t).address=U),disabled:n.disabled,rules:n.rules,loading:n.loading,"validate-form":n.validateForm&&e(t).address.isRequired,store:e(i),vuelidate:n.vuelidate},null,8,["modelValue","disabled","rules","loading","validate-form","store","vuelidate"]))]),_:1},8,["title"]),(k(),N(ie,{key:e(b),onApply:C}))],64)}}},Re=pe(je,[["__scopeId","data-v-5480b292"]]),Me={__name:"service-channel-requirements",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},validateForm:{type:Boolean,default:!1},selectedLang:{type:[String,Number],required:!0},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(g,{emit:s}){const n=g,i=I({get(){return n.modelValue},set(a){s("update:modelValue",a)}}),l=I(()=>n.selectedLang),m=I({get(){return w.getFieldByLangAndName(i.value,l.value,"openingHours")},set(a){w.setFieldByLangAndName(i.value,l.value,"openingHours",a)}}),b=I({get(){return w.getFieldByLangAndName(i.value,l.value,"attendanceRestrictions")},set(a){w.setFieldByLangAndName(i.value,l.value,"attendanceRestrictions",a)}});return(a,t)=>{const u=c("form-field"),C=c("accordion");return k(),N(C,{id:"attendance-restrictions",title:a._lang.backoffice.pointOfCare.serviceChannelRequirements,collapsed:!1,class:"mb-4"},{default:y(()=>[o(u,{id:"openingHours",class:"mb-3 col-12",modelValue:e(m),"onUpdate:modelValue":t[0]||(t[0]=r=>S(m)?m.value=r:null),label:a._lang.label.openingHours,disabled:n.disabled,loading:n.loading,type:e(v).inputs.textarea,rows:3,language:e(l),maxlength:2e3},null,8,["modelValue","label","disabled","loading","type","language"]),o(u,{id:"attendanceRestrictions",class:"mb-3 col-12",modelValue:e(b),"onUpdate:modelValue":t[1]||(t[1]=r=>S(b)?b.value=r:null),label:a._lang.label.attendanceRestrictions,disabled:n.disabled,loading:n.loading,type:e(v).inputs.textarea,rows:3,language:e(l),maxlength:2e3},null,8,["modelValue","label","disabled","loading","type","language"])]),_:1},8,["title"])}}},$e={__name:"general",props:{modelValue:{type:Object,required:!0},selectedLang:Se,disabled:{Boolean,default:!0},rules:{Boolean,default:!0},validateForm:{Boolean,default:!1},loading:{Object,default:{}},isExternalEdit:{type:Boolean,default:!1},vuelidate:{type:Object,default:null}},setup(g){const s=g,n=te(),i=de(s.rules,s.modelValue),l=I({get(){return s.modelValue},set(a){emit("update:modelValue",a)}}),m=I(()=>s.selectedLang),b=I(()=>s.selectedLang===v.language.en);return(a,t)=>(k(),M(W,null,[o(Fe,{modelValue:e(l),"onUpdate:modelValue":t[0]||(t[0]=u=>S(l)?l.value=u:null),store:e(n)},null,8,["modelValue","store"]),o(e(ce),{modelValue:e(l),"onUpdate:modelValue":t[1]||(t[1]=u=>S(l)?l.value=u:null),disabled:s.disabled,loading:g.loading,selectedLang:s.selectedLang,validateForm:s.validateForm,rules:s.rules,isExternalEdit:s.isExternalEdit,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","validateForm","rules","isExternalEdit","vuelidate"]),o(e(Ee),{modelValue:e(l),"onUpdate:modelValue":t[2]||(t[2]=u=>S(l)?l.value=u:null),disabled:s.disabled,loading:g.loading,selectedLang:s.selectedLang,validateForm:s.validateForm,rules:s.rules,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","validateForm","rules","vuelidate"]),o(e(Re),{modelValue:s.modelValue,"onUpdate:modelValue":t[3]||(t[3]=u=>s.modelValue=u),disabled:s.disabled,loading:g.loading||e(b),rules:s.rules,validateForm:s.validateForm,vuelidate:e(i)},null,8,["modelValue","disabled","loading","rules","validateForm","vuelidate"]),o(e(Me),{modelValue:e(l),"onUpdate:modelValue":t[4]||(t[4]=u=>S(l)?l.value=u:null),disabled:s.disabled,loading:g.loading,selectedLang:s.selectedLang,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","vuelidate"]),o(e(ue),{modelValue:e(l).contacts,"onUpdate:modelValue":t[5]||(t[5]=u=>e(l).contacts=u),disabled:s.disabled||e(b),modal:re,store:e(n),loading:g.loading},null,8,["modelValue","disabled","store","loading"]),o(e(Be),{modelValue:e(l),"onUpdate:modelValue":t[6]||(t[6]=u=>S(l)?l.value=u:null),disabled:s.disabled,loading:g.loading,selectedLang:s.selectedLang,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","vuelidate"]),o(we,{modelValue:e(l),"onUpdate:modelValue":t[7]||(t[7]=u=>S(l)?l.value=u:null),disabled:s.disabled,loading:g.loading,selectedLang:e(m),vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","vuelidate"])],64))}},ze={__name:"search-service-modal",props:{pointOfCareId:{Number,required:!0},pointOfCareVersion:{Number,required:!0}},emits:["apply"],setup(g,{emit:s}){const n=g,i=Ne(),l="search-service-modal",m=ee(),b=ve();let a=G(R()),t=_([]),u=_([]),C=_(V.createEmptyDataSource()),r=_(!1),L=_(!1),F=_(0),T=_("pt"),B=G(U());function U(){return Te.newForm()}function R(){return{pageNumber:1,sortBy:"Code",code:null,serviceTypeIds:null,serviceCategoryIds:null,businessEventIds:null,lifeEventIds:null,abreviation:null,name:null,organization:null,recordStateIds:[v.recordStateType.published],active:!0}}le(async()=>{r.value=!0,t.value=V.convertEnumToArray(m.enums.recordStateType);const d=await Q.getLists(b.getLanguage);V.validateResponse(d,null,()=>{i.setLists(d.data),t.value=V.convertEnumToArray(m.enums.recordStateType),u.value=V.concatItemsBadge(t.value,w.recordStateTypeBadgeOptions)}),r.value=!1}),ae(async()=>{await A()});async function z(d){a.sortBy=d,await A()}async function q(d){a.pageNumber=d,await A()}async function A(){r.value=!0;let d=await Q.search(a);V.validateResponse(d,null,()=>{C.value=d.data}),r.value=!1}async function P(){Object.assign(a,R()),await A()}async function p(){await A()}async function X(d){const f=await Q.getById(d.serviceId,d.serviceVersion);V.validateResponse(f,null,()=>{Object.assign(B,f.data),L.value=!0}),F.value++}function h(){}async function H(){r.value=!0;const d=await J.associationCreate(n.pointOfCareId,n.pointOfCareVersion,B.serviceId,B.serviceVersion);V.validateResponse(d,m.backoffice.pointOfCare.serviceAdded,()=>{s("apply")}),r.value=!1}return(d,f)=>{const E=c("form-field"),D=c("row"),K=c("cfilter"),j=c("ccolumn"),Y=c("table-action-detail"),oe=c("ctable"),ne=c("container-wrapper"),Z=c("cbutton"),se=c("modal");return k(),N(se,{id:l,title:d._lang.backoffice.service.searchTitle,size:e(v).modalSize.extraLarge,"remove-padding":!0},{body:y(()=>[o(K,{title:d._lang.common.filter,disabled:e(r),"clear-click":P,"apply-click":p,loading:e(r),collapsed:!0},{default:y(()=>[o(D,null,{default:y(()=>[o(E,{id:"code",modelValue:e(a).code,"onUpdate:modelValue":f[0]||(f[0]=O=>e(a).code=O),class:"mb-3 col-12 col-md-6 col-xl-4",label:d._lang.label.code,type:e(v).inputs.text,maxlength:45,disabled:e(r)},null,8,["modelValue","label","type","disabled"]),o(E,{id:"serviceTypeId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(a).serviceTypeIds,"onUpdate:modelValue":f[1]||(f[1]=O=>e(a).serviceTypeIds=O),label:d._lang.label.serviceTypeId,type:e(v).inputs.multiselect,options:e(i).serviceTypeList,disabled:e(r),mode:e(v).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),o(E,{id:"serviceCategoryId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(a).serviceCategoryIds,"onUpdate:modelValue":f[2]||(f[2]=O=>e(a).serviceCategoryIds=O),label:d._lang.label.serviceCategoryId,type:e(v).inputs.multiselect,options:e(i).serviceCategoryList,disabled:e(r),mode:e(v).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),o(E,{id:"abreviation",class:"mb-3 col-12 col-md-6",modelValue:e(a).abreviation,"onUpdate:modelValue":f[3]||(f[3]=O=>e(a).abreviation=O),label:d._lang.label.abreviation,type:e(v).inputs.text,maxlength:16,disabled:e(r)},null,8,["modelValue","label","type","disabled"]),o(E,{id:"organizationId",class:"mb-3 col-12 col-md-6",modelValue:e(a).organization,"onUpdate:modelValue":f[4]||(f[4]=O=>e(a).organization=O),label:d._lang.label.organizationHost,type:e(v).inputs.multiselect,options:e(i).organizationList,disabled:e(r),valueProp:e(v).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),o(E,{id:"name",class:"mb-3 col-12",modelValue:e(a).name,"onUpdate:modelValue":f[5]||(f[5]=O=>e(a).name=O),label:d._lang.label.name,type:e(v).inputs.text,maxlength:45,disabled:e(r)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","disabled","loading"]),o(ne,null,{default:y(()=>[o(oe,{onSort:z,onChangePage:q,data:e(C),checkbox:!1,loading:e(r),defaultSort:"Code"},{columns:y(()=>[o(j,{name:d._lang.label.code,field:"code",sortable:!0},null,8,["name"]),o(j,{name:d._lang.label.serviceTypeId,field:"serviceType",sortField:"serviceTypeId",sortable:!0},null,8,["name"]),o(j,{name:d._lang.label.abreviation,field:"abreviation",sortable:!0},null,8,["name"]),o(j,{name:d._lang.label.name,field:"name",sortable:!0},null,8,["name"]),o(j,{name:d._lang.label.state,field:"recordStateTypeId",align:e(v).columnAlign.center,custom:ye,options:e(u),sortable:!0},null,8,["name","align","options"])]),actions:y(O=>[o(Y,{onClick:He=>X(O.item)},null,8,["onClick"])]),_:1},8,["data","loading"])]),_:1}),(k(),N(e(me),{collapsed:e(L),class:"mt-5",key:e(F),modelValue:e(B),"onUpdate:modelValue":f[6]||(f[6]=O=>S(B)?B.value=O:B=O),disabled:!0,loading:e(r),selectedLang:e(T),validateForm:!1},null,8,["collapsed","modelValue","loading","selectedLang"]))]),footer:y(()=>[o(Z,{type:"primary",size:"large",title:d._lang.common.apply,"data-bs-dismiss":"modal",onClick:H,disabled:!e(B).code},null,8,["title","disabled"]),o(Z,{type:"secondary",size:"large",title:d._lang.common.cancel,"data-bs-dismiss":"modal",onClick:h},null,8,["title"])]),_:1},8,["title","size"])}}},Pe=["id"],he={__name:"services",props:{},setup(g){const s=_(_e.havePermission(v.permissions.pointOfCare.createEdit));ae(()=>{}),le(async()=>{C.value=V.decodeId(m.params.pointOfCareId),r.value=V.decodeId(m.params.pointOfCareVersion),!C.value||!r.value?a.push({name:constants.router.BACKOFFICE_POINT_OF_CARE_PAGE.name}):(F.pointOfCareId=C.value,F.pointOfCareVersion=r.value,await q())});const n="search-service-modal",i="delete-service",l=V.uuid(),m=Ve(),b=ee(),a=Ce();let t=_(!0),u=_(0),C=_(0),r=_(0),L=_(V.createEmptyDataSource()),F=G(B()),T=_(null);function B(){return{pageNumber:1,sortBy:"ServiceName",active:!0,pointOfCareId:null,pointOfCareVersion:null}}function U(){u.value++,window.setTimeout(function(){V.showModalById(n)},5)}async function R(p){F.sortBy=p,await q()}async function z(p){F.pageNumber=p,await q()}async function q(){t.value=!0;let p=await J.associationSearch(F);V.validateResponse(p,null,()=>{L.value=p.data}),t.value=!1}async function A(p){T.value=p}async function P(){if(T.value){t.value=!0;const p=await J.associationRemove(C.value,r.value,T.value.serviceId,T.value.serviceVersion);V.validateResponse(p,b.backoffice.pointOfCare.serviceRemoved,async()=>{await q()}),t.value=!1}}return(p,X)=>{const h=c("icon-plus"),H=c("table-actions"),d=c("ccolumn"),f=c("table-action-delete"),E=c("ctable"),D=c("container-wrapper"),K=c("confirm-delete-modal");return k(),M(W,null,[o(D,null,{default:y(()=>[o(H,{title:p._lang.common.tableActionTitle},{default:y(()=>[s.value?(k(),M("button",{key:0,class:"btn btn-primary",type:"button",id:e(l),onClick:U},[o(h,{color:"#FFF"}),Oe(" "+Le(p._lang.common.addService),1)],8,Pe)):$("",!0)]),_:1},8,["title"]),o(E,{onSort:R,onChangePage:z,data:e(L),checkbox:!1,loading:e(t),defaultSort:"ServiceName",checkboxField:"code"},{columns:y(()=>[o(d,{name:p._lang.label.code,field:"serviceCode",sortable:!0},null,8,["name"]),o(d,{name:p._lang.label.channelTypeId,field:"serviceType",sortField:"serviceType",sortable:!0},null,8,["name"]),o(d,{name:p._lang.label.abreviation,field:"serviceOrganization",sortField:"serviceOrganizationId",sortable:!0},null,8,["name"]),o(d,{name:p._lang.label.name,field:"serviceName",sortable:!0},null,8,["name"]),o(d,{name:p._lang.label.organizationHost,field:"serviceOrganization",sortField:"serviceOrganizationId",sortable:!0},null,8,["name"])]),actions:y(j=>[o(f,{id:i,onClick:Y=>A(j.item)},null,8,["onClick"])]),_:1},8,["data","loading"])]),_:1}),e(t)?$("",!0):(k(),N(ze,{key:e(u),pointOfCareId:e(C),pointOfCareVersion:e(r),onApply:q},null,8,["pointOfCareId","pointOfCareVersion"])),o(K,{id:i,title:p._lang.backoffice.pointOfCare.serviceDeleteTitle,message:p._lang.backoffice.pointOfCare.serviceDeleteQuestion,action:P},null,8,["title","message"])],64)}}},nl={__name:"form",props:{formModel:{Object,required:!0},loading:{type:Boolean,required:!0},validateForm:{type:Boolean,required:!0},disabled:{type:Boolean,required:!0},isExternalEdit:{type:Boolean,required:!0},selectedLang:{type:[Number,String],required:!0},rules:{type:Object,required:!0},vuelidate:{Object,default:null},showProgress:{type:Boolean,default:!0},progressValue:{type:[Number],required:!1}},emits:["update:formModel"],setup(g,{emit:s}){const n=g,i=I({get(){return n.formModel},set(l){s("update:formModel",l)}});return(l,m)=>{const b=c("progress-bar"),a=c("container-wrapper"),t=c("tab-content"),u=c("tabs");return k(),N(u,null,{default:y(()=>[o(t,{id:"general",title:l._lang.common.general,active:!0},{default:y(()=>[n.showProgress?(k(),N(a,{key:0,"margin-top":!1},{default:y(()=>[n.showProgress?(k(),N(b,{key:0,value:n.progressValue,label:l._lang.common.fill,class:"mb-4 col-12 float-end"},null,8,["value","label"])):$("",!0)]),_:1})):$("",!0),o($e,{modelValue:e(i),"onUpdate:modelValue":m[0]||(m[0]=C=>S(i)?i.value=C:null),disabled:n.disabled,validateForm:n.validateForm,loading:n.loading,selectedLang:n.selectedLang,rules:n.rules},null,8,["modelValue","disabled","validateForm","loading","selectedLang","rules"])]),_:1},8,["title"]),o(t,{id:"services",title:l._lang.backoffice.menu.services,active:!1,disabled:!1},{default:y(()=>[o(he)]),_:1},8,["title"])]),_:1})}}};export{nl as _};
