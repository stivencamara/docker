import{d as P,_ as G,K as j,a1 as H,h as x,r as g,u as S,k as i,c,e as y,m as t,p as e,F as k,n as l,w as d,t as J,v as I,l as T,y as B,ad as K,x as E,G as $,A as Q,B as W,i as X,a as Y,j as Z,H as O,s as f}from"./index-f9e60098.js";import{i as C}from"./import-9c147039.js";const U=P("ImportStore",{state:()=>({importCodeList:[]}),getters:{},actions:{addImportCode(p){this.importCodeList.push(p)},revomeImportCodeById(p){const _=this.importCodeList.findIndex(m=>m.code===p);return _>-1?(this.importCodeList.splice(_,1),!0):!1},resetList(){this.importCodeList=[]}},persist:{enabled:!0,strategies:[{key:"params-import",storage:localStorage,paths:["importCodeList"]}]}});const z=p=>(Q("data-v-f3fb23b6"),p=p(),W(),p),ee=z(()=>t("span",{class:"label placeholder"},null,-1)),te=z(()=>t("span",{class:"counter placeholder"},null,-1)),ae={key:1},oe={class:"label col-9"},se={class:"col-3 card-date"},le={class:"progress"},ne=["aria-valuenow"],re={class:"table table-container"},ie=z(()=>t("thead",{class:"table-head"},[t("tr",null,[t("th",{class:"table-head-column"},"Descrição")])],-1)),ce={class:"table-body"},de={__name:"import-card",props:{item:{type:Object,required:!0},loading:{type:Boolean,default:!1}},setup(p){const _=p;j(async()=>{await w(),o=window.setInterval(async()=>{n.value<100&&await w()},4e3)}),H(()=>{window.clearInterval(o)}),U(),x();var m=g(!1),n=g(0),a=g([]),o;async function w(){m.value=!0;const h=await C.get(_.item.code);S.validateResponse(h,null,()=>{try{const b=JSON.parse(h.data);console.log(b),n.value=b.Status,a.value=b.Errors}catch(b){console.log(b)}}),m.value=!1}return(h,b)=>{const L=i("icon-danger"),s=i("row"),r=i("accordion");return c(),y(k,null,[t("div",{class:$(["mb-3 row home-card placeholder-glow",{active:!1}])},[e(m)?(c(),y(k,{key:0},[ee,te],64)):(c(),y("div",ae,[l(s,{class:""},{default:d(()=>[t("h6",oe,[J(I(_.item.name)+" ",1),e(a).length>0?(c(),T(L,{key:0,class:"p-hand"})):B("",!0)]),t("div",se,I(e(S).formatDate(_.item.date,"DD/MM/yyyy hh:mm")),1)]),_:1}),l(s,{class:"mb-3"},{default:d(()=>[t("div",le,[t("div",{class:"progress-bar bg-success",role:"progressbar",style:K({width:e(n)+"%"}),"aria-valuenow":e(n),"aria-valuemin":"0","aria-valuemax":"100"},I(e(n))+"% ",13,ne)])]),_:1}),e(a).length>0?(c(),T(r,{key:0,id:"errors",title:h._lang.common.errors,collapsed:!1,class:"mb-4 bg-transparent"},{default:d(()=>[l(s,null,{default:d(()=>[t("table",re,[ie,t("tbody",ce,[(c(!0),y(k,null,E(e(a),(u,V)=>(c(),y("tr",{key:V},[t("td",null,[t("span",null,I(u),1)])]))),128))])])]),_:1})]),_:1},8,["title"])):B("",!0)]))]),e(m)?B("",!0):(c(),y(k,{key:0},[],64))],64)}}},pe=G(de,[["__scopeId","data-v-f3fb23b6"]]),ue={class:"col-12 hstack gap-2 mt-3"},me={class:"mb-3 gap-5",cards:""},fe={__name:"index",setup(p){const _=X(),m=U();x();var n=g(!1),a=g(null),o=g(null),w=g([]);g([]),j(()=>{w.value=S.convertEnumToArray(_.enums.importType)}),Y(()=>{});const h=Z(()=>m.importCodeList);function b(){o.value=null,a.value=null}async function L(s){n.value=!0;let r={data:o.value.data,name:o.value.name},u=null;switch(a.value){case f.importType.organization:u=await C.organization(r);break;case f.importType.service:u=await C.service(r);break;case f.importType.location:u=await C.location(r);break;case f.importType.servicePoint:u=await C.pointOfCare(r);break}S.validateResponse(u,"Importação iniciada",()=>{m.addImportCode({name:o.value.name,code:u.data,date:new Date}),b()}),n.value=!1}return(s,r)=>{const u=i("breadcrumb-item"),V=i("breadcrumb"),D=i("form-field"),N=i("row"),F=i("cbutton"),M=i("accordion"),R=i("card"),q=i("page");return c(),T(q,{title:s._lang.backoffice.settings.import.pageTitle},{breadcrumb:d(()=>[l(V,{"has-home":!0},{default:d(()=>[l(u,{label:s._lang.backoffice.settings.import.pageTitle},null,8,["label"])]),_:1})]),default:d(()=>[l(R,{shadow:!0},{body:d(()=>[l(M,{id:"newImport",title:s._lang.common.newImport,collapsed:!0,class:"mb-4"},{default:d(()=>[l(N,null,{default:d(()=>[l(D,{id:"importType",class:"mb-3 col-12 col-lg-4",modelValue:e(a),"onUpdate:modelValue":r[0]||(r[0]=v=>O(a)?a.value=v:a=v),label:s._lang.label.objectType,loading:e(n),type:e(f).inputs.multiselect,placeholder:s._lang.common.selectOption,options:e(w)},null,8,["modelValue","label","loading","type","placeholder","options"]),l(D,{id:"document",class:"mb-3 col-12 col-lg-8",modelValue:e(o),"onUpdate:modelValue":r[1]||(r[1]=v=>O(o)?o.value=v:o=v),label:s._lang.label.document,loading:e(n),type:e(f).inputs.file,required:!0},null,8,["modelValue","label","loading","type"])]),_:1}),l(N,null,{default:d(()=>[t("div",ue,[l(F,{class:"ms-auto",type:e(f).buttonType.primary,title:s._lang.common.import,onClick:L,size:e(f).buttonSize.medium,disabled:e(a)==null||e(o)==null||e(n)},null,8,["type","title","size","disabled"])])]),_:1})]),_:1},8,["title"]),t("div",me,[(c(!0),y(k,null,E(e(h),(v,A)=>(c(),T(pe,{key:A,item:v},null,8,["item"]))),128))])]),_:1})]),_:1},8,["title"])}}};export{fe as default};
