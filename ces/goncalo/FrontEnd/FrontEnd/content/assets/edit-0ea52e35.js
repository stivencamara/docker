import{_ as U}from"./form-10389747.js";import{g as q,f as D,i as Y,r as o,G as z,s as B,j as L,N as w,K as $,u as d,z as f,k as F,c as E,e as T,n as s,w as I,p as e,F as h,I as k}from"./index-c417b10a.js";import{p as _}from"./point-of-care-86bcb545.js";import{p as C}from"./helpers-bb0e4cec.js";import{u as J}from"./point-of-care-870d551b.js";import{u as Q}from"./index.esm-5fe78185.js";import{b as W}from"./helpers-422844e7.js";import{e as X}from"./edit-actions-af789f62.js";import{_ as Z}from"./unsaved-769b1fd6.js";import"./contacts-d61273ea.js";import"./location-d3d0b570.js";import"./address-c37f517b.js";import"./organization-53b6fe99.js";import"./address.vue_vue_type_style_index_0_scoped_5480b292_lang-1be492ce.js";import"./service-d66d7fcd.js";import"./refusal-45a989d4.js";import"./index.esm-29b873a2.js";import"./generic-972994fb.js";import"./service-e178ddc5.js";import"./helpers-9f3bdf36.js";import"./helpers-1b7a9838.js";import"./cancel-confirm-f07f887e.js";import"./settings-fb41674a.js";/* empty css                                                                     */const Te={__name:"edit",setup(x){const M=q(),n=D(),S=Y(),p=J();let t=o(!0),a=z(C.newForm()),l=o(B.language.pt);o([]);let y=z(C.formRules()),g=o(0),b=o(0),c=o(0),N=o(0),O=o(0),v=o([]),A=o(!1);const P=Q(y,a),G=L(()=>O.value===100&&!t.value);async function K(){t.value=!0;const r=await _.getById(g.value,b.value);d.validateResponse(r,null,()=>{Object.assign(a,r.data),p.setFormToCompare(d.cloneObject(r.data))}),t.value=!1}async function R(){t.value=!0;const r=await _.getLists(l.value,a.recordStateTypeId!=B.recordStateType.draft);d.validateResponse(r,null,()=>{p.setLists(r.data)}),t.value=!1}w(()=>l.value,()=>{R()}),$(async()=>{g.value=d.decodeId(n.params.pointOfCareId),b.value=d.decodeId(n.params.pointOfCareVersion),c.value=d.decodeId(n.params.organizationId),N.value=d.decodeId(n.params.organizationVersion),A.value=n.params.organicOrigin==="true",!g.value||!b.value?M.push({name:f.router.BACKOFFICE_POINT_OF_CARE_PAGE.name}):(await K(),await R())}),w(()=>[a.texts[0].name,a.organization,a.organizationHost,a.startDate,a.channel.channelTypeId,a.address.zipCode,a.address.islandId,a.address.countyId,a.address.parishId,a.address.locality,a.address.address],()=>{a.channel.channelTypeId==6||a.channel.channelTypeId==2?(v.value=C.progressFieldsAddress(),a.address.isRequired=!0):(v.value=C.progressFields(),a.address.isRequired=!1),W.calculatePercentage(a,v.value,r=>{p.setProgress(r),O.value=r})});const V=L(()=>c.value>0?`${f.router.BACKOFFICE_EDIT_ENTITY_PAGE.path.replace(":organizationId",n.params.organizationId).replace(":organizationVersion",n.params.organizationVersion)}#pontosatendimento`:f.router.BACKOFFICE_POINT_OF_CARE_PAGE.name);return(r,u)=>{const m=F("breadcrumb-item"),j=F("breadcrumb"),H=F("page");return E(),T(h,null,[s(H,{title:r._lang.backoffice.pointOfCare.editPageTitle},{breadcrumb:I(()=>[s(j,{"has-home":!0},{default:I(()=>[e(c)>0?(E(),T(h,{key:0},[s(m,{label:r._lang.backoffice.entities.breadcrumbTitle,"router-path":e(f).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),s(m,{label:e(S).common.entity,"router-path":e(V)},null,8,["label","router-path"]),s(m,{label:r._lang.backoffice.pointOfCare.editPageTitle},null,8,["label"])],64)):(E(),T(h,{key:1},[s(m,{label:r._lang.backoffice.pointOfCare.breadcrumbTitle,"router-path":e(f).router.BACKOFFICE_POINT_OF_CARE_PAGE.path},null,8,["label","router-path"]),s(m,{label:r._lang.backoffice.pointOfCare.editPageTitle},null,8,["label"])],64))]),_:1})]),actions:I(()=>[s(X,{loading:e(t),"onUpdate:loading":u[0]||(u[0]=i=>k(t)?t.value=i:t=i),canSubmit:e(G),selectedLang:e(l),"onUpdate:selectedLang":u[1]||(u[1]=i=>k(l)?l.value=i:l=i),backRoute:e(V),directBackRoute:e(c)>0,service:e(_),itemId:e(g),itemVersion:e(b),formModel:e(a),vuelidate:e(P),store:e(p),resource:r._lang.backoffice.pointOfCare,itemIdField:"pointOfCareId",progressFields:e(v),organicOrigin:e(A)},null,8,["loading","canSubmit","selectedLang","backRoute","directBackRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource","progressFields","organicOrigin"])]),default:I(()=>[s(U,{formModel:e(a),"onUpdate:formModel":u[2]||(u[2]=i=>k(a)?a.value=i:a=i),disabled:!1,validateForm:!0,loading:e(t),selectedLang:e(l),rules:e(y),isExternalEdit:e(c)>0,vuelidate:e(P),progressValue:e(O),"show-progress":!0},null,8,["formModel","loading","selectedLang","rules","isExternalEdit","vuelidate","progressValue"])]),_:1},8,["title"]),s(Z,{store:e(p),formModel:e(a),service:e(_),resource:r._lang.backoffice.pointOfCare},null,8,["store","formModel","service","resource"])],64)}}};export{Te as default};
