import{_ as x}from"./form-c5ce17f0.js";import{g as U,f as D,i as H,r as l,G as h,s as v,j as R,N as P,K as Y,u as o,z as g,k as y,c as T,l as q,w as E,n,p as a,e as w,F as z,I as F}from"./index-a14ad215.js";import{s as k}from"./service-a0c37778.js";import{s as f}from"./helpers-11fd24aa.js";import{u as J}from"./service-9ca2bd37.js";import{u as Q}from"./index.esm-97dcd533.js";import{b as W}from"./helpers-71142cd6.js";import{e as X}from"./edit-actions-913d0dbe.js";import"./index.esm-88a1129f.js";import"./address.vue_vue_type_style_index_0_scoped_5480b292_lang-b87b4179.js";import"./point-of-care-86564745.js";import"./form-247c12ee.js";import"./settings-739a4c13.js";import"./legislation-1bd6be27.js";import"./organization-4f7bdfd2.js";import"./helpers-a264fdb9.js";import"./refusal-4e803a93.js";import"./generic-90322b29.js";import"./point-of-care-4055b36e.js";import"./helpers-bdeacb10.js";import"./cancel-confirm-ab082f5c.js";/* empty css                                                                     */const _e={__name:"edit",setup(Z){const L=U(),d=D(),O=H(),b=J();let s=l(!0),e=h(f.newForm()),p=l(v.language.pt);l([]);let V=h(f.formRules()),I=l(0),S=l(0),_=l(0),m=l(0),M=l(0),c=l([]);const C=Q(V,e),G=R(()=>_.value===100&&!s.value);async function K(){s.value=!0;const r=await k.getById(I.value,S.value);o.validateResponse(r,null,()=>{let t=r.data;t.eventTypeId=t.lifeEventId?v.eventType.life:v.eventType.business,t.processingTime.type=t.processingTime.weeks?v.processingTimeType.simplified:v.processingTimeType.advanced,t.virtual=t.virtual==null?f.newVirtual():t.virtual,t.stateSupport=t.stateSupport==null?f.newStateSupport():t.stateSupport,Object.assign(e,t),b.setFormToCompare(o.cloneObject(t))}),s.value=!1}async function A(){s.value=!0;const r=await k.getLists(p.value);o.validateResponse(r,null,()=>{b.setLists(r.data)}),s.value=!1}P(()=>p.value,()=>{A()}),Y(async()=>{I.value=o.decodeId(d.params.serviceId),S.value=o.decodeId(d.params.serviceVersion),m.value=o.decodeId(d.params.organizationId),M.value=o.decodeId(d.params.organizationVersion),!I.value||!S.value?L.push({name:g.router.BACKOFFICE_SERVICE_PAGE.name}):(await A(),await K())}),P(()=>{var r,t;return[e.texts[0].name,e.organization,e.serviceTypeId,e.serviceCategoryId,e.startDate,e.economicActivityId,(r=e.virtual)==null?void 0:r.isVirtual,(t=e.stateSupport)==null?void 0:t.isStateSupport]},()=>{var r,t;c.value=f.progressFields(),(r=e.virtual)!=null&&r.isVirtual?c.value.push("virtual.url"):(o.removeItemOfArray(c.value,"virtual.url"),e.virtual!=null&&(e.virtual.url=null,e.virtual.externalSystemId=null,e.virtual.processId=null,e.virtual.canExecutedByThirdParty=null)),(t=e.stateSupport)!=null&&t.isStateSupport?c.value.push("stateSupport.url"):(o.removeItemOfArray(c.value,"stateSupport.url"),e.stateSupport!=null&&(e.stateSupport.url=null,e.stateSupport.externalSystemId=null,e.stateSupport.processId=null)),W.calculatePercentage(e,c.value,i=>{b.setProgress(i),_.value=i})});const B=R(()=>m.value>0?`${g.router.BACKOFFICE_EDIT_ENTITY_PAGE.path.replace(":organizationId",d.params.organizationId).replace(":organizationVersion",d.params.organizationVersion)}#servicos`:g.router.BACKOFFICE_SERVICE_PAGE.name);return(r,t)=>{const i=y("breadcrumb-item"),N=y("breadcrumb"),j=y("page");return T(),q(j,{title:r._lang.backoffice.service.editPageTitle},{breadcrumb:E(()=>[n(N,{"has-home":!0},{default:E(()=>[a(m)>0?(T(),w(z,{key:0},[n(i,{label:r._lang.backoffice.entities.breadcrumbTitle,"router-path":a(g).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),n(i,{label:a(O).common.entity,"router-path":a(B)},null,8,["label","router-path"]),n(i,{label:r._lang.backoffice.service.editPageTitle},null,8,["label"])],64)):(T(),w(z,{key:1},[n(i,{label:r._lang.backoffice.service.breadcrumbTitle,"router-path":a(g).router.BACKOFFICE_SERVICE_PAGE.path},null,8,["label","router-path"]),n(i,{label:r._lang.backoffice.service.editPageTitle},null,8,["label"])],64))]),_:1})]),actions:E(()=>[n(X,{loading:a(s),"onUpdate:loading":t[0]||(t[0]=u=>F(s)?s.value=u:s=u),canSubmit:a(G),selectedLang:a(p),"onUpdate:selectedLang":t[1]||(t[1]=u=>F(p)?p.value=u:p=u),backRoute:a(B),directBackRoute:a(m)>0,service:a(k),itemId:a(I),itemVersion:a(S),itemIdField:"serviceId",formModel:a(e),vuelidate:a(C),store:a(b),resource:r._lang.backoffice.service,progressFields:a(c)},null,8,["loading","canSubmit","selectedLang","backRoute","directBackRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource","progressFields"])]),default:E(()=>[n(x,{formModel:a(e),"onUpdate:formModel":t[2]||(t[2]=u=>F(e)?e.value=u:e=u),disabled:!1,loading:a(s),selectedLang:a(p),validateForm:!0,rules:a(V),isExternalEdit:a(m)>0,progressValue:a(_),vuelidate:a(C)},null,8,["formModel","loading","selectedLang","rules","isExternalEdit","progressValue","vuelidate"])]),_:1},8,["title"])}}};export{_e as default};
