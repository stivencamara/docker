import{_ as Q}from"./cancel-confirm-ad6df65a.js";import{L as U,g as $,i as V,r as J,H as A,o as K,j as B,u as a,k as f,c as r,e as W,p as s,l as u,q as t,J as X,z as m,t as l,F as Y,R as Z}from"./index-61b82425.js";import{s as x}from"./settings-85dcc88f.js";const ne={__name:"edit-actions",props:{loading:{Boolean,required:!0},selectedLang:{type:[String,Number],required:!1},formModel:{type:Object,required:!0},service:{type:Object,required:!0},itemId:{type:[String,Number],required:!0},vuelidate:{type:Object,default:null},store:{type:Object,required:!0},resource:{type:Object},backRoute:{type:String,required:!0},showLangSelector:{Boolean,required:!0},canEdit:{type:Boolean,required:!0},canDelete:{type:Boolean,required:!0},canGeneratePassword:{type:Boolean,deafult:!1}},emits:["update:selectedLang","update:loading"],setup(I,{emit:k}){const e=I;U(async()=>{await L()});const c=$(),h=V(),v="confirm-cancel",w="confirm-delete",M="confirm-Recover",C="confirm-Unblock",R="confirm-generate-password";let z=J([]),_=A({});K(()=>{Object.assign(_,e.formModel)});const y=B({get(){return e.selectedLang},set(o){k("update:selectedLang",o)}}),n=B({get(){return e.loading},set(o){k("update:loading",o)}});async function L(){let o=await x.getLanguages();a.validateResponse(o,null,()=>{z.value=o.data})}function S(){a.compareObjectIsDirty(e.store.formToCompare,e.formModel)?a.showModalById(v):c.push({name:e.backRoute})}function T(){c.push({name:e.backRoute})}async function D(){e.canDelete&&a.showModalById(w)}async function q(){if(e.canDelete){n.value=!0;const o=await e.service.delete(e.itemId);a.validateResponse(o,e.resource.deleted,()=>{c.push({name:e.backRoute})}),n.value=!1}}async function j(){e.canDelete&&a.showModalById(M)}async function O(){e.canDelete&&a.showModalById(C)}async function P(){e.canDelete&&a.showModalById(R)}async function E(){if(e.canDelete){n.value=!0;const o=await e.service.recover(e.formModel);a.validateResponse(o,e.resource.recovered,()=>{c.push({name:e.backRoute})}),n.value=!1}}async function F(){if(e.canDelete){n.value=!0;const o=await e.service.unblock(e.formModel);a.validateResponse(o,e.resource.unblocked,()=>{c.push({name:e.backRoute})}),n.value=!1}}async function G(){n.value=!0;const o=await e.service.generatepassword(e.formModel.userId);a.validateResponse(o,e.resource.unblocked,()=>{c.push({name:e.backRoute})}),n.value=!1}async function b(){var o,p;if(e.canEdit){if(n.value=!0,e.formModel.validateForm=!0,await((o=e.vuelidate)==null?void 0:o.$validate()),(p=e.vuelidate)!=null&&p.$error)Z.warning(h.common.requiredFields);else{let i=null;!e.itemId||e.itemId===-1?i=await e.service.create(e.formModel):i=await e.service.update(e.formModel),a.validateResponse(i,e.resource.saved,()=>{Object.assign(_,e.formModel),e.store.setFormToCompare(e.formModel),c.push({name:e.backRoute})})}n.value=!1}}return(o,p)=>{const i=f("Hotkeys"),H=f("lang-selector"),d=f("cbutton"),g=f("confirm-delete-modal");return r(),W(Y,null,[s(i,{shortcuts:["S"],debug:!0,onTriggered:b}),e.showLangSelector?(r(),u(H,{key:0,options:t(z),selectedLang:t(y),"onUpdate:selectedLang":p[0]||(p[0]=N=>X(y)?y.value=N:null),disabled:t(n)},null,8,["options","selectedLang","disabled"])):m("",!0),s(d,{class:"col-12 col-sm-auto",type:t(l).buttonType.secondary,size:t(l).buttonSize.large,title:o._lang.common.cancel,onClick:S,disabled:t(n)},null,8,["type","size","title","disabled"]),e.canDelete&&!e.formModel.deleted?(r(),u(d,{key:1,class:"col-12 col-sm-auto",type:t(l).buttonType.secondary,size:t(l).buttonSize.large,title:o._lang.common.delete,onClick:D,disabled:t(n)},null,8,["type","size","title","disabled"])):m("",!0),e.canDelete&&e.formModel.deleted?(r(),u(d,{key:2,class:"col-12 col-sm-auto",type:t(l).buttonType.secondary,size:t(l).buttonSize.large,title:o._lang.common.recover,onClick:j,disabled:t(n)},null,8,["type","size","title","disabled"])):m("",!0),e.formModel.blocked?(r(),u(d,{key:3,class:"col-12 col-sm-auto",type:t(l).buttonType.secondary,size:t(l).buttonSize.large,title:o._lang.common.unBlock,onClick:O,disabled:t(n)},null,8,["type","size","title","disabled"])):m("",!0),e.canEdit&&e.canGeneratePassword?(r(),u(d,{key:4,class:"col-12 col-sm-auto",title:o._lang.common.generatePassword,type:t(l).buttonType.secondary,size:t(l).buttonSize.large,onClick:P,disabled:t(n)},null,8,["title","type","size","disabled"])):m("",!0),e.canEdit?(r(),u(d,{key:5,class:"col-12 col-sm-auto",title:o._lang.common.save,type:t(l).buttonType.primary,size:t(l).buttonSize.large,onClick:b,disabled:t(n)},null,8,["title","type","size","disabled"])):m("",!0),s(Q,{id:v,title:o._lang.common.cancel,action:T},null,8,["title"]),s(g,{id:w,title:o._lang.common.deleteTitle,message:o._lang.common.deleteQuestion,action:q},null,8,["title","message"]),s(g,{id:M,title:o._lang.common.recoverTitle,message:o._lang.common.recoverQuestion,action:E},null,8,["title","message"]),s(g,{id:C,title:o._lang.common.unblockTitle,message:o._lang.common.unblockQuestion,action:F},null,8,["title","message"]),s(g,{id:R,title:o._lang.common.generatePasswordTitle,message:o._lang.common.generatePasswordQuestion,action:G},null,8,["title","message"]),s(i,{shortcuts:["S"],debug:!0,onTriggered:b})],64)}}};export{ne as _};
