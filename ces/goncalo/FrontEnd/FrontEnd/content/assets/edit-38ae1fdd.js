import{_ as j}from"./form-c1d7a06c.js";import{g as H,f as D,i as Y,r as o,E as B,s as v,j as R,N as h,K as q,u as i,z as g,k as T,c as F,l as x,w as E,n,p as e,e as P,F as z,H as S}from"./index-074485c3.js";import{s as k}from"./service-1dc5fd50.js";import{s as y}from"./helpers-1bacd47d.js";import{u as J}from"./service-e1ee3ce3.js";import{u as Q}from"./index.esm-ba4feb27.js";import{b as W}from"./helpers-9f106e00.js";import{e as X}from"./edit-actions-9284da32.js";import"./index.esm-da08cc71.js";import"./address.vue_vue_type_style_index_0_scoped_2266ba05_lang-01445eae.js";import"./point-of-care-fd618554.js";import"./form-ad1e25ec.js";import"./settings-c1957f95.js";import"./refusal-f524e0ab.js";import"./generic-9fc3b9dd.js";import"./point-of-care-69e1e40c.js";import"./organization-0a1af671.js";import"./helpers-3438087c.js";import"./helpers-d98c457a.js";import"./cancel-confirm-7618a353.js";/* empty css                                                                     */const _e={__name:"edit",setup(Z){const L=H(),p=D(),w=Y(),f=J();let s=o(!0),a=B(y.newForm()),u=o(v.language.pt);o([]);let V=B(y.formRules()),b=o(0),I=o(0),_=o(0),m=o(0),O=o(0),c=o([]);const M=Q(V,a),U=R(()=>_.value===100&&!s.value);async function K(){s.value=!0;const t=await k.getById(b.value,I.value);i.validateResponse(t,null,()=>{let r=t.data;r.eventTypeId=r.lifeEventId?v.eventType.life:v.eventType.business,r.processingTime.type=r.processingTime.weeks?v.processingTimeType.simplified:v.processingTimeType.advanced,Object.assign(a,r),f.setFormToCompare(i.cloneObject(r))}),s.value=!1}async function C(){s.value=!0;const t=await k.getLists(u.value);i.validateResponse(t,null,()=>{f.setLists(t.data)}),s.value=!1}h(()=>u.value,()=>{C()}),q(async()=>{b.value=i.decodeId(p.params.serviceId),I.value=i.decodeId(p.params.serviceVersion),m.value=i.decodeId(p.params.organizationId),O.value=i.decodeId(p.params.organizationVersion),!b.value||!I.value?L.push({name:g.router.BACKOFFICE_SERVICE_PAGE.name}):(await C(),await K())}),h(()=>[a.texts[0].name,a.organization,a.serviceTypeId,a.serviceCategoryId,a.startDate,a.economicActivityId,a.virtual.isVirtual,a.stateSupport.isStateSupport],()=>{c.value=y.progressFields(),a.virtual.isVirtual?c.value.push("virtualUrl"):(i.removeItemOfArray(c.value,"virtualUrl"),a.virtual.url=null),a.stateSupport.isStateSupport?c.value.push("stateSupportUrl"):(i.removeItemOfArray(c.value,"stateSupportUrl"),a.stateSupport.url=null),W.calculatePercentage(a,c.value,t=>{f.setProgress(t),_.value=t})});const A=R(()=>m.value>0?`${g.router.BACKOFFICE_EDIT_ENTITY_PAGE.path.replace(":organizationId",p.params.organizationId).replace(":organizationVersion",p.params.organizationVersion)}#servicos`:g.router.BACKOFFICE_SERVICE_PAGE.name);return(t,r)=>{const d=T("breadcrumb-item"),G=T("breadcrumb"),N=T("page");return F(),x(N,{title:t._lang.backoffice.service.editPageTitle},{breadcrumb:E(()=>[n(G,{"has-home":!0},{default:E(()=>[e(m)>0?(F(),P(z,{key:0},[n(d,{label:t._lang.backoffice.entities.breadcrumbTitle,"router-path":e(g).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),n(d,{label:e(w).common.entity,"router-path":e(A)},null,8,["label","router-path"]),n(d,{label:t._lang.backoffice.service.editPageTitle},null,8,["label"])],64)):(F(),P(z,{key:1},[n(d,{label:t._lang.backoffice.service.breadcrumbTitle,"router-path":e(g).router.BACKOFFICE_SERVICE_PAGE.path},null,8,["label","router-path"]),n(d,{label:t._lang.backoffice.service.editPageTitle},null,8,["label"])],64))]),_:1})]),actions:E(()=>[n(X,{loading:e(s),"onUpdate:loading":r[0]||(r[0]=l=>S(s)?s.value=l:s=l),canSubmit:e(U),selectedLang:e(u),"onUpdate:selectedLang":r[1]||(r[1]=l=>S(u)?u.value=l:u=l),backRoute:e(A),directBackRoute:e(m)>0,service:e(k),itemId:e(b),itemVersion:e(I),itemIdField:"serviceId",formModel:e(a),vuelidate:e(M),store:e(f),resource:t._lang.backoffice.service,progressFields:e(c)},null,8,["loading","canSubmit","selectedLang","backRoute","directBackRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource","progressFields"])]),default:E(()=>[n(j,{formModel:e(a),"onUpdate:formModel":r[2]||(r[2]=l=>S(a)?a.value=l:a=l),disabled:!1,loading:e(s),selectedLang:e(u),validateForm:!0,rules:e(V),isExternalEdit:e(m)>0,progressValue:e(_)},null,8,["formModel","loading","selectedLang","rules","isExternalEdit","progressValue"])]),_:1},8,["title"])}}};export{_e as default};
