import{g as G,f as M,i as D,h as H,r as s,G as w,s as T,j as F,M as U,K as Y,u as v,z as o,N as j,k as _,c as d,l as c,w as I,n as b,p as e,I as h,y as q}from"./index-e6787e94.js";import{o as E}from"./organization-350c47d5.js";import{u as J}from"./organization-58b01a26.js";import{o as L}from"./helpers-3c2faf50.js";import{_ as x}from"./detail-actions-d1bf1f45.js";import{_ as Q}from"./form-b7a0ae9b.js";import"./helpers-1692af0f.js";import"./index.esm-7850210a.js";import"./refusal-82cd23d2.js";import"./helpers-3e986238.js";import"./helpers-ee63bdf4.js";import"./helpers-8a70ee11.js";import"./helpers-b39b0e24.js";import"./helpers-30a39e68.js";import"./settings-8db6c4e1.js";import"./contacts-6d99aa4e.js";import"./index.esm-cb55abbd.js";import"./location-2fc2c3e7.js";import"./address-eabe1c2c.js";import"./generic-25679898.js";import"./point-of-care-415bd492.js";import"./service-e67c421d.js";import"./document-7d8e49bb.js";const Ee={__name:"detail",setup(W){const S=G(),p=M();D();const V=H(),z=J(),l=s(0),u=s(0);let r=s(!0),i=w(L.newForm()),n=s(T.language.pt);s([]);let y=w(L.formRules()),g=s(null);const C=F(()=>p.path.toLowerCase().indexOf("tarefas")>-1),A=F(()=>p.path.toLowerCase().indexOf("pesquisa")>-1),k=s(U.havePermission(T.permissions.organization.createEdit));Y(async()=>{l.value=v.decodeId(p.params.organizationId),u.value=v.decodeId(p.params.organizationVersion),!l.value||!u.value?S.push({name:o.router.BACKOFFICE_ENTITIES_PAGE.name}):(await R(),await B(),O.value&&(await g.value.getHistory(),g.value.setActiveVersion(u.value),g.value.setStep()))});const O=F(()=>!C.value&&k.value&&i.recordStateTypeId!=T.recordStateType.draft);async function B(){const t=await E.getById(l.value,u.value);v.validateResponse(t,null,()=>{Object.assign(i,t.data),V.emit(o.emitter.OBJECT_LOADED,t.data)})}async function R(){r.value=!0;const t=await E.getLists(n.value);v.validateResponse(t,null,()=>{z.setLists(t.data)}),r.value=!1}return j(()=>n.value,()=>{R()}),(t,m)=>{const f=_("breadcrumb-item"),N=_("breadcrumb"),K=_("ctimeline"),P=_("page");return d(),c(P,{title:t._lang.backoffice.entities.detailPageTitle},{breadcrumb:I(()=>[b(N,{"has-home":!e(A)},{default:I(()=>[e(C)?(d(),c(f,{key:0,label:t._lang.backoffice.tasks.breadcrumbTitle,"router-path":e(o).router.BACKOFFICE_TASKS_PAGE.path},null,8,["label","router-path"])):e(A)?(d(),c(f,{key:1,label:t._lang.search.pageTitle,"router-path":e(o).router.BACKOFFICE_SEARCH_HISTORY_PAGE.path},null,8,["label","router-path"])):(d(),c(f,{key:2,label:t._lang.backoffice.entities.breadcrumbTitle,"router-path":e(o).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"])),b(f,{label:t._lang.backoffice.entities.detail},null,8,["label"])]),_:1},8,["has-home"])]),actions:I(()=>[b(x,{loading:e(r),"onUpdate:loading":m[0]||(m[0]=a=>h(r)?r.value=a:r=a),selectedLang:e(n),"onUpdate:selectedLang":m[1]||(m[1]=a=>h(n)?n.value=a:n=a),service:e(E),backRoute:e(o).router.BACKOFFICE_ENTITIES_PAGE.name,editRoute:e(o).router.BACKOFFICE_EDIT_ENTITY_PAGE.name,itemIdField:"organizationId",itemVersionField:"organizationVersion",itemId:l.value,itemVersion:u.value,formModel:e(i),"show-record-state-actions":e(C),store:e(z)},null,8,["loading","selectedLang","service","backRoute","editRoute","itemId","itemVersion","formModel","show-record-state-actions","store"])]),default:I(()=>[e(O)?(d(),c(K,{key:0,itemId:l.value,detailRoute:e(o).router.BACKOFFICE_DETAIL_ENTITY_PAGE.name,service:e(E),versionFieldName:"organizationVersion",dateFieldName:"organizationApprovedDate",detailRouteIdField:"organizationId",detailRouteVersionField:"organizationVersion",ref_key:"timeline",ref:g},null,8,["itemId","detailRoute","service"])):q("",!0),b(Q,{formModel:e(i),"onUpdate:formModel":m[2]||(m[2]=a=>h(i)?i.value=a:i=a),disabled:!0,validateForm:!0,selectedLang:e(n),rules:e(y),loading:e(r),organizationId:l.value,organizationVersion:u.value,"show-progress":!1,vuelidate:null,canCreate:k.value},null,8,["formModel","selectedLang","rules","loading","organizationId","organizationVersion","canCreate"])]),_:1},8,["title"])}}};export{Ee as default};
