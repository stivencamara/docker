import{g as G,f as K,i as D,h as H,r as s,j as w,v as m,k as C,P as U,N as j,u as _,C as r,w as q,l as I,c,m as p,n as b,q as E,s as e,L as F,A as Y}from"./index-bb041a92.js";import{o as T}from"./organization-e761b3c4.js";import{u as x}from"./organization-7396450f.js";import{o as L}from"./helpers-87024433.js";import{_ as J}from"./detail-actions-c770fa3b.js";import{_ as Q}from"./form-3539a0eb.js";import"./helpers-f0eb2667.js";import"./index.esm-70b2cee2.js";import"./extinct-confirm-9f6a5fd8.js";import"./refusal-4a9e82b8.js";import"./helpers-c3e2dc86.js";import"./helpers-b7ce43f3.js";import"./helpers-88e09779.js";import"./helpers-c77579e9.js";import"./helpers-b96ce24f.js";import"./settings-7b62b456.js";import"./contacts-d4beb946.js";import"./index.esm-aaed56ca.js";import"./location-ecefce01.js";import"./address-fd2f37e5.js";import"./generic-a6ce2963.js";import"./point-of-care-cea4a765.js";import"./service-05ba5811.js";import"./document-da1af287.js";const Te={__name:"detail",setup(W){const O=G(),g=K();D();const R=H(),z=x(),l=s(0),u=s(0);let i=s(!0),a=w(L.newForm()),n=s(m.language.pt);s([]);let V=w(L.formRules()),f=s(null);const h=C(()=>g.path.toLowerCase().indexOf("tarefas")>-1),A=C(()=>g.path.toLowerCase().indexOf("pesquisa")>-1),k=s(U.havePermission(m.permissions.organization.createEdit));j(async()=>{l.value=_.decodeId(g.params.organizationId),u.value=_.decodeId(g.params.organizationVersion),!l.value||!u.value?O.push({name:r.router.BACKOFFICE_ENTITIES_PAGE.name}):(await S(),await B(),y.value&&(await f.value.getHistory(),f.value.setActiveVersion(u.value),f.value.setStep()))});const y=C(()=>!h.value&&k.value&&(a.recordStateTypeId==m.recordStateType.published||a.recordStateTypeId==m.recordStateType.extinct||a.recordStateTypeId==m.recordStateType.obsolete));async function B(){const t=await T.getById(l.value,u.value);_.validateResponse(t,null,()=>{Object.assign(a,t.data),R.emit(r.emitter.OBJECT_LOADED,t.data)})}async function S(){i.value=!0;const t=await T.getLists(n.value);_.validateResponse(t,null,()=>{z.setLists(t.data)}),i.value=!1}return q(()=>n.value,()=>{S()}),(t,d)=>{const v=I("breadcrumb-item"),N=I("breadcrumb"),P=I("ctimeline"),M=I("page");return c(),p(M,{title:t._lang.backoffice.entities.detailPageTitle},{breadcrumb:b(()=>[E(N,{"has-home":!e(A)},{default:b(()=>[e(h)?(c(),p(v,{key:0,label:t._lang.backoffice.tasks.breadcrumbTitle,"router-path":e(r).router.BACKOFFICE_TASKS_PAGE.path},null,8,["label","router-path"])):e(A)?(c(),p(v,{key:1,label:t._lang.search.pageTitle,"router-path":e(r).router.HOME_PAGE.path},null,8,["label","router-path"])):(c(),p(v,{key:2,label:t._lang.backoffice.entities.breadcrumbTitle,"router-path":e(r).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"])),E(v,{label:t._lang.backoffice.entities.detail},null,8,["label"])]),_:1},8,["has-home"])]),actions:b(()=>[E(J,{loading:e(i),"onUpdate:loading":d[0]||(d[0]=o=>F(i)?i.value=o:i=o),selectedLang:e(n),"onUpdate:selectedLang":d[1]||(d[1]=o=>F(n)?n.value=o:n=o),service:e(T),backRoute:e(r).router.BACKOFFICE_ENTITIES_PAGE.name,editRoute:e(r).router.BACKOFFICE_EDIT_ENTITY_PAGE.name,itemIdField:"organizationId",itemVersionField:"organizationVersion",itemId:l.value,itemVersion:u.value,formModel:e(a),"show-record-state-actions":e(h),store:e(z)},null,8,["loading","selectedLang","service","backRoute","editRoute","itemId","itemVersion","formModel","show-record-state-actions","store"])]),default:b(()=>[e(y)?(c(),p(P,{key:0,itemId:l.value,detailRoute:e(r).router.BACKOFFICE_DETAIL_ENTITY_PAGE.name,service:e(T),versionFieldName:"organizationVersion",dateFieldName:"organizationApprovedDate",detailRouteIdField:"organizationId",detailRouteVersionField:"organizationVersion",ref_key:"timeline",ref:f},null,8,["itemId","detailRoute","service"])):Y("",!0),E(Q,{formModel:e(a),"onUpdate:formModel":d[2]||(d[2]=o=>F(a)?a.value=o:a=o),disabled:!0,validateForm:!0,selectedLang:e(n),rules:e(V),loading:e(i),organizationId:l.value,organizationVersion:u.value,"show-progress":!1,vuelidate:null,canCreate:k.value},null,8,["formModel","selectedLang","rules","loading","organizationId","organizationVersion","canCreate"])]),_:1},8,["title"])}}};export{Te as default};
