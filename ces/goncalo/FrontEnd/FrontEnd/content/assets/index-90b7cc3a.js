import{b as X,r as a,o as H,u as l,l as u,c as A,m as R,n as _,e as Y,F as J,z as de,s as e,d as be,L as oe,i as le,g as ne,j as ee,v as n,M as se,q as s,K,N as te,B as F,h as ue,a as ge,O as ce,A as ae,y as ye,x as _e}from"./index-34a71b79.js";import{_ as pe}from"./custom-label-d6947efd.js";import{b as re}from"./helpers-9519476b.js";import{p as ve}from"./point-of-care-7077d871.js";import{s as Ie}from"./service-75c7b1a4.js";import"./index.esm-e19cc10d.js";const M={cards:()=>X.get("/task/cards"),search:f=>X.post("/task/search",f),cardsAssociations:()=>X.get("/task/cards/associations"),searchAssociations:f=>X.post("/task/search/associations",f),getLists:(f,v=!0)=>{const k={lang:f,onlyPublishState:v};return X.post("/task/lists",k)}},Se={__name:"cards",props:{filter:{type:Function,required:!0},selected:{type:Object}},setup(f,{expose:v}){const k=f;let I=a(!0),c=a([]),r=a(null);H(async()=>{I.value=!0;const b=await M.cards();r.value=k.selected,l.validateResponse(b,null,()=>{c.value=b.data}),I.value=!1});const d=b=>{r.value=b,k.filter(b)};return v({clearSelection:()=>{r.value=null}}),(b,O)=>{const w=u("filter-card"),g=u("filter-cards");return A(),R(g,null,{default:_(()=>[(A(!0),Y(J,null,de(e(c),T=>(A(),R(w,{label:b._lang.enums.recordStateType[T.recordStateId],counter:T.total,active:T.recordStateId===e(r).recordStateId,loading:e(I),onClick:P=>d(T)},null,8,["label","counter","active","loading","onClick"]))),256))]),_:1})}}},ie=be("TasksStore",{state:()=>({stateTypeList:[],objectTypeList:[],organizationList:[],formToCompare:null}),getters:{getAll:f=>({stateTypeList:f.stateTypeList,objectTypeList:f.objectTypeList,organizationList:f.organizationList})},actions:{setLists(f){this.stateTypeList=f.stateTypeList,this.objectTypeList=f.objectTypeList,this.organizationList=f.organizationList},setFormToCompare(f){this.formToCompare=f}}}),Te={__name:"index",setup(f){const v=oe(),k=ie();le();const I=ne(),c=ee(L());let r=a(!1),d=a([]),S=a([]),b=a(n.tableSelectedState.none),O=a(l.createEmptyDataSource()),w=a([]),g=a([]),T=a([]),P=a([]),h=a(0),j=a({recordStateId:n.recordStateType.draft}),N=a(null);function L(){return{pageNumber:0,sortBy:"Name",objectTypeIds:[],organization:null,recordStateTypeIds:[n.recordStateType.published],name:null}}const Q=async t=>{c.sortBy=t,await B()},$=()=>{Object.assign(c,L())},q=async(t=!0)=>{N.value.clearSelection(),$(),t&&await D()},D=async()=>{await B()},B=async()=>{r.value=!0;const t=await M.search(c);l.validateResponse(t,null,()=>{O.value=t.data}),r.value=!1},W=async t=>{j.value=t,$();const p=g.value.find(E=>t.recordStateId===E.value);c.recordStateTypeIds.push(p.value),h.value++,await B()},i=async t=>{c.pageNumber=t,await B()};se(async()=>{r.value=!0;const t=await M.getLists(v.getLanguage);l.validateResponse(t,null,()=>{k.setLists(t.data),w.value=t.data.organizationList,g.value=t.data.stateTypeList,T.value=t.data.objectTypeList,P.value=l.concatItemsBadge(g.value,re.recordStateTypeBadgeOptions)}),r.value=!1}),H(async()=>{c.recordStateTypeIds.push(n.recordStateType.draft),await B()});function m(t){let p=null,E=null;switch(t.objectTypeId){case 2:p=F.router.BACKOFFICE_TASKS_DETAIL_ENTITY_PAGE.name,E={organizationId:l.encodeId(t.id.id),organizationVersion:l.encodeId(t.id.version)};break;case 3:p=F.router.BACKOFFICE_TASKS_DETAIL_SERVICE_PAGE.name,E={serviceId:l.encodeId(t.id.id),serviceVersion:l.encodeId(t.id.version)};break;case 4:p=F.router.BACKOFFICE_TASKS_DETAIL_POINT_OF_CARE_PAGE.name,E={pointOfCareId:l.encodeId(t.id.id),pointOfCareVersion:l.encodeId(t.id.version)};break;case 5:p=F.router.BACKOFFICE_TASKS_DETAIL_DOCUMENT_PAGE.name,E={documentId:l.encodeId(t.id.id),documentVersion:l.encodeId(t.id.version)};break;case 6:p=F.router.BACKOFFICE_DETAIL_LOCATION_PAGE.name,E={locationId:l.encodeId(t.id.id),locationVersion:l.encodeId(t.id.version)};break}I.push({name:p,params:E})}return(t,p)=>{const E=u("form-field"),U=u("row"),o=u("cfilter"),V=u("ccolumn"),G=u("table-action-detail"),y=u("ctable"),Z=u("container-wrapper");return A(),Y(J,null,[s(Se,{filter:W,ref_key:"cardsRef",ref:N,selected:e(j)},null,8,["selected"]),(A(),R(o,{title:t._lang.common.filter,disabled:e(r),"clear-click":q,"apply-click":D,loading:e(r),class:"mt-30",key:e(h)},{default:_(()=>[s(U,null,{default:_(()=>[s(E,{id:"name",class:"mb-3 col-12 col-md-6",modelValue:c.name,"onUpdate:modelValue":p[0]||(p[0]=C=>c.name=C),label:t._lang.label.name,type:e(n).inputs.text,maxlength:45,disabled:e(r)},null,8,["modelValue","label","type","disabled"]),s(E,{id:"objectTypeIds",class:"mb-3 col-12 col-md-6",modelValue:c.objectTypeIds,"onUpdate:modelValue":p[1]||(p[1]=C=>c.objectTypeIds=C),label:t._lang.label.objectTypeId,type:e(n).inputs.multiselect,options:e(T),disabled:e(r),mode:e(n).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"])]),_:1}),s(U,null,{default:_(()=>[s(E,{id:"organization",class:"mb-3 col-12",modelValue:c.organization,"onUpdate:modelValue":p[2]||(p[2]=C=>c.organization=C),label:t._lang.label.parentOrganization,type:e(n).inputs.multiselect,options:e(w),disabled:e(r),valueProp:e(n).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"])]),_:1})]),_:1},8,["title","disabled","loading"])),s(Z,null,{default:_(()=>[s(y,{onSort:Q,onChangePage:i,selectedItems:e(d),"onUpdate:selectedItems":p[3]||(p[3]=C=>K(d)?d.value=C:d=C),unselectedItems:e(S),"onUpdate:unselectedItems":p[4]||(p[4]=C=>K(S)?S.value=C:S=C),selectedState:e(b),"onUpdate:selectedState":p[5]||(p[5]=C=>K(b)?b.value=C:b=C),data:e(O),checkbox:!1,loading:e(r),defaultSort:"Name",checkboxField:"Name"},{columns:_(()=>[s(V,{name:t._lang.label.objectTypeId,field:"objectTypeId",align:e(n).columnAlign.center,custom:pe,options:e(T),sortable:!0},null,8,["name","align","options"]),s(V,{name:t._lang.label.name,field:"name",sortable:!0},null,8,["name"]),s(V,{name:t._lang.label.state,field:"recordStateTypeId",align:e(n).columnAlign.center,custom:te,options:e(P),sortable:!0},null,8,["name","align","options"])]),actions:_(C=>[s(G,{onClick:x=>m(C.item)},null,8,["onClick"])]),_:1},8,["selectedItems","unselectedItems","selectedState","data","loading"])]),_:1})],64)}}},Ce={__name:"cards",props:{filter:{type:Function,required:!0},selected:{type:Object}},setup(f,{expose:v}){const k=f,I=ue();let c=a(!0),r=a([]),d=a(null);H(async()=>{I.on(F.emitter.UPDATE_ASSOCIATION_CARD,async()=>{await O(),await w()}),d.value=k.selected,await O(),await w()}),ge(()=>{I.off(F.emitter.UPDATE_ASSOCIATION_CARD)});const S=g=>{d.value=g,k.filter(g)};v({clearSelection:()=>{d.value=null}});async function O(){c.value=!0;const g=await M.cards();l.validateResponse(g,null,()=>{r.value=g.data.filter(T=>T.recordStateId==n.recordStateType.approval).map(T=>({id:0,recordStateId:T.recordStateId,label:"Objectos",total:T.total}))}),c.value=!1}async function w(){c.value=!0;const g=await M.cardsAssociations();l.validateResponse(g,null,()=>{g.data.length>0&&g.data[0].recordStateId!=n.recordStateType.returned?r.value.push({id:1,recordStateId:n.recordStateType.draft,label:"Associações",total:g.data[0].total}):r.value.push({id:1,recordStateId:n.recordStateType.draft,label:"Associações",total:0})}),c.value=!1}return(g,T)=>{const P=u("filter-card"),h=u("filter-cards");return A(),R(h,{style:{"justify-content":"start !important"}},{default:_(()=>[(A(!0),Y(J,null,de(e(r),(j,N)=>(A(),R(P,{key:N,label:j.label,counter:j.total,active:j.recordStateId===e(d).recordStateId,loading:e(c),onClick:L=>S(j)},null,8,["label","counter","active","loading","onClick"]))),128))]),_:1})}}},Ae={__name:"objects",setup(f){const v=oe(),k=ie(),I=le(),c=ne(),r=ee(N());let d=a(!1),S=a([]),b=a([]),O=a(n.tableSelectedState.none),w=a(l.createEmptyDataSource()),g=a([]),T=a([]),P=a([]),h=a([]),j=a(0);a({recordStateId:n.recordStateType.draft});function N(){return{pageNumber:0,sortBy:"Name",objectTypeIds:[],organization:null,recordStateTypeIds:[n.recordStateType.approval],name:null}}const L=async i=>{r.sortBy=i,await D()},Q=()=>{Object.assign(r,N())},$=async(i=!0)=>{Q(),i&&await q()},q=async()=>{await D()},D=async()=>{d.value=!0;const i=await M.search(r);l.validateResponse(i,null,()=>{w.value=i.data}),d.value=!1},B=async i=>{r.pageNumber=i,await D()};se(async()=>{d.value=!0;const i=await M.getLists(v.getLanguage);l.validateResponse(i,null,()=>{k.setLists(i.data),g.value=i.data.organizationList,T.value=l.convertEnumToArray(I.enums.recordStateType),P.value=i.data.objectTypeList,h.value=l.concatItemsBadge(T.value,re.recordStateTypeBadgeOptions)}),d.value=!1}),H(async()=>{await D()});function W(i){let m=null,t=null;switch(i.objectTypeId){case 2:m=F.router.BACKOFFICE_TASKS_DETAIL_ENTITY_PAGE.name,t={organizationId:l.encodeId(i.id.id),organizationVersion:l.encodeId(i.id.version)};break;case 3:m=F.router.BACKOFFICE_TASKS_DETAIL_SERVICE_PAGE.name,t={serviceId:l.encodeId(i.id.id),serviceVersion:l.encodeId(i.id.version)};break;case 4:m=F.router.BACKOFFICE_TASKS_DETAIL_POINT_OF_CARE_PAGE.name,t={pointOfCareId:l.encodeId(i.id.id),pointOfCareVersion:l.encodeId(i.id.version)};break;case 5:m=F.router.BACKOFFICE_TASKS_DETAIL_DOCUMENT_PAGE.name,t={documentId:l.encodeId(i.id.id),documentVersion:l.encodeId(i.id.version)};break;case 6:m=F.router.BACKOFFICE_DETAIL_LOCATION_PAGE.name,t={locationId:l.encodeId(i.id.id),locationVersion:l.encodeId(i.id.version)};break}c.push({name:m,params:t})}return(i,m)=>{const t=u("form-field"),p=u("row"),E=u("cfilter"),U=u("ccolumn"),o=u("table-action-detail"),V=u("ctable"),G=u("container-wrapper");return A(),Y(J,null,[(A(),R(E,{title:i._lang.common.filter,disabled:e(d),"clear-click":$,"apply-click":q,loading:e(d),class:"mt-30",key:e(j)},{default:_(()=>[s(p,null,{default:_(()=>[s(t,{class:"mb-3 col-12 col-md-6",modelValue:r.name,"onUpdate:modelValue":m[0]||(m[0]=y=>r.name=y),label:i._lang.label.name,type:e(n).inputs.text,maxlength:45,disabled:e(d)},null,8,["modelValue","label","type","disabled"]),s(t,{class:"mb-3 col-12 col-md-6",modelValue:r.objectTypeIds,"onUpdate:modelValue":m[1]||(m[1]=y=>r.objectTypeIds=y),label:i._lang.label.objectTypeId,type:e(n).inputs.multiselect,options:e(P),disabled:e(d),mode:e(n).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"])]),_:1}),s(p,null,{default:_(()=>[s(t,{class:"mb-3 col-12 col-md-6",modelValue:r.organization,"onUpdate:modelValue":m[2]||(m[2]=y=>r.organization=y),label:i._lang.label.parentOrganization,type:e(n).inputs.multiselect,options:e(g),disabled:e(d),valueProp:e(n).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),s(t,{class:"mb-3 col-12 col-md-6",modelValue:r.recordStateTypeIds,"onUpdate:modelValue":m[3]||(m[3]=y=>r.recordStateTypeIds=y),label:i._lang.label.state,type:e(n).inputs.multiselect,options:e(T),disabled:e(d),mode:e(n).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"])]),_:1})]),_:1},8,["title","disabled","loading"])),s(G,null,{default:_(()=>[s(V,{onSort:L,onChangePage:B,selectedItems:e(S),"onUpdate:selectedItems":m[4]||(m[4]=y=>K(S)?S.value=y:S=y),unselectedItems:e(b),"onUpdate:unselectedItems":m[5]||(m[5]=y=>K(b)?b.value=y:b=y),selectedState:e(O),"onUpdate:selectedState":m[6]||(m[6]=y=>K(O)?O.value=y:O=y),data:e(w),checkbox:!1,loading:e(d),defaultSort:"Name",checkboxField:"Name"},{columns:_(()=>[s(U,{name:i._lang.label.objectTypeId,field:"objectTypeId",align:e(n).columnAlign.center,custom:pe,options:e(P),sortable:!0},null,8,["name","align","options"]),s(U,{name:i._lang.label.name,field:"name",sortable:!0},null,8,["name"]),s(U,{name:i._lang.label.state,field:"recordStateTypeId",align:e(n).columnAlign.center,custom:te,options:e(h),sortable:!0},null,8,["name","align","options"])]),actions:_(y=>[s(o,{onClick:Z=>W(y.item)},null,8,["onClick"])]),_:1},8,["selectedItems","unselectedItems","selectedState","data","loading"])]),_:1})],64)}}},ke={__name:"associations",setup(f){const v=oe(),k=ie(),I=le();ne();const c=ue(),r=ee(q()),d="confirm-verify";let S=a(!1),b=a([]),O=a([]),w=a(n.tableSelectedState.none),g=a(l.createEmptyDataSource()),T=a([]),P=a([]),h=a([]),j=a([]);a(0);let N=a(!1);a({recordStateId:n.recordStateType.draft});let L=ee({pointOfCareId:null,pointOfCareVersion:null,serviceId:null,serviceVersion:null,approve:null});const Q=a(ce.havePermission(n.permissions.service.approve)),$=a(ce.havePermission(n.permissions.pointOfCare.approve));function q(){return{pageNumber:0,sortBy:"ServiceName",objectTypeIds:[],organization:null,recordStateTypeIds:[n.recordStateType.approval,n.recordStateType.draft,n.recordStateType.submitted],name:null}}const D=async o=>{r.sortBy=o,await B()},B=async()=>{S.value=!0;const o=await M.searchAssociations(r);l.validateResponse(o,null,()=>{g.value=o.data}),S.value=!1},W=async o=>{r.pageNumber=o,await B()};se(async()=>{S.value=!0;const o=await M.getLists(v.getLanguage);l.validateResponse(o,null,()=>{k.setLists(o.data),T.value=o.data.organizationList,P.value=l.convertEnumToArray(I.enums.recordStateType),h.value=o.data.objectTypeList,j.value=l.concatItemsBadge(P.value,re.recordStateTypeBadgeOptions)}),S.value=!1}),H(async()=>{await B()});function i(o){L.pointOfCareId=o.pointOfCare.id,L.pointOfCareVersion=o.pointOfCare.version,L.serviceId=o.service.id,L.serviceVersion=o.service.version}function m(o){i(o),N.value=!0,l.showModalById(d)}function t(o){i(o),N.value=!1,l.showModalById(d)}async function p(){L.approve=!0,await U(),await B()}async function E(){L.approve=!1,await U(),await B()}async function U(){S.value=!0;let o;N.value?o=await Ie.associationApprove(L):o=await ve.associationApprove(L);let V=L.approve?I.common.associationApproveSucess:I.common.associationRefuseSucess;l.validateResponse(o,V,()=>{c.emit(F.emitter.UPDATE_ASSOCIATION_CARD)}),S.value=!1}return(o,V)=>{const G=u("ccolumn"),y=u("table-action-approve"),Z=u("ctable"),C=u("container-wrapper"),x=u("cbutton"),me=u("modal");return A(),Y(J,null,[s(C,{class:"mt-30"},{default:_(()=>[s(Z,{onSort:D,onChangePage:W,selectedItems:e(b),"onUpdate:selectedItems":V[0]||(V[0]=z=>K(b)?b.value=z:b=z),unselectedItems:e(O),"onUpdate:unselectedItems":V[1]||(V[1]=z=>K(O)?O.value=z:O=z),selectedState:e(w),"onUpdate:selectedState":V[2]||(V[2]=z=>K(w)?w.value=z:w=z),data:e(g),checkbox:!1,loading:e(S),defaultSort:"pointOfCareName",checkboxField:"Name"},{columns:_(()=>[s(G,{name:o._lang.label.pointOfCare,field:"pointOfCareName",sortable:!0},null,8,["name"]),s(G,{name:o._lang.label.state,field:"pointOfCareRecordStateTypeId",align:e(n).columnAlign.center,custom:te,options:e(j),sortable:!0},null,8,["name","align","options"]),s(G,{name:o._lang.label.service,field:"serviceName",sortable:!0},null,8,["name"]),s(G,{name:o._lang.label.state,field:"serviceRecordStateTypeId",align:e(n).columnAlign.center,custom:te,options:e(j),sortable:!0},null,8,["name","align","options"])]),actions:_(z=>[Q.value?(A(),R(y,{key:0,onClick:fe=>m(z.item),"data-bs-toggle":"tooltip","data-bs-title":o._lang.common.verifyServiço,"data-bs-placement":"top"},null,8,["onClick","data-bs-title"])):ae("",!0),$.value?(A(),R(y,{key:1,onClick:fe=>t(z.item),"data-bs-toggle":"tooltip","data-bs-title":o._lang.common.verifyPointOfCare,"data-bs-placement":"top"},null,8,["onClick","data-bs-title"])):ae("",!0)]),_:1},8,["selectedItems","unselectedItems","selectedState","data","loading"])]),_:1}),s(me,{id:d,size:e(n).modalSize.medium,title:o._lang.common.confirmation},{body:_(()=>[ye(_e(o._lang.common.associationModalTxt),1)]),footer:_(()=>[s(x,{title:o._lang.common.close,type:e(n).buttonType.secondary,"data-bs-dismiss":"modal","aria-label":"Close",disabled:!1},null,8,["title","type"]),s(x,{onClick:E,title:o._lang.common.refuse,disabled:!1,"data-bs-dismiss":"modal","aria-label":"Close"},null,8,["title"]),s(x,{onClick:p,title:o._lang.common.approve,disabled:!1,"data-bs-dismiss":"modal","aria-label":"Close"},null,8,["title"])]),_:1},8,["size","title"])],64)}}},Oe={__name:"index",setup(f){oe(),le(),ne();let v=a({recordStateId:n.recordStateType.approval,id:0});se(async()=>{}),H(async()=>{});const k=async I=>{v.value=I};return(I,c)=>(A(),Y(J,null,[s(Ce,{filter:k,ref:"cardsRef",selected:e(v)},null,8,["selected"]),e(v).id==0?(A(),R(Ae,{key:0})):ae("",!0),e(v).id==1?(A(),R(ke,{key:1})):ae("",!0)],64))}},Fe={__name:"index",setup(f){return(v,k)=>{const I=u("tab-content"),c=u("tabs"),r=u("page");return A(),R(r,{title:v._lang.backoffice.tasks.pageTitle},{default:_(()=>[s(c,null,{default:_(()=>[s(I,{id:"edicao",title:v._lang.backoffice.tasks.inEdition,active:!0,"always-refresh":!0},{default:_(()=>[s(Te)]),_:1},8,["title"]),s(I,{id:"aprovacao",title:v._lang.backoffice.tasks.toApprove,icon:e(n).tabIcons.plus,"always-refresh":!0},{default:_(()=>[s(Oe)]),_:1},8,["title","icon"])]),_:1})]),_:1},8,["title"])}}};export{Fe as default};
