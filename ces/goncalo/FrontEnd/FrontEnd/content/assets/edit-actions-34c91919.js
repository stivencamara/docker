import{_ as O}from"./cancel-confirm-e26bc141.js";import{K as T,g as D,i as F,r as E,G as N,o as H,j as C,u as n,k as i,c,e as $,n as s,l as p,p as o,I as V,y as g,s as l,F as G,R as K}from"./index-e6787e94.js";import{s as Q}from"./settings-8db6c4e1.js";const P={__name:"edit-actions",props:{loading:{Boolean,required:!0},selectedLang:{type:[String,Number],required:!1},formModel:{type:Object,required:!0},service:{type:Object,required:!0},itemId:{type:[String,Number],required:!0},vuelidate:{type:Object,required:!0},store:{type:Object,required:!0},resource:{type:Object},backRoute:{type:String,required:!0},showLangSelector:{Boolean,required:!0},canEdit:{type:Boolean,required:!0},canDelete:{type:Boolean,required:!0}},emits:["update:selectedLang","update:loading"],setup(L,{emit:f}){const e=L;T(async()=>{await w()});const r=D(),q=F(),y="confirm-cancel",b="confirm-delete";let v=E([]),k=N({});H(()=>{Object.assign(k,e.formModel)});const d=C({get(){return e.selectedLang},set(t){f("update:selectedLang",t)}}),a=C({get(){return e.loading},set(t){f("update:loading",t)}});async function w(){let t=await Q.getLanguages();n.validateResponse(t,null,()=>{v.value=t.data})}function R(){n.compareObjectIsDirty(e.store.formToCompare,e.formModel)?n.showModalById(y):r.push({name:e.backRoute})}function S(){r.push({name:e.backRoute})}async function B(){e.canDelete&&n.showModalById(b)}async function I(){if(e.canDelete){a.value=!0;const t=await e.service.delete(e.itemId);n.validateResponse(t,e.resource.deleted,()=>{r.push({name:e.backRoute})}),a.value=!1}}async function u(){if(e.canEdit){if(a.value=!0,e.formModel.validateForm=!0,await e.vuelidate.$validate(),e.vuelidate.$error)K.warning(q.common.requiredFields);else{let t=null;!e.itemId||e.itemId===-1?t=await e.service.create(e.formModel):t=await e.service.update(e.formModel),n.validateResponse(t,e.resource.saved,()=>{Object.assign(k,e.formModel),e.store.setFormToCompare(e.formModel),r.push({name:e.backRoute})})}a.value=!1}}return(t,_)=>{const M=i("Hotkeys"),h=i("lang-selector"),m=i("cbutton"),j=i("confirm-delete-modal");return c(),$(G,null,[s(M,{shortcuts:["S"],debug:!0,onTriggered:u}),e.showLangSelector?(c(),p(h,{key:0,options:o(v),selectedLang:o(d),"onUpdate:selectedLang":_[0]||(_[0]=z=>V(d)?d.value=z:null),disabled:o(a)},null,8,["options","selectedLang","disabled"])):g("",!0),s(m,{class:"col-12 col-sm-auto",type:o(l).buttonType.secondary,size:o(l).buttonSize.large,title:t._lang.common.cancel,onClick:R,disabled:o(a)},null,8,["type","size","title","disabled"]),e.canDelete?(c(),p(m,{key:1,class:"col-12 col-sm-auto",type:o(l).buttonType.secondary,size:o(l).buttonSize.large,title:t._lang.common.delete,onClick:B,disabled:o(a)},null,8,["type","size","title","disabled"])):g("",!0),e.canEdit?(c(),p(m,{key:2,class:"col-12 col-sm-auto",title:t._lang.common.save,type:o(l).buttonType.primary,size:o(l).buttonSize.large,onClick:u,disabled:o(a)},null,8,["title","type","size","disabled"])):g("",!0),s(O,{id:y,title:t._lang.common.cancel,action:S},null,8,["title"]),s(j,{id:b,title:t._lang.common.deleteTitle,message:t._lang.common.deleteQuestion,action:I},null,8,["title","message"]),s(M,{shortcuts:["S"],debug:!0,onTriggered:u})],64)}}};export{P as _};
