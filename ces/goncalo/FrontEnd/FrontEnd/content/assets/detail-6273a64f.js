import{_ as K}from"./general-bd6e49da.js";import{g as U,f as H,i as j,h as z,r as l,G as V,s as E,j as F,N as Y,K as q,u as v,z as n,M as x,k as m,c as b,l as I,w as c,n as p,p as e,I as h,y as J}from"./index-e6787e94.js";import{d as f}from"./document-7d8e49bb.js";import{d as L}from"./helpers-ee63bdf4.js";import{u as Q}from"./document-be6216ed.js";import"./helpers-1692af0f.js";import{_ as W}from"./detail-actions-d1bf1f45.js";import"./index.esm-cb55abbd.js";import"./refusal-82cd23d2.js";import"./index.esm-7850210a.js";import"./generic-25679898.js";import"./helpers-3e986238.js";import"./helpers-3c2faf50.js";import"./helpers-8a70ee11.js";import"./helpers-b39b0e24.js";import"./helpers-30a39e68.js";import"./settings-8db6c4e1.js";const _e={__name:"detail",setup(X){const k=U(),_=H();j();const y=z(),O=Q();let a=l(!0),r=V(L.newForm()),s=l(E.language.pt),B=V(L.formRules()),u=l(0),d=l(0),g=l(null);const T=F(()=>_.path.toLowerCase().indexOf("tarefas")>-1),A=F(()=>_.path.toLowerCase().indexOf("pesquisa")>-1);async function D(){a.value=!0;const t=await f.getById(u.value,d.value);v.validateResponse(t,null,()=>{Object.assign(r,t.data),y.emit(n.emitter.OBJECT_LOADED,t.data)}),a.value=!1}async function R(){a.value=!0;const t=await f.getLists(s.value,d.value);v.validateResponse(t,null,()=>{O.setLists(t.data)}),a.value=!1}Y(()=>s.value,()=>{R()}),q(async()=>{u.value=v.decodeId(_.params.documentId),d.value=v.decodeId(_.params.documentVersion),!u.value||!d.value?k.push({name:n.router.BACKOFFICE_DOCUMENT_PAGE.name}):(await R(),await D(),w.value&&(await g.value.getHistory(),g.value.setActiveVersion(f.value),g.value.setStep()))});const N=l(x.havePermission(E.permissions.organization.createEdit)),w=F(()=>!T.value&&N.value&&r.recordStateTypeId!=E.recordStateType.draft);return(t,i)=>{const C=m("breadcrumb-item"),M=m("breadcrumb"),P=m("ctimeline"),S=m("card"),G=m("page");return b(),I(G,{title:t._lang.backoffice.document.detailPageTitle},{breadcrumb:c(()=>[p(M,{"has-home":!e(A)},{default:c(()=>[e(A)?(b(),I(C,{key:0,label:t._lang.search.pageTitle,"router-path":e(n).router.BACKOFFICE_SEARCH_HISTORY_PAGE.path},null,8,["label","router-path"])):(b(),I(C,{key:1,label:t._lang.backoffice.document.breadcrumbTitle,"router-path":e(n).router.BACKOFFICE_DOCUMENT_PAGE.path},null,8,["label","router-path"])),p(C,{label:t._lang.backoffice.document.detailPageTitle},null,8,["label"])]),_:1},8,["has-home"])]),actions:c(()=>[p(W,{loading:e(a),"onUpdate:loading":i[0]||(i[0]=o=>h(a)?a.value=o:a=o),selectedLang:e(s),"onUpdate:selectedLang":i[1]||(i[1]=o=>h(s)?s.value=o:s=o),service:e(f),backRoute:e(n).router.BACKOFFICE_DOCUMENT_PAGE.name,editRoute:e(n).router.BACKOFFICE_EDIT_DOCUMENT_PAGE.name,itemIdField:"documentId",itemVersionField:"documentVersion",itemId:e(u),itemVersion:e(d),formModel:e(r),"show-record-state-actions":e(T),store:e(O)},null,8,["loading","selectedLang","service","backRoute","editRoute","itemId","itemVersion","formModel","show-record-state-actions","store"])]),default:c(()=>[e(w)?(b(),I(P,{key:0,itemId:e(u),detailRoute:e(n).router.BACKOFFICE_DETAIL_ENTITY_PAGE.name,service:e(f),versionFieldName:"documentVersion",dateFieldName:"documentApprovedDate",detailRouteIdField:"documentId",detailRouteVersionField:"documentVersion",ref_key:"timeline",ref:g},null,8,["itemId","detailRoute","service"])):J("",!0),p(S,{shadow:!0},{body:c(()=>[p(K,{modelValue:e(r),"onUpdate:modelValue":i[2]||(i[2]=o=>h(r)?r.value=o:r=o),disabled:!0,loading:e(a),selectedLang:e(s),validateForm:!0,rules:e(B)},null,8,["modelValue","loading","selectedLang","rules"])]),_:1})]),_:1},8,["title"])}}};export{_e as default};
