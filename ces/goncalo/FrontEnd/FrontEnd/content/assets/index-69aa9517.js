import{d as G,_ as H,K as j,a1 as J,h as x,r as _,u as T,k as n,c as d,e as g,m as t,p as e,F as C,n as s,w as r,t as K,v as S,l as B,y as O,ad as P,x as E,G as $,A as Q,B as W,i as X,a as Y,j as Z,H as N,s as h}from"./index-17cd38fc.js";import{i as V}from"./import-1fc82cbf.js";const U=G("ImportStore",{state:()=>({importCodeList:[]}),getters:{},actions:{addImportCode(i){this.importCodeList.push(i)},revomeImportCodeById(i){const m=this.importCodeList.findIndex(v=>v.code===i);return m>-1?(this.importCodeList.splice(m,1),!0):!1},resetList(){this.importCodeList=[]}},persist:{enabled:!0,strategies:[{key:"params-import",storage:localStorage,paths:["importCodeList"]}]}});const z=i=>(Q("data-v-836b8454"),i=i(),W(),i),ee=z(()=>t("span",{class:"label placeholder"},null,-1)),te=z(()=>t("span",{class:"counter placeholder"},null,-1)),ae={key:1},oe={class:"label col-9"},se={class:"col-3 card-date"},le={class:"progress"},ne=["aria-valuenow"],re={class:"table table-container"},ie=z(()=>t("thead",{class:"table-head"},[t("tr",null,[t("th",{class:"table-head-column"},"Descrição")])],-1)),ce={class:"table-body"},de={__name:"import-card",props:{item:{type:Object,required:!0},loading:{type:Boolean,default:!1}},setup(i){const m=i;j(async()=>{await I(),w=window.setInterval(async()=>{a.value<100&&await I()},4e3)}),J(()=>{window.clearInterval(w)});const v=U();x();var p=_(!1),a=_(0),o=_([]),w;async function I(){p.value=!0;const y=await V.get(m.item.code);T.validateResponse(y,null,()=>{try{const b=JSON.parse(y.data);console.log(b),a.value=b.Status,o.value=b.Errors}catch{v.revomeImportCodeById(m.item.code)}}),p.value=!1}return(y,b)=>{const c=n("icon-danger"),l=n("row"),u=n("accordion");return d(),g(C,null,[t("div",{class:$(["mb-3 row home-card placeholder-glow",{active:!1}])},[e(p)?(d(),g(C,{key:0},[ee,te],64)):(d(),g("div",ae,[s(l,{class:""},{default:r(()=>[t("h6",oe,[K(S(m.item.name)+" ",1),e(o).length>0?(d(),B(c,{key:0,class:"p-hand"})):O("",!0)]),t("div",se,S(e(T).formatDate(m.item.date,"DD/MM/yyyy hh:mm")),1)]),_:1}),s(l,{class:"mb-3"},{default:r(()=>[t("div",le,[t("div",{class:"progress-bar bg-success",role:"progressbar",style:P({width:e(a)+"%"}),"aria-valuenow":e(a),"aria-valuemin":"0","aria-valuemax":"100"},S(e(a))+"% ",13,ne)])]),_:1}),s(u,{id:"errors",title:y._lang.common.errors,collapsed:!1,class:"mb-4 bg-transparent"},{default:r(()=>[s(l,null,{default:r(()=>[t("table",re,[ie,t("tbody",ce,[(d(!0),g(C,null,E(e(o),(L,k)=>(d(),g("tr",{key:k},[t("td",null,[t("span",null,S(L),1)])]))),128))])])]),_:1})]),_:1},8,["title"])]))]),e(p)?O("",!0):(d(),g(C,{key:0},[],64))],64)}}},me=H(de,[["__scopeId","data-v-836b8454"]]),pe={class:"col-12 hstack gap-2 mt-3"},ue={class:"mb-3 gap-5",cards:""},fe={__name:"index",setup(i){const m=X(),v=U();x();var p=_(!1),a=_(null),o=_(null),w=_([]);_([]),j(()=>{w.value=T.convertEnumToArray(m.enums.importType)}),Y(()=>{});const I=Z(()=>v.importCodeList);function y(){o.value=null,a.value=null}async function b(c){p.value=!0;let l={data:o.value.data,name:o.value.name},u=null;switch(a.value){case h.importType.organization:u=await V.organization(l);break;case h.importType.pointOfCare:u=await V.pointOfCare(l);break}T.validateResponse(u,"Importação iniciada",()=>{v.addImportCode({name:o.value.name,code:u.data,date:new Date}),y()}),p.value=!1}return(c,l)=>{const u=n("breadcrumb-item"),L=n("breadcrumb"),k=n("form-field"),D=n("row"),F=n("cbutton"),M=n("accordion"),R=n("card"),q=n("page");return d(),B(q,{title:c._lang.backoffice.settings.import.pageTitle},{breadcrumb:r(()=>[s(L,{"has-home":!0},{default:r(()=>[s(u,{label:c._lang.backoffice.settings.import.pageTitle},null,8,["label"])]),_:1})]),default:r(()=>[s(R,{shadow:!0},{body:r(()=>[s(M,{id:"newImport",title:c._lang.common.newImport,collapsed:!1,class:"mb-4"},{default:r(()=>[s(D,null,{default:r(()=>[s(k,{id:"importType",class:"mb-3 col-12 col-lg-4",modelValue:e(a),"onUpdate:modelValue":l[0]||(l[0]=f=>N(a)?a.value=f:a=f),label:c._lang.label.objectType,loading:e(p),type:e(h).inputs.multiselect,placeholder:c._lang.common.selectOption,options:e(w)},null,8,["modelValue","label","loading","type","placeholder","options"]),s(k,{id:"document",class:"mb-3 col-12 col-lg-8",modelValue:e(o),"onUpdate:modelValue":l[1]||(l[1]=f=>N(o)?o.value=f:o=f),label:c._lang.label.document,loading:e(p),type:e(h).inputs.file,required:!0},null,8,["modelValue","label","loading","type"])]),_:1}),s(D,null,{default:r(()=>[t("div",pe,[s(F,{class:"ms-auto",type:e(h).buttonType.primary,title:c._lang.common.import,onClick:b,size:e(h).buttonSize.medium,disabled:e(a)==null||e(o)==null},null,8,["type","title","size","disabled"])])]),_:1})]),_:1},8,["title"]),t("div",ue,[(d(!0),g(C,null,E(e(I),(f,A)=>(d(),B(me,{key:A,item:f},null,8,["item"]))),128))])]),_:1})]),_:1},8,["title"])}}};export{fe as default};
