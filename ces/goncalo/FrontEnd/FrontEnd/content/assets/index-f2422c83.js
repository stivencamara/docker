import{b as Q,d as W,u as p,r as v,o as j,a as X,c as m,e as I,_ as Z,f as ee,g as ae,h as te,i as se,j as D,k as A,l as R,w as g,m as t,n as i,p as a,q as oe,s as C,t as y,v as c,F as w,x as le,y as E,z as T,A as ne,B as re}from"./index-074485c3.js";const ce={search:o=>Q.post("/es/search",o)},ie=W("SearchStore",{state:()=>({objectTypes:[],organizationParents:[],items:[],filterModel:p.createFilterModel(),pageCount:0,page:0}),getters:{},actions:{setObjectTypes(o){this.objectTypes=[];for(let _ in o)this.objectTypes.some(f=>f.value===o[_].index)||this.objectTypes.push({value:o[_].index,label:o[_].title})},setOrganizationParents(o){this.organizationParents=[];for(let _ in o)this.organizationParents.some(f=>f.value===o[_].organizationParent)||this.organizationParents.push({value:o[_].organizationParent,label:o[_].organizationParent})},setFilterModel(o){this.filterModel=o},setItems(o){this.items=o},setPageCount(o){this.pageCount=o},setPage(o){this.page=o}}}),de={__name:"observer",props:{options:Object},emits:["intersect"],setup(o,{emit:_}){const f=o,r=v(null),V=v(null);return j(()=>{const P=f.options||{};r.value=new IntersectionObserver(([h])=>{h&&h.isIntersecting&&_("intersect")},P),r.value.observe(V.value)}),X(()=>{r.value.disconnect()}),(P,h)=>(m(),I("div",{class:"observer",ref_key:"observerRef",ref:V},null,512))}};const d=o=>(ne("data-v-93b4251d"),o=o(),re(),o),ue={class:"image-back-home pt-3"},pe=d(()=>t("div",{class:"col-1 col-sm-1"},null,-1)),_e=d(()=>t("div",{class:"col-10 col-sm-10"},[t("h1",null,"Bem-vindo")],-1)),ve=d(()=>t("div",{class:"col-1 col-sm-1"},null,-1)),me=d(()=>t("div",{class:"col-1 col-sm-1"},null,-1)),he={class:"col-10 col-sm-10"},ge=d(()=>t("div",{class:"col-1 col-sm-1"},null,-1)),be=d(()=>t("div",{class:"col-1 col-sm-1"},null,-1)),fe={class:"col-10 col-sm-10 search-btn"},ye=d(()=>t("div",{class:"col-1 col-sm-1"},null,-1)),Ie=d(()=>t("div",{class:"col-1"},null,-1)),Ce={class:"col-10"},Pe=["innerHTML"],ke={class:"mt-3"},Ee=["onClick"],Ae={class:"title"},Ve={class:"description"},ze={key:0,class:"f-14"},Te=d(()=>t("br",null,null,-1)),Fe=d(()=>t("br",null,null,-1)),Se={key:0,class:"f-14"},Me=d(()=>t("br",null,null,-1)),Oe=d(()=>t("br",null,null,-1)),we=d(()=>t("br",null,null,-1)),Re={class:"date"},xe=d(()=>t("hr",{class:"rounded"},null,-1)),Le=["innerHTML"],Be=d(()=>t("div",{class:"col-1"},null,-1)),Ne={__name:"search",setup(o){const _=ee(),f=ae(),r=ie();te();const V=se();let P=v(!1),h=v(!1),F=v(!1),M=v(!1),n=v(p.createFilterModel()),k=v(0),S=v(999),b=v([]),x=v(0);const H=D(()=>V.common.emptyResult.replace("{0}",`<strong>${n.value.query}</strong>`)),q=D(()=>V.common.totalRecords.replace("{0}",`<strong>${x.value}</strong>`)),O=async()=>{F.value=!1,n.value.query&&(k.value=0,r.setFilterModel(n.value),b.value=[],await L(),P.value=!0,h.value=!1,F.value=!1)},L=async()=>{M.value=!0,n.value.pageNumber=k.value;let s=await ce.search(n.value);if(s.code!==0){await B();return}p.validateResponse(s,null,()=>{b.value.push(...U(s.data.items)),k.value++,x.value=s.data.total,S.value=Math.ceil(s.data.total/n.value.pageSize),r.setObjectTypes(b.value),r.setOrganizationParents(b.value),r.setItems(b.value),r.setPageCount(S.value),r.setPage(k.value),M.value=!1})};j(()=>{h.value=!0,F.value=!1,_.hash==="#history"&&r.filterModel.query&&(b.value.push(...r.items),k.value=r.page,S.value=r.pageCount,n.value=r.filterModel,P.value=!0,F.value=!0,h.value=!1)});const B=async()=>{n.value.pageNumber=0,n.value.name=null,n.value.abreviation=null,n.value.organizationParents=null,n.value.index=null,await N()},N=async()=>{n.value.pageNumber=0,await O()};function K(s){let e="",u={};switch(s.index){case"organization":e=T.router.BACKOFFICE_SEARCH_DETAIL_ENTITY_PAGE.name,u={organizationId:p.encodeId(s.id),organizationVersion:p.encodeId(s.version)};break;case"pointofcare":e=T.router.BACKOFFICE_SEARCH_DETAIL_POINT_OF_CARE_PAGE.name,u={pointOfCareId:p.encodeId(s.id),pointOfCareVersion:p.encodeId(s.version)};break;case"service":e=T.router.BACKOFFICE_SEARCH_DETAIL_SERVICE_PAGE.name,u={serviceId:p.encodeId(s.id),serviceVersion:p.encodeId(s.version)};break;case"location":e=T.router.BACKOFFICE_SEARCH_DETAIL_LOCATION_PAGE.name,u={locationId:p.encodeId(s.id),locationVersion:p.encodeId(s.version)};break;case"document":e=T.router.BACKOFFICE_SEARCH_DETAIL_DOCUMENT_PAGE.name,u={documentId:p.encodeId(s.id),documentVersion:p.encodeId(s.version)};break}f.push({name:e,params:u})}function U(s){return s.map(e=>({id:e.id,version:e.version,title:e.pt.type,name:e.pt.name,organizationParent:e.organizationParent,address:e.address,date:p.formatDate(e.startDate),index:e.index,economicActivity:e.economicActivity,category:e.category,type:e.type}))}async function G(){k.value<S.value&&await L()}return(s,e)=>{const u=A("row"),z=A("form-field"),$=A("icon-search"),Y=A("cfilter"),J=A("card");return m(),R(J,{shadow:!0,class:"card-home"},{body:g(()=>[t("div",ue,[i(u,null,{default:g(()=>[pe,_e,ve]),_:1}),i(u,{class:"mt-5"},{default:g(()=>[me,t("div",he,[i(z,{id:"query",label:"Pesquisar",modelValue:a(n).query,"onUpdate:modelValue":e[0]||(e[0]=l=>a(n).query=l),placeholder:s._lang.backoffice.home.placeholderSearch,onKeyup:oe(O,["enter"]),type:a(C).inputs.search},null,8,["modelValue","placeholder","onKeyup","type"])]),ge]),_:1}),i(u,{class:"mt-2 pb-3"},{default:g(()=>[be,t("div",fe,[t("button",{class:"btn btn-primary",type:"button",onClick:O},[i($,{color:"#FFF"}),y(" "+c(s._lang.common.search),1)])]),ye]),_:1})]),a(P)?(m(),R(u,{key:0},{default:g(()=>[Ie,t("div",Ce,[a(b).length?(m(),I(w,{key:0},[i(u,null,{default:g(()=>[t("div",{class:"mt-3",innerHTML:a(q)},null,8,Pe)]),_:1}),i(Y,{class:"mt-4",title:s._lang.common.filter,"clear-click":B,"apply-click":N,loading:a(h),"disable-margin":!0},{default:g(()=>[i(u,null,{default:g(()=>[i(z,{id:"abreviation",class:"mb-3 col-12 col-md-6",label:s._lang.label.abreviation,type:a(C).inputs.text,maxlength:45,modelValue:a(n).abreviation,"onUpdate:modelValue":e[1]||(e[1]=l=>a(n).abreviation=l)},null,8,["label","type","modelValue"]),i(z,{id:"types",class:"mb-3 col-12 col-md-6",modelValue:a(n).index,"onUpdate:modelValue":e[2]||(e[2]=l=>a(n).index=l),label:s._lang.label.type,loading:a(h),type:a(C).inputs.multiselect,mode:a(C).multiselectMode.tags,options:a(r).objectTypes},null,8,["modelValue","label","loading","type","mode","options"])]),_:1}),i(u,null,{default:g(()=>[i(z,{id:"name",class:"mb-3 col-12 col-md-6",label:s._lang.label.name,type:a(C).inputs.text,maxlength:45,modelValue:a(n).name,"onUpdate:modelValue":e[3]||(e[3]=l=>a(n).name=l)},null,8,["label","type","modelValue"]),i(z,{id:"organizationParents",class:"mb-3 col-12 col-md-6",modelValue:a(n).organizationParents,"onUpdate:modelValue":e[4]||(e[4]=l=>a(n).organizationParents=l),label:s._lang.label.parentOrganization,loading:a(h),type:a(C).inputs.multiselect,mode:a(C).multiselectMode.tags,options:a(r).organizationParents},null,8,["modelValue","label","loading","type","mode","options"])]),_:1})]),_:1},8,["title","loading"]),t("div",ke,[t("ul",null,[(m(!0),I(w,null,le(a(b),l=>(m(),I("li",{class:"infinite-scroll-item p-hand",onClick:je=>K(l)},[t("h4",Ae,c(l.title),1),t("p",Ve,[t("i",null,c(l.organizationParent),1),y(", "),t("strong",null,c(l.name),1)]),l.address?(m(),I("p",ze,[y(c(l.address.zipCode)+" - "+c(l.address.island)+" ",1),Te,y(" "+c(l.address.county)+", "+c(l.address.parish)+", "+c(l.address.location)+" ",1),Fe,y(" "+c(l.address.address),1)])):E("",!0),l.index==="service"?(m(),I(w,{key:1},[l.category?(m(),I("p",Se,[y(c(l.type)+" ",1),Me,y(" "+c(l.category)+" ",1),Oe,y(" "+c(l.economicActivity)+" ",1),we])):E("",!0)],64)):E("",!0),t("p",Re,c(s._lang.label.startDate)+": "+c(l.date),1),xe],8,Ee))),256))]),i(de,{onIntersect:G})])],64)):E("",!0),!a(b).length&&!a(M)?(m(),I("div",{key:1,class:"mt-4",innerHTML:a(H)},null,8,Le)):E("",!0)]),Be]),_:1})):E("",!0)]),_:1})}}},De=Z(Ne,[["__scopeId","data-v-93b4251d"]]),qe={__name:"index",setup(o){return(_,f)=>{const r=A("page");return m(),R(r,{title:_._lang.backoffice.home.pageTitle},{default:g(()=>[i(De)]),_:1},8,["title"])}}};export{qe as default};
