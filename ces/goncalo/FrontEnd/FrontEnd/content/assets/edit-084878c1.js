import{g as A,f as B,i as P,H as g,r as i,N as v,t as E,L as U,u as m,A as p,k as d,c as N,l as O,m as l,p as r,q as e,J as S}from"./index-61b82425.js";import{u as I}from"./users-adbd7db8.js";import{h as V,p as y}from"./form-2d047af5.js";import{u as M}from"./index.esm-907a0be9.js";import"./helpers-6dcc39e2.js";import{u as D}from"./users-7abbc7e2.js";import{_ as K}from"./edit-actions-95bdab4c.js";import"./index.esm-8d490d0e.js";import"./cancel-confirm-ad6df65a.js";import"./settings-85dcc88f.js";const $={__name:"edit",setup(L){const k=A(),h=B();P();const T=g(V.formRulesEdit()),f=D(),C=i(v.havePermission(E.permissions.users.delete));let t=i(!1),n=i(0),a=g({name:null,email:null,profiles:[],active:!0,blocked:!1,deleted:!1}),c=i(!1);const _=M(T,a);U(async()=>{n.value=m.decodeId(h.params.userId),n.value?(await G(),c.value=v.havePermission(E.permissions.users.createEdit)&&!a.blocked&&!a.deleted):k.push({name:p.router.BACKOFFICE_SETTINGS_USERS_PAGE.name})});async function G(){t.value=!0;const s=await I.getById(n.value);m.validateResponse(s,null,()=>{Object.assign(a,s.data),f.setFormToCompare(m.cloneObject(s.data))}),t.value=!1}return(s,u)=>{const b=d("breadcrumb-item"),F=d("breadcrumb"),R=d("card"),w=d("page");return N(),O(w,{title:s._lang.backoffice.settings.users.update.pageTitle},{breadcrumb:l(()=>[r(F,{"has-home":!0},{default:l(()=>[r(b,{label:s._lang.backoffice.settings.users.pageTitle,"router-path":e(p).router.BACKOFFICE_SETTINGS_USERS_PAGE.path},null,8,["label","router-path"]),r(b,{label:s._lang.backoffice.settings.users.update.pageTitle},null,8,["label"])]),_:1})]),actions:l(()=>[r(K,{loading:e(t),"onUpdate:loading":u[0]||(u[0]=o=>S(t)?t.value=o:t=o),service:e(I),itemId:e(n),formModel:e(a),vuelidate:e(_),store:e(f),resource:s._lang.backoffice.settings.users,"back-route":e(p).router.BACKOFFICE_SETTINGS_USERS_PAGE.name,showLangSelector:!1,canEdit:e(c),canDelete:C.value,canGeneratePassword:!e(a).isGraUser},null,8,["loading","service","itemId","formModel","vuelidate","store","resource","back-route","canEdit","canDelete","canGeneratePassword"])]),default:l(()=>[r(R,{shadow:!0},{body:l(()=>[r(y,{modelValue:e(a),"onUpdate:modelValue":u[1]||(u[1]=o=>S(a)?a.value=o:a=o),required:!0,vuelidator:e(_),disabled:!e(c)},null,8,["modelValue","vuelidator","disabled"])]),_:1})]),_:1},8,["title"])}}};export{$ as default};
