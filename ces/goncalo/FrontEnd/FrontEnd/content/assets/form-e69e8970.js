import{u as ue}from"./index.esm-915ef6e7.js";import{_ as ce,a as me,b as pe}from"./contacts-4c36bf94.js";import{_ as ge,a as fe}from"./address.vue_vue_type_style_index_0_scoped_5480b292_lang-71817340.js";import{k as O,l as p,c as I,m as N,n as C,q as t,s as e,J as B,v as m,_ as be,u as _,r as f,w as ve,e as H,p as Y,O as ye,Q as _e,F as le,i as ne,K as Ve,j as ee,L as de,o as se,M as ie,N as oe,G as Ce,f as Se,g as Oe,y as Ie,x as Te,A as z}from"./index-eb4a79b4.js";import{b as F}from"./helpers-e0a01141.js";import{u as Le}from"./organization-87bf1cf4.js";import{u as re}from"./point-of-care-e3d3a08e.js";import{_ as ke}from"./address-95da173a.js";import{_ as Be,a as Fe}from"./refusal-2a11281c.js";import{r as we}from"./index.esm-da6c7db5.js";import{_ as Ne}from"./generic-59257ec0.js";import{p as ae}from"./point-of-care-c416b4c8.js";import{s as Z}from"./service-4946a613.js";import{u as Ae}from"./service-7df5d2dd.js";import{s as Ee}from"./helpers-6ac59ace.js";const qe={__name:"description",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},selectedLang:{type:[String,Number],required:!0},validateForm:{type:Boolean,default:!1},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(b,{emit:d}){const n=b;Le();const i=O({get(){return n.modelValue},set(l){d("update:modelValue",l)}}),a=O(()=>n.selectedLang),g=O({get(){return F.getFieldByLangAndName(i.value,a.value,"description")},set(l){F.setFieldByLangAndName(i.value,a.value,"description",l)}}),v=O({get(){return F.getFieldByLangAndName(i.value,a.value,"preConditions")},set(l){F.setFieldByLangAndName(i.value,a.value,"preConditions",l)}});return O({get(){return F.getFieldByLangAndName(i.value,a.value,"keywords")},set(l){F.setFieldByLangAndName(i.value,a.value,"keywords",l)}}),(l,o)=>{const r=p("form-field"),k=p("accordion");return I(),N(k,{id:"description",title:l._lang.common.description,collapsed:!1,class:"mb-4"},{default:C(()=>[t(r,{id:"description",class:"mb-3 col-12",modelValue:e(g),"onUpdate:modelValue":o[0]||(o[0]=s=>B(g)?g.value=s:null),label:l._lang.label.description,disabled:n.disabled,loading:n.loading,type:e(m).inputs.text,maxlength:255,language:e(a)},null,8,["modelValue","label","disabled","loading","type","language"]),t(r,{id:"preConditions",class:"mb-3 col-12",modelValue:e(v),"onUpdate:modelValue":o[1]||(o[1]=s=>B(v)?v.value=s:null),label:l._lang.label.preConditions,disabled:n.disabled,loading:n.loading,type:e(m).inputs.text,maxlength:255,language:e(a)},null,8,["modelValue","label","disabled","loading","type","language"])]),_:1},8,["title"])}}},Me={class:"input-group mb-3"},Re=["aria-describedby"],Ue=["id","disabled"],he={__name:"address",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},validateForm:{type:Boolean,default:!1},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(b,{emit:d}){const n=b,i=re(),a=_.uuid();let g=f(0),v=f(0);const l=f(!1);f(!1);const o=O({get(){return n.modelValue},set(S){d("update:modelValue",S)}}),r="search-location";function k(S){Object.assign(o.value.address,S),g.value++}function s(){v.value++,window.setTimeout(function(){_.showModalById(r)},5)}return ve(o.value,S=>{S.address.locationId!=null&&(l.value?(S.address.locationId=null,S.address.code=null,l.value=!1):l.value=!0)}),(S,L)=>{const E=p("icon-search"),T=p("accordion");return I(),H(le,null,[t(T,{id:"address-accordion",title:S._lang.backoffice.entities.address,collapsed:!1,class:"mb-4"},{default:C(()=>[Y("div",Me,[ye(Y("input",{ref:"locationQuery",id:"location-query",type:"text",class:"form-control",placeholder:"Código do património","aria-label":"placeholder","aria-describedby":e(a),disabled:"","onUpdate:modelValue":L[0]||(L[0]=w=>e(o).address.code=w)},null,8,Re),[[_e,e(o).address.code]]),Y("button",{class:"btn btn-primary",type:"button",id:e(a),disabled:n.disabled,onClick:s},[t(E,{color:"#FFF"})],8,Ue)]),(I(),N(ke,{key:e(g),modelValue:e(o).address,"onUpdate:modelValue":L[1]||(L[1]=w=>e(o).address=w),disabled:n.disabled,rules:n.rules,loading:n.loading,"validate-form":n.validateForm&&e(o).address.isRequired,store:e(i),vuelidate:n.vuelidate},null,8,["modelValue","disabled","rules","loading","validate-form","store","vuelidate"]))]),_:1},8,["title"]),(I(),N(ce,{key:e(v),onApply:k}))],64)}}},je=be(he,[["__scopeId","data-v-5480b292"]]),$e={__name:"service-channel-requirements",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},validateForm:{type:Boolean,default:!1},selectedLang:{type:[String,Number],required:!0},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(b,{emit:d}){const n=b,i=O({get(){return n.modelValue},set(l){d("update:modelValue",l)}}),a=O(()=>n.selectedLang),g=O({get(){return F.getFieldByLangAndName(i.value,a.value,"openingHours")},set(l){F.setFieldByLangAndName(i.value,a.value,"openingHours",l)}}),v=O({get(){return F.getFieldByLangAndName(i.value,a.value,"attendanceRestrictions")},set(l){F.setFieldByLangAndName(i.value,a.value,"attendanceRestrictions",l)}});return(l,o)=>{const r=p("form-field"),k=p("accordion");return I(),N(k,{id:"attendance-restrictions",title:l._lang.backoffice.pointOfCare.serviceChannelRequirements,collapsed:!1,class:"mb-4"},{default:C(()=>[t(r,{id:"openingHours",class:"mb-3 col-12",modelValue:e(g),"onUpdate:modelValue":o[0]||(o[0]=s=>B(g)?g.value=s:null),label:l._lang.label.openingHours,disabled:n.disabled,loading:n.loading,type:e(m).inputs.textarea,rows:3,language:e(a),maxlength:2e3},null,8,["modelValue","label","disabled","loading","type","language"]),t(r,{id:"attendanceRestrictions",class:"mb-3 col-12",modelValue:e(v),"onUpdate:modelValue":o[1]||(o[1]=s=>B(v)?v.value=s:null),label:l._lang.label.attendanceRestrictions,disabled:n.disabled,loading:n.loading,type:e(m).inputs.textarea,rows:3,language:e(a),maxlength:2e3},null,8,["modelValue","label","disabled","loading","type","language"])]),_:1},8,["title"])}}},ze={__name:"general",props:{modelValue:{type:Object,required:!0},selectedLang:we,disabled:{Boolean,default:!0},rules:{Boolean,default:!0},validateForm:{Boolean,default:!1},loading:{Object,default:{}},isExternalEdit:{type:Boolean,default:!1},vuelidate:{type:Object,default:null}},setup(b){const d=b,n=re(),i=ue(d.rules,d.modelValue),a=O({get(){return d.modelValue},set(l){emit("update:modelValue",l)}}),g=O(()=>d.selectedLang),v=O(()=>d.selectedLang===m.language.en);return(l,o)=>(I(),H(le,null,[t(Be,{modelValue:e(a),"onUpdate:modelValue":o[0]||(o[0]=r=>B(a)?a.value=r:null),store:e(n)},null,8,["modelValue","store"]),t(e(ge),{modelValue:e(a),"onUpdate:modelValue":o[1]||(o[1]=r=>B(a)?a.value=r:null),disabled:d.disabled,loading:b.loading,selectedLang:d.selectedLang,validateForm:d.validateForm,rules:d.rules,isExternalEdit:d.isExternalEdit,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","validateForm","rules","isExternalEdit","vuelidate"]),t(e(qe),{modelValue:e(a),"onUpdate:modelValue":o[2]||(o[2]=r=>B(a)?a.value=r:null),disabled:d.disabled,loading:b.loading,selectedLang:d.selectedLang,validateForm:d.validateForm,rules:d.rules,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","validateForm","rules","vuelidate"]),t(e(je),{modelValue:d.modelValue,"onUpdate:modelValue":o[3]||(o[3]=r=>d.modelValue=r),disabled:d.disabled,loading:b.loading||e(v),rules:d.rules,validateForm:d.validateForm,vuelidate:e(i)},null,8,["modelValue","disabled","loading","rules","validateForm","vuelidate"]),t(e($e),{modelValue:e(a),"onUpdate:modelValue":o[4]||(o[4]=r=>B(a)?a.value=r:null),disabled:d.disabled,loading:b.loading,selectedLang:d.selectedLang,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","vuelidate"]),t(e(pe),{modelValue:e(a).contacts,"onUpdate:modelValue":o[5]||(o[5]=r=>e(a).contacts=r),disabled:d.disabled||e(v),modal:me,store:e(n),loading:b.loading},null,8,["modelValue","disabled","store","loading"]),t(e(Fe),{modelValue:e(a),"onUpdate:modelValue":o[6]||(o[6]=r=>B(a)?a.value=r:null),disabled:d.disabled,loading:b.loading,selectedLang:d.selectedLang,vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","vuelidate"]),t(Ne,{modelValue:e(a),"onUpdate:modelValue":o[7]||(o[7]=r=>B(a)?a.value=r:null),disabled:d.disabled,loading:b.loading,selectedLang:e(g),vuelidate:e(i)},null,8,["modelValue","disabled","loading","selectedLang","vuelidate"])],64))}},Pe={__name:"search-service-modal",props:{pointOfCareId:{Number,required:!0},pointOfCareVersion:{Number,required:!0}},emits:["apply"],setup(b,{emit:d}){const n=b,i=Ae(),a="search-service-modal",g=ne(),v=Ve();let l=ee(R()),o=f([]),r=f([]),k=f(_.createEmptyDataSource()),s=f(!1),S=f(!1),L=f(0),E=f("pt"),T=ee(w());function w(){return Ee.newForm()}function R(){return{pageNumber:1,sortBy:"Code",code:null,serviceTypeIds:null,serviceCategoryIds:null,businessEventIds:null,lifeEventIds:null,abreviation:null,name:null,organization:null,recordStateIds:[m.recordStateType.published],active:!0}}de(async()=>{s.value=!0,o.value=_.convertEnumToArray(g.enums.recordStateType);const u=await Z.getLists(v.getLanguage);_.validateResponse(u,null,()=>{i.setLists(u.data),o.value=_.convertEnumToArray(g.enums.recordStateType),r.value=_.concatItemsBadge(o.value,F.recordStateTypeBadgeOptions)}),s.value=!1}),se(async()=>{await U()});async function $(u){l.sortBy=u,await U()}async function P(u){l.pageNumber=u,await U()}async function U(){s.value=!0;let u=await Z.search(l);_.validateResponse(u,null,()=>{k.value=u.data}),s.value=!1}async function K(){Object.assign(l,R()),await U()}async function x(){await U()}async function G(u){const y=await Z.getById(u.serviceId,u.serviceVersion);_.validateResponse(y,null,()=>{Object.assign(T,y.data),S.value=!0}),L.value++}function h(){}async function Q(){s.value=!0;const u=await ae.associationCreate(n.pointOfCareId,n.pointOfCareVersion,T.serviceId,T.serviceVersion);_.validateResponse(u,g.backoffice.pointOfCare.serviceAdded,()=>{d("apply")}),s.value=!1}return(u,y)=>{const q=p("form-field"),c=p("row"),A=p("cfilter"),j=p("ccolumn"),J=p("table-action-detail"),M=p("ctable"),W=p("container-wrapper"),D=p("cbutton"),X=p("modal");return I(),N(X,{id:a,title:u._lang.backoffice.service.searchTitle,size:e(m).modalSize.extraLarge,"remove-padding":!0},{body:C(()=>[t(A,{title:u._lang.common.filter,disabled:e(s),"clear-click":K,"apply-click":x,loading:e(s),collapsed:!0},{default:C(()=>[t(c,null,{default:C(()=>[t(q,{id:"code",modelValue:e(l).code,"onUpdate:modelValue":y[0]||(y[0]=V=>e(l).code=V),class:"mb-3 col-12 col-md-6 col-xl-4",label:u._lang.label.code,type:e(m).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),t(q,{id:"serviceTypeId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(l).serviceTypeIds,"onUpdate:modelValue":y[1]||(y[1]=V=>e(l).serviceTypeIds=V),label:u._lang.label.serviceTypeId,type:e(m).inputs.multiselect,options:e(i).serviceTypeList,disabled:e(s),mode:e(m).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),t(q,{id:"serviceCategoryId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(l).serviceCategoryIds,"onUpdate:modelValue":y[2]||(y[2]=V=>e(l).serviceCategoryIds=V),label:u._lang.label.serviceCategoryId,type:e(m).inputs.multiselect,options:e(i).serviceCategoryList,disabled:e(s),mode:e(m).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),t(q,{id:"abreviation",class:"mb-3 col-12 col-md-6",modelValue:e(l).abreviation,"onUpdate:modelValue":y[3]||(y[3]=V=>e(l).abreviation=V),label:u._lang.label.abreviation,type:e(m).inputs.text,maxlength:16,disabled:e(s)},null,8,["modelValue","label","type","disabled"]),t(q,{id:"organizationId",class:"mb-3 col-12 col-md-6",modelValue:e(l).organization,"onUpdate:modelValue":y[4]||(y[4]=V=>e(l).organization=V),label:u._lang.label.organizationHost,type:e(m).inputs.multiselect,options:e(i).organizationList,disabled:e(s),valueProp:e(m).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),t(q,{id:"name",class:"mb-3 col-12",modelValue:e(l).name,"onUpdate:modelValue":y[5]||(y[5]=V=>e(l).name=V),label:u._lang.label.name,type:e(m).inputs.text,maxlength:45,disabled:e(s)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","disabled","loading"]),t(W,null,{default:C(()=>[t(M,{onSort:$,onChangePage:P,data:e(k),checkbox:!1,loading:e(s),defaultSort:"Code"},{columns:C(()=>[t(j,{name:u._lang.label.code,field:"code",sortable:!0},null,8,["name"]),t(j,{name:u._lang.label.serviceTypeId,field:"serviceType",sortField:"serviceTypeId",sortable:!0},null,8,["name"]),t(j,{name:u._lang.label.abreviation,field:"abreviation",sortable:!0},null,8,["name"]),t(j,{name:u._lang.label.name,field:"name",sortable:!0},null,8,["name"]),t(j,{name:u._lang.label.state,field:"recordStateTypeId",align:e(m).columnAlign.center,custom:ie,options:e(r),sortable:!0},null,8,["name","align","options"])]),actions:C(V=>[t(J,{onClick:te=>G(V.item)},null,8,["onClick"])]),_:1},8,["data","loading"])]),_:1}),(I(),N(e(fe),{collapsed:e(S),class:"mt-5",key:e(L),modelValue:e(T),"onUpdate:modelValue":y[6]||(y[6]=V=>B(T)?T.value=V:T=V),disabled:!0,loading:e(s),selectedLang:e(E),validateForm:!1},null,8,["collapsed","modelValue","loading","selectedLang"]))]),footer:C(()=>[t(D,{type:"primary",size:"large",title:u._lang.common.apply,"data-bs-dismiss":"modal",onClick:Q,disabled:!e(T).code},null,8,["title","disabled"]),t(D,{type:"secondary",size:"large",title:u._lang.common.cancel,"data-bs-dismiss":"modal",onClick:h},null,8,["title"])]),_:1},8,["title","size"])}}},De=["id"],He={__name:"services",props:{formModel:{Object,required:!0}},setup(b){var y,q;const d=b,n=f(oe.havePermission(m.permissions.pointOfCare.createEdit)&&(((y=d.formModel)==null?void 0:y.recordStateTypeId)==m.recordStateType.draft||((q=d.formModel)==null?void 0:q.recordStateTypeId)==m.recordStateType.published)),i=f(oe.havePermission(m.permissions.pointOfCare.approve)),a=O(()=>{let c=Ce.getUser();return!c||!c.name?!1:c.name.toLowerCase()==="guest"});se(()=>{}),de(async()=>{L.value=_.decodeId(o.params.pointOfCareId),E.value=_.decodeId(o.params.pointOfCareVersion),$.value=_.convertEnumToArray(r.enums.recordStateType),!L.value||!E.value?k.push({name:constants.router.BACKOFFICE_POINT_OF_CARE_PAGE.name}):(w.pointOfCareId=L.value,w.pointOfCareVersion=E.value,await h(),$.value=_.convertEnumToArray(r.enums.recordStateType),P.value=_.concatItemsBadge($.value,F.recordStateTypeBadgeOptions))});const g="search-service-modal",v="delete-service",l=_.uuid(),o=Se(),r=ne(),k=Oe();let s=f(!0),S=f(0),L=f(0),E=f(0),T=f(_.createEmptyDataSource()),w=ee(U()),R=f(null),$=f([]),P=f([]);function U(){let c=null;return a.value&&(c=[m.recordStateType.published]),{pageNumber:1,sortBy:"ServiceName",active:!0,pointOfCareId:null,pointOfCareVersion:null,recordStateTypeIds:c}}function K(){S.value++,window.setTimeout(function(){_.showModalById(g)},5)}async function x(c){w.sortBy=c,await h()}async function G(c){w.pageNumber=c,await h()}async function h(){s.value=!0;let c=await ae.associationSearch(w);_.validateResponse(c,null,()=>{T.value=c.data,T.value.items.forEach(A=>{A.recordStateTypeId=m.recordStateType.submitted,A.pointOfCareRecordStateTypeId==m.recordStateType.published&&A.serviceRecordStateTypeId==m.recordStateType.published?A.recordStateTypeId=m.recordStateType.published:(A.pointOfCareRecordStateTypeId==m.recordStateType.returned||A.serviceRecordStateTypeId==m.recordStateType.returned)&&(A.recordStateTypeId=m.recordStateType.returned)})}),s.value=!1}async function Q(c){R.value=c}async function u(){if(R.value){s.value=!0;const c=await ae.associationRemove(L.value,E.value,R.value.serviceId,R.value.serviceVersion);_.validateResponse(c,r.backoffice.pointOfCare.serviceRemoved,async()=>{await h()}),s.value=!1}}return(c,A)=>{const j=p("icon-plus"),J=p("table-actions"),M=p("ccolumn"),W=p("table-action-delete"),D=p("ctable"),X=p("container-wrapper"),V=p("confirm-delete-modal");return I(),H(le,null,[t(X,null,{default:C(()=>[t(J,{title:c._lang.common.tableActionTitle},{default:C(()=>[n.value?(I(),H("button",{key:0,class:"btn btn-primary",type:"button",id:e(l),onClick:K},[t(j,{color:"#FFF"}),Ie(" "+Te(c._lang.common.addService),1)],8,De)):z("",!0)]),_:1},8,["title"]),t(D,{onSort:x,onChangePage:G,data:e(T),checkbox:!1,loading:e(s),defaultSort:"ServiceName",checkboxField:"code"},{columns:C(()=>[t(M,{name:c._lang.label.code,field:"serviceCode",sortable:!0},null,8,["name"]),t(M,{name:c._lang.label.channelTypeId,field:"serviceType",sortField:"serviceType",sortable:!0},null,8,["name"]),t(M,{name:c._lang.label.abreviation,field:"serviceOrganization",sortField:"serviceOrganizationId",sortable:!0},null,8,["name"]),t(M,{name:c._lang.label.name,field:"serviceName",sortable:!0},null,8,["name"]),t(M,{name:c._lang.label.organizationHost,field:"serviceOrganization",sortField:"serviceOrganizationId",sortable:!0},null,8,["name"]),t(M,{name:c._lang.label.state,field:"recordStateTypeId",align:e(m).columnAlign.center,custom:ie,options:e(P),sortable:!1},null,8,["name","align","options"])]),actions:C(te=>[i.value?(I(),N(W,{key:0,id:v,onClick:Ke=>Q(te.item)},null,8,["onClick"])):z("",!0)]),_:1},8,["data","loading"])]),_:1}),e(s)?z("",!0):(I(),N(Pe,{key:e(S),pointOfCareId:e(L),pointOfCareVersion:e(E),onApply:h},null,8,["pointOfCareId","pointOfCareVersion"])),t(V,{id:v,title:c._lang.backoffice.pointOfCare.serviceDeleteTitle,message:c._lang.backoffice.pointOfCare.serviceDeleteQuestion,action:u},null,8,["title","message"])],64)}}},sa={__name:"form",props:{formModel:{Object,required:!0},loading:{type:Boolean,required:!0},validateForm:{type:Boolean,required:!0},disabled:{type:Boolean,required:!0},isExternalEdit:{type:Boolean,required:!0},selectedLang:{type:[Number,String],required:!0},rules:{type:Object,required:!0},vuelidate:{Object,default:null},showProgress:{type:Boolean,default:!0},progressValue:{type:[Number],required:!1}},emits:["update:formModel"],setup(b,{emit:d}){const n=b,i=O({get(){return n.formModel},set(a){d("update:formModel",a)}});return(a,g)=>{const v=p("progress-bar"),l=p("container-wrapper"),o=p("tab-content"),r=p("tabs");return I(),N(r,null,{default:C(()=>[t(o,{id:"general",title:a._lang.common.general,active:!0},{default:C(()=>[n.showProgress?(I(),N(l,{key:0,"margin-top":!1},{default:C(()=>[n.showProgress?(I(),N(v,{key:0,value:n.progressValue,label:a._lang.common.fill,class:"mb-4 col-12 float-end"},null,8,["value","label"])):z("",!0)]),_:1})):z("",!0),t(ze,{modelValue:e(i),"onUpdate:modelValue":g[0]||(g[0]=k=>B(i)?i.value=k:null),disabled:n.disabled,validateForm:n.validateForm,loading:n.loading,selectedLang:n.selectedLang,rules:n.rules},null,8,["modelValue","disabled","validateForm","loading","selectedLang","rules"])]),_:1},8,["title"]),t(o,{id:"services",title:a._lang.backoffice.menu.services,active:!1,disabled:!1},{default:C(()=>[t(He,{formModel:e(i)},null,8,["formModel"])]),_:1},8,["title"])]),_:1})}}};export{sa as _};
