import{g as se,i as ne,J as ie,r as m,s,G as R,u as d,M as de,K as re,o as ce,j as D,k as r,c as I,l as C,w as c,n,p as e,U as ue,y as w,W as me,I as O,L as pe,z}from"./index-c417b10a.js";import{s as A}from"./service-e178ddc5.js";import{u as be}from"./service-d66d7fcd.js";import{s as ve}from"./helpers-9f3bdf36.js";import{b as ge}from"./helpers-422844e7.js";import"./helpers-1b7a9838.js";import"./index.esm-29b873a2.js";const Te={__name:"index",setup(ye){const U=se(),v=ne(),g=be(),N=ie(),G="confirm-delete";let i=m(!1),S=m([]),V=m([]),_=m(s.tableSelectedState.none),t=R(M()),k=m([]),F=m([]),B=m(d.createEmptyDataSource()),T=R({});const L=m(de.havePermission(s.permissions.service.createEdit));function M(){return{pageNumber:1,sortBy:"Code",code:null,serviceTypeIds:null,serviceCategoryIds:[],serviceSubCategoryIds:[],businessEventIds:null,lifeEventIds:null,abreviation:null,name:null,organization:null,recordStateIds:[s.recordStateType.published],active:!0}}async function K(){if(T){i.value=!0;const l=await A.delete(T.serviceId);d.validateResponse(l,v.backoffice.service.deleted,()=>{d.removeItemOfArray(B.value.items,T)}),T=null,i.value=!1}}re(async()=>{i.value=!0,k.value=d.convertEnumToArray(v.enums.recordStateType);const l=await A.getLists(N.getLanguage);d.validateResponse(l,null,()=>{g.setLists(l.data),k.value=d.convertEnumToArray(v.enums.recordStateType),F.value=d.concatItemsBadge(k.value,ge.recordStateTypeBadgeOptions)}),i.value=!1}),ce(async()=>{await E()});function x(l){U.push({name:z.router.BACKOFFICE_EDIT_SERVICE_PAGE.name,params:{serviceId:d.encodeId(l.serviceId),serviceVersion:d.encodeId(l.serviceVersion)}})}function H(l){U.push({name:z.router.BACKOFFICE_DETAIL_SERVICE_PAGE.name,params:{serviceId:d.encodeId(l.serviceId),serviceVersion:d.encodeId(l.serviceVersion)}})}async function j(){Object.assign(t,M()),await P()}async function P(){t.pageNumber=1,await E()}async function W(){i.value=!0;const l=await A.create(ve.newForm());d.validateResponse(l,null,()=>{const o=d.encodeId(l.data.serviceId),p=d.encodeId(l.data.serviceVersion);U.push({name:z.router.BACKOFFICE_EDIT_SERVICE_PAGE.name,params:{serviceId:o,serviceVersion:p}})}),i.value=!1}async function J(l){t.sortBy=l,await E()}async function Q(l){t.pageNumber=l,await E()}async function E(){i.value=!0;let l=await A.search(t);d.validateResponse(l,null,()=>{B.value=l.data}),i.value=!1}const q=D(()=>L.value?v.backoffice.service.pageTitle:v.backoffice.service.breadcrumbTitle),X=D(()=>{var o,p;if(t.serviceCategoryIds==null||((o=t.serviceCategoryIds)==null?void 0:o.length)==0)return t.serviceSubCategoryIds=[],[];var l=g.serviceSubCategoryList.filter(b=>t.serviceCategoryIds.some(y=>y==b.state));return(p=t.serviceSubCategoryIds)==null||p.forEach(b=>{l.some(y=>y.value==b)||d.removeItemOfArray(t.serviceSubCategoryIds,b)}),l});return(l,o)=>{const p=r("breadcrumb-item"),b=r("breadcrumb"),y=r("cbutton"),u=r("form-field"),Y=r("row"),Z=r("cfilter"),f=r("ccolumn"),$=r("table-action-edit"),h=r("table-action-detail"),ee=r("ctable"),le=r("card"),ae=r("confirm-delete-modal"),te=r("page");return I(),C(te,{title:e(q)},{breadcrumb:c(()=>[n(b,{"has-home":!0},{default:c(()=>[n(p,{label:l._lang.backoffice.service.breadcrumbTitle},null,8,["label"])]),_:1})]),actions:c(()=>[L.value?(I(),C(y,{key:0,class:"col-12 col-sm-auto",type:e(s).buttonType.secondary,size:e(s).buttonSize.medium,title:l._lang.common.toAdd,icon:ue,onClick:W},null,8,["type","size","title"])):w("",!0)]),default:c(()=>[n(le,{shadow:!0},{body:c(()=>[n(Z,{title:l._lang.common.filter,disabled:e(i),"clear-click":j,"apply-click":P,loading:e(i),collapsed:!0},{default:c(()=>[n(Y,null,{default:c(()=>[n(u,{id:"code",modelValue:e(t).code,"onUpdate:modelValue":o[0]||(o[0]=a=>e(t).code=a),class:"mb-3 col-12 col-md-6 col-xl-4",label:l._lang.label.code,type:e(s).inputs.text,maxlength:45,disabled:e(i)},null,8,["modelValue","label","type","disabled"]),n(u,{id:"serviceTypeId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(t).serviceTypeIds,"onUpdate:modelValue":o[1]||(o[1]=a=>e(t).serviceTypeIds=a),label:l._lang.label.serviceTypeId,type:e(s).inputs.multiselect,options:e(g).serviceTypeList,disabled:e(i),mode:e(s).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),n(u,{id:"serviceCategoryId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(t).serviceCategoryIds,"onUpdate:modelValue":o[2]||(o[2]=a=>e(t).serviceCategoryIds=a),label:l._lang.label.serviceCategoryId,type:e(s).inputs.multiselect,options:e(g).serviceCategoryList,disabled:e(i),mode:e(s).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),n(u,{id:"serviceSubCategoryId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(t).serviceSubCategoryIds,"onUpdate:modelValue":o[3]||(o[3]=a=>e(t).serviceSubCategoryIds=a),label:l._lang.label.serviceSubCategoryId,type:e(s).inputs.multiselect,options:e(X),disabled:e(i),mode:e(s).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),n(u,{id:"abreviation",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(t).abreviation,"onUpdate:modelValue":o[4]||(o[4]=a=>e(t).abreviation=a),label:l._lang.label.abreviation,type:e(s).inputs.text,maxlength:16,disabled:e(i)},null,8,["modelValue","label","type","disabled"]),n(u,{id:"name",class:"mb-3 col-12 col-xl-4",modelValue:e(t).name,"onUpdate:modelValue":o[5]||(o[5]=a=>e(t).name=a),label:l._lang.label.name,type:e(s).inputs.text,maxlength:45,disabled:e(i)},null,8,["modelValue","label","type","disabled"]),n(u,{id:"organizationId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(t).organization,"onUpdate:modelValue":o[6]||(o[6]=a=>e(t).organization=a),label:l._lang.label.organizationHost,type:e(s).inputs.multiselect,options:e(g).organizationList,disabled:e(i),valueProp:e(s).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),L.value?(I(),C(u,{key:0,id:"recordStateId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(t).recordStateIds,"onUpdate:modelValue":o[7]||(o[7]=a=>e(t).recordStateIds=a),label:l._lang.label.state,type:e(s).inputs.multiselect,options:e(k),disabled:e(i),mode:e(s).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"])):w("",!0),n(u,{id:"active",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(t).active,"onUpdate:modelValue":o[8]||(o[8]=a=>e(t).active=a),label:l._lang.label.public,type:e(s).inputs.checkbox,disabled:e(i)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","disabled","loading"]),n(me,null,{default:c(()=>[n(ee,{onSort:J,onChangePage:Q,selectedItems:e(S),"onUpdate:selectedItems":o[9]||(o[9]=a=>O(S)?S.value=a:S=a),unselectedItems:e(V),"onUpdate:unselectedItems":o[10]||(o[10]=a=>O(V)?V.value=a:V=a),selectedState:e(_),"onUpdate:selectedState":o[11]||(o[11]=a=>O(_)?_.value=a:_=a),data:e(B),checkbox:!1,loading:e(i),defaultSort:"pointOfCareId",checkboxField:"code"},{columns:c(()=>[n(f,{name:l._lang.label.code,field:"code",sortable:!0},null,8,["name"]),n(f,{name:l._lang.label.serviceTypeId,field:"serviceType",sortField:"serviceTypeId",sortable:!0},null,8,["name"]),n(f,{name:l._lang.label.abreviation,field:"abreviation",sortable:!0},null,8,["name"]),n(f,{name:l._lang.label.name,field:"name",sortable:!0},null,8,["name"]),n(f,{name:l._lang.label.state,field:"recordStateTypeId",align:e(s).columnAlign.center,custom:pe,options:e(F),sortable:!0},null,8,["name","align","options"])]),actions:c(a=>[a.item.recordStateTypeId==e(s).recordStateType.draft?(I(),C($,{key:0,onClick:oe=>x(a.item)},null,8,["onClick"])):w("",!0),a.item.recordStateTypeId>e(s).recordStateType.draft?(I(),C(h,{key:1,onClick:oe=>H(a.item)},null,8,["onClick"])):w("",!0)]),_:1},8,["selectedItems","unselectedItems","selectedState","data","loading"])]),_:1})]),_:1}),n(ae,{id:G,title:l._lang.backoffice.service.delete,message:l._lang.backoffice.service.deleteQuestion,action:K},null,8,["title","message"])]),_:1},8,["title"])}}};export{Te as default};
