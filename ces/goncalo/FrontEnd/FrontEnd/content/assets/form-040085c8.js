import{_ as de,a as ie,b as re}from"./contacts-e1f3718d.js";import{_ as ue,a as ce}from"./address.vue_vue_type_style_index_0_scoped_2266ba05_lang-26d7c6d3.js";import{j as k,k as u,c as F,l as N,w as v,n as a,p as e,H as S,s as f,_ as me,u as _,r as y,N as pe,e as j,m as x,O as ge,Q as be,F as W,i as ee,J as fe,E as G,K as le,o as ae,L as ve,M as ye,f as _e,g as Ve,t as Ce,v as Oe,y as z}from"./index-4fe030fb.js";import{b as w}from"./helpers-79f72589.js";import{u as Le}from"./organization-ee9170b1.js";import{u as ke}from"./index.esm-cfa4c1f7.js";import{u as te}from"./point-of-care-bbec9da4.js";import{_ as Fe}from"./address-5eeef571.js";import{_ as Ie,a as Be}from"./refusal-7a8f2f5e.js";import{r as Se}from"./index.esm-bce4ceba.js";import{_ as we}from"./generic-31c2de5a.js";import{p as J}from"./point-of-care-9174b5ec.js";import{s as Q}from"./service-6ce3c872.js";import{u as Ne}from"./service-ede9828c.js";import{s as Te}from"./helpers-7189282a.js";const Ee={__name:"description",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},selectedLang:{type:[String,Number],required:!0},validateForm:{type:Boolean,default:!1},rules:{type:Object,default:{}}},emits:["update:modelValue"],setup(p,{emit:s}){const n=p;Le(),ke(n.rules,n.modelValue);const t=k({get(){return n.modelValue},set(l){s("update:modelValue",l)}}),r=k(()=>n.selectedLang),c=k({get(){return w.getFieldByLangAndName(t.value,r.value,"description")},set(l){w.setFieldByLangAndName(t.value,r.value,"description",l)}}),g=k({get(){return w.getFieldByLangAndName(t.value,r.value,"preConditions")},set(l){w.setFieldByLangAndName(t.value,r.value,"preConditions",l)}});return k({get(){return w.getFieldByLangAndName(t.value,r.value,"keywords")},set(l){w.setFieldByLangAndName(t.value,r.value,"keywords",l)}}),(l,o)=>{const O=u("form-field"),V=u("accordion");return F(),N(V,{id:"description",title:l._lang.common.description,collapsed:!1,class:"mb-4"},{default:v(()=>[a(O,{id:"description",class:"mb-3 col-12",modelValue:e(c),"onUpdate:modelValue":o[0]||(o[0]=i=>S(c)?c.value=i:null),label:l._lang.label.description,disabled:n.disabled,loading:n.loading,type:e(f).inputs.text,maxlength:255,language:e(r)},null,8,["modelValue","label","disabled","loading","type","language"]),a(O,{id:"preConditions",class:"mb-3 col-12",modelValue:e(g),"onUpdate:modelValue":o[1]||(o[1]=i=>S(g)?g.value=i:null),label:l._lang.label.preConditions,disabled:n.disabled,loading:n.loading,type:e(f).inputs.text,maxlength:255,language:e(r)},null,8,["modelValue","label","disabled","loading","type","language"])]),_:1},8,["title"])}}},Ue={class:"input-group mb-3"},Ae=["aria-describedby"],qe=["id","disabled"],Me={__name:"address",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},validateForm:{type:Boolean,default:!1},rules:{type:Object,default:{}},vuelidate:{type:Object,default:null}},emits:["update:modelValue"],setup(p,{emit:s}){const n=p,t=te(),r=_.uuid();let c=y(0),g=y(0);const l=y(!1);y(!1);const o=k({get(){return n.modelValue},set(L){s("update:modelValue",L)}}),O="search-location";function V(L){Object.assign(o.value.address,L),c.value++}function i(){g.value++,window.setTimeout(function(){_.showModalById(O)},5)}return pe(o.value,L=>{L.address.locationId!=null&&(l.value?(L.address.locationId=null,L.address.code=null,l.value=!1):l.value=!0)}),(L,I)=>{const T=u("icon-search"),B=u("accordion");return F(),j(W,null,[a(B,{id:"address-accordion",title:L._lang.backoffice.entities.address,collapsed:!1,class:"mb-4"},{default:v(()=>[x("div",Ue,[ge(x("input",{ref:"locationQuery",id:"location-query",type:"text",class:"form-control",placeholder:"Código do património","aria-label":"placeholder","aria-describedby":e(r),disabled:"","onUpdate:modelValue":I[0]||(I[0]=U=>e(o).address.code=U)},null,8,Ae),[[be,e(o).address.code]]),x("button",{class:"btn btn-primary",type:"button",id:e(r),disabled:n.disabled,onClick:i},[a(T,{color:"#FFF"})],8,qe)]),(F(),N(Fe,{key:e(c),modelValue:e(o).address,"onUpdate:modelValue":I[1]||(I[1]=U=>e(o).address=U),disabled:n.disabled,rules:n.rules,loading:n.loading,"validate-form":n.validateForm,store:e(t),vuelidate:n.vuelidate},null,8,["modelValue","disabled","rules","loading","validate-form","store","vuelidate"]))]),_:1},8,["title"]),(F(),N(de,{key:e(g),onApply:V}))],64)}}},Re=me(Me,[["__scopeId","data-v-2266ba05"]]),je={__name:"service-channel-requirements",props:{modelValue:{type:Object,required:!0},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},validateForm:{type:Boolean,default:!1},selectedLang:{type:[String,Number],required:!0},rules:{type:Object,default:{}}},emits:["update:modelValue"],setup(p,{emit:s}){const n=p,t=k({get(){return n.modelValue},set(l){s("update:modelValue",l)}}),r=k(()=>n.selectedLang),c=k({get(){return w.getFieldByLangAndName(t.value,r.value,"openingHours")},set(l){w.setFieldByLangAndName(t.value,r.value,"openingHours",l)}}),g=k({get(){return w.getFieldByLangAndName(t.value,r.value,"attendanceRestrictions")},set(l){w.setFieldByLangAndName(t.value,r.value,"attendanceRestrictions",l)}});return(l,o)=>{const O=u("form-field"),V=u("accordion");return F(),N(V,{id:"attendance-restrictions",title:l._lang.backoffice.pointOfCare.serviceChannelRequirements,collapsed:!1,class:"mb-4"},{default:v(()=>[a(O,{id:"openingHours",class:"mb-3 col-12",modelValue:e(c),"onUpdate:modelValue":o[0]||(o[0]=i=>S(c)?c.value=i:null),label:l._lang.label.openingHours,disabled:n.disabled,loading:n.loading,type:e(f).inputs.textarea,rows:3,language:e(r),maxlength:2e3},null,8,["modelValue","label","disabled","loading","type","language"]),a(O,{id:"attendanceRestrictions",class:"mb-3 col-12",modelValue:e(g),"onUpdate:modelValue":o[1]||(o[1]=i=>S(g)?g.value=i:null),label:l._lang.label.attendanceRestrictions,disabled:n.disabled,loading:n.loading,type:e(f).inputs.textarea,rows:3,language:e(r),maxlength:2e3},null,8,["modelValue","label","disabled","loading","type","language"])]),_:1},8,["title"])}}},ze={__name:"general",props:{modelValue:{type:Object,required:!0},selectedLang:Se,disabled:{Boolean,default:!0},rules:{Boolean,default:!0},validateForm:{Boolean,default:!1},loading:{Object,default:{}},isExternalEdit:{type:Boolean,default:!1},vuelidate:{type:Object,default:null}},setup(p){const s=p,n=te(),t=k({get(){return s.modelValue},set(g){emit("update:modelValue",g)}}),r=k(()=>s.selectedLang),c=k(()=>s.selectedLang===f.language.en);return(g,l)=>(F(),j(W,null,[a(Ie,{modelValue:e(t),"onUpdate:modelValue":l[0]||(l[0]=o=>S(t)?t.value=o:null),store:e(n)},null,8,["modelValue","store"]),a(e(ue),{modelValue:e(t),"onUpdate:modelValue":l[1]||(l[1]=o=>S(t)?t.value=o:null),disabled:s.disabled,loading:p.loading,selectedLang:s.selectedLang,validateForm:s.validateForm,rules:s.rules,isExternalEdit:s.isExternalEdit},null,8,["modelValue","disabled","loading","selectedLang","validateForm","rules","isExternalEdit"]),a(e(Ee),{modelValue:e(t),"onUpdate:modelValue":l[2]||(l[2]=o=>S(t)?t.value=o:null),disabled:s.disabled,loading:p.loading,selectedLang:s.selectedLang,validateForm:s.validateForm,rules:s.rules},null,8,["modelValue","disabled","loading","selectedLang","validateForm","rules"]),a(e(Re),{modelValue:s.modelValue,"onUpdate:modelValue":l[3]||(l[3]=o=>s.modelValue=o),disabled:s.disabled,loading:p.loading||e(c),rules:s.rules,validateForm:s.validateForm,vuelidate:s.vuelidate},null,8,["modelValue","disabled","loading","rules","validateForm","vuelidate"]),a(e(je),{modelValue:e(t),"onUpdate:modelValue":l[4]||(l[4]=o=>S(t)?t.value=o:null),disabled:s.disabled,loading:p.loading,selectedLang:s.selectedLang},null,8,["modelValue","disabled","loading","selectedLang"]),a(e(re),{modelValue:e(t).contacts,"onUpdate:modelValue":l[5]||(l[5]=o=>e(t).contacts=o),disabled:s.disabled||e(c),modal:ie,store:e(n),loading:p.loading},null,8,["modelValue","disabled","store","loading"]),a(e(Be),{modelValue:e(t),"onUpdate:modelValue":l[6]||(l[6]=o=>S(t)?t.value=o:null),disabled:s.disabled,loading:p.loading,selectedLang:s.selectedLang},null,8,["modelValue","disabled","loading","selectedLang"]),a(we,{modelValue:e(t),"onUpdate:modelValue":l[7]||(l[7]=o=>S(t)?t.value=o:null),disabled:s.disabled,loading:p.loading,selectedLang:e(r)},null,8,["modelValue","disabled","loading","selectedLang"])],64))}},$e={__name:"search-service-modal",props:{pointOfCareId:{Number,required:!0},pointOfCareVersion:{Number,required:!0}},emits:["apply"],setup(p,{emit:s}){const n=p,t=Ne(),r="search-service-modal",c=ee(),g=fe();let l=G(R()),o=y([]),O=y([]),V=y(_.createEmptyDataSource()),i=y(!1),L=y(!1),I=y(0),T=y("pt"),B=G(U());function U(){return Te.newForm()}function R(){return{pageNumber:1,sortBy:"Code",code:null,serviceTypeIds:null,serviceCategoryIds:null,businessEventIds:null,lifeEventIds:null,abreviation:null,name:null,organization:null,recordStateIds:[f.recordStateType.published],active:!0}}le(async()=>{i.value=!0,o.value=_.convertEnumToArray(c.enums.recordStateType);const d=await Q.getLists(g.getLanguage);_.validateResponse(d,null,()=>{t.setLists(d.data),o.value=_.convertEnumToArray(c.enums.recordStateType),O.value=_.concatItemsBadge(o.value,w.recordStateTypeBadgeOptions)}),i.value=!1}),ae(async()=>{await q()});async function $(d){l.sortBy=d,await q()}async function A(d){l.pageNumber=d,await q()}async function q(){i.value=!0;let d=await Q.search(l);_.validateResponse(d,null,()=>{V.value=d.data}),i.value=!1}async function P(){Object.assign(l,R()),await q()}async function m(){await q()}async function X(d){const b=await Q.getById(d.serviceId,d.serviceVersion);_.validateResponse(b,null,()=>{Object.assign(B,b.data),L.value=!0}),I.value++}function h(){}async function H(){i.value=!0;const d=await J.associationCreate(n.pointOfCareId,n.pointOfCareVersion,B.serviceId,B.serviceVersion);_.validateResponse(d,c.backoffice.pointOfCare.serviceAdded,()=>{s("apply")}),i.value=!1}return(d,b)=>{const E=u("form-field"),D=u("row"),K=u("cfilter"),M=u("ccolumn"),Y=u("table-action-detail"),oe=u("ctable"),ne=u("container-wrapper"),Z=u("cbutton"),se=u("modal");return F(),N(se,{id:r,title:d._lang.backoffice.service.searchTitle,size:e(f).modalSize.extraLarge,"remove-padding":!0},{body:v(()=>[a(K,{title:d._lang.common.filter,disabled:e(i),"clear-click":P,"apply-click":m,loading:e(i),collapsed:!0},{default:v(()=>[a(D,null,{default:v(()=>[a(E,{id:"code",modelValue:e(l).code,"onUpdate:modelValue":b[0]||(b[0]=C=>e(l).code=C),class:"mb-3 col-12 col-md-6 col-xl-4",label:d._lang.label.code,type:e(f).inputs.text,maxlength:45,disabled:e(i)},null,8,["modelValue","label","type","disabled"]),a(E,{id:"serviceTypeId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(l).serviceTypeIds,"onUpdate:modelValue":b[1]||(b[1]=C=>e(l).serviceTypeIds=C),label:d._lang.label.serviceTypeId,type:e(f).inputs.multiselect,options:e(t).serviceTypeList,disabled:e(i),mode:e(f).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),a(E,{id:"serviceCategoryId",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:e(l).serviceCategoryIds,"onUpdate:modelValue":b[2]||(b[2]=C=>e(l).serviceCategoryIds=C),label:d._lang.label.serviceCategoryId,type:e(f).inputs.multiselect,options:e(t).serviceCategoryList,disabled:e(i),mode:e(f).multiselectMode.tags},null,8,["modelValue","label","type","options","disabled","mode"]),a(E,{id:"abreviation",class:"mb-3 col-12 col-md-6",modelValue:e(l).abreviation,"onUpdate:modelValue":b[3]||(b[3]=C=>e(l).abreviation=C),label:d._lang.label.abreviation,type:e(f).inputs.text,maxlength:16,disabled:e(i)},null,8,["modelValue","label","type","disabled"]),a(E,{id:"organizationId",class:"mb-3 col-12 col-md-6",modelValue:e(l).organization,"onUpdate:modelValue":b[4]||(b[4]=C=>e(l).organization=C),label:d._lang.label.organizationHost,type:e(f).inputs.multiselect,options:e(t).organizationList,disabled:e(i),valueProp:e(f).multiselectValueProp.value3},null,8,["modelValue","label","type","options","disabled","valueProp"]),a(E,{id:"name",class:"mb-3 col-12",modelValue:e(l).name,"onUpdate:modelValue":b[5]||(b[5]=C=>e(l).name=C),label:d._lang.label.name,type:e(f).inputs.text,maxlength:45,disabled:e(i)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","disabled","loading"]),a(ne,null,{default:v(()=>[a(oe,{onSort:$,onChangePage:A,data:e(V),checkbox:!1,loading:e(i),defaultSort:"Code"},{columns:v(()=>[a(M,{name:d._lang.label.code,field:"code",sortable:!0},null,8,["name"]),a(M,{name:d._lang.label.serviceTypeId,field:"serviceType",sortField:"serviceTypeId",sortable:!0},null,8,["name"]),a(M,{name:d._lang.label.abreviation,field:"abreviation",sortable:!0},null,8,["name"]),a(M,{name:d._lang.label.name,field:"name",sortable:!0},null,8,["name"]),a(M,{name:d._lang.label.state,field:"recordStateTypeId",align:e(f).columnAlign.center,custom:ve,options:e(O),sortable:!0},null,8,["name","align","options"])]),actions:v(C=>[a(Y,{onClick:He=>X(C.item)},null,8,["onClick"])]),_:1},8,["data","loading"])]),_:1}),(F(),N(e(ce),{collapsed:e(L),class:"mt-5",key:e(I),modelValue:e(B),"onUpdate:modelValue":b[6]||(b[6]=C=>S(B)?B.value=C:B=C),disabled:!0,loading:e(i),selectedLang:e(T),validateForm:!1},null,8,["collapsed","modelValue","loading","selectedLang"]))]),footer:v(()=>[a(Z,{type:"primary",size:"large",title:d._lang.common.apply,"data-bs-dismiss":"modal",onClick:H,disabled:!e(B).code},null,8,["title","disabled"]),a(Z,{type:"secondary",size:"large",title:d._lang.common.cancel,"data-bs-dismiss":"modal",onClick:h},null,8,["title"])]),_:1},8,["title","size"])}}},Pe=["id"],he={__name:"services",props:{},setup(p){const s=y(ye.havePermission(f.permissions.pointOfCare.createEdit));ae(()=>{}),le(async()=>{V.value=_.decodeId(c.params.pointOfCareId),i.value=_.decodeId(c.params.pointOfCareVersion),!V.value||!i.value?l.push({name:constants.router.BACKOFFICE_POINT_OF_CARE_PAGE.name}):(I.pointOfCareId=V.value,I.pointOfCareVersion=i.value,await A())});const n="search-service-modal",t="delete-service",r=_.uuid(),c=_e(),g=ee(),l=Ve();let o=y(!0),O=y(0),V=y(0),i=y(0),L=y(_.createEmptyDataSource()),I=G(B()),T=y(null);function B(){return{pageNumber:1,sortBy:"ServiceName",active:!0,pointOfCareId:null,pointOfCareVersion:null}}function U(){O.value++,window.setTimeout(function(){_.showModalById(n)},5)}async function R(m){I.sortBy=m,await A()}async function $(m){I.pageNumber=m,await A()}async function A(){o.value=!0;let m=await J.associationSearch(I);_.validateResponse(m,null,()=>{L.value=m.data}),o.value=!1}async function q(m){T.value=m}async function P(){if(T.value){o.value=!0;const m=await J.associationRemove(V.value,i.value,T.value.serviceId,T.value.serviceVersion);_.validateResponse(m,g.backoffice.pointOfCare.serviceRemoved,async()=>{await A()}),o.value=!1}}return(m,X)=>{const h=u("icon-plus"),H=u("table-actions"),d=u("ccolumn"),b=u("table-action-delete"),E=u("ctable"),D=u("container-wrapper"),K=u("confirm-delete-modal");return F(),j(W,null,[a(D,null,{default:v(()=>[a(H,{title:m._lang.common.tableActionTitle},{default:v(()=>[s.value?(F(),j("button",{key:0,class:"btn btn-primary",type:"button",id:e(r),onClick:U},[a(h,{color:"#FFF"}),Ce(" "+Oe(m._lang.common.addService),1)],8,Pe)):z("",!0)]),_:1},8,["title"]),a(E,{onSort:R,onChangePage:$,data:e(L),checkbox:!1,loading:e(o),defaultSort:"ServiceName",checkboxField:"code"},{columns:v(()=>[a(d,{name:m._lang.label.code,field:"serviceCode",sortable:!0},null,8,["name"]),a(d,{name:m._lang.label.channelTypeId,field:"serviceType",sortField:"serviceType",sortable:!0},null,8,["name"]),a(d,{name:m._lang.label.abreviation,field:"serviceOrganization",sortField:"serviceOrganizationId",sortable:!0},null,8,["name"]),a(d,{name:m._lang.label.name,field:"serviceName",sortable:!0},null,8,["name"]),a(d,{name:m._lang.label.organizationHost,field:"serviceOrganization",sortField:"serviceOrganizationId",sortable:!0},null,8,["name"])]),actions:v(M=>[a(b,{id:t,onClick:Y=>q(M.item)},null,8,["onClick"])]),_:1},8,["data","loading"])]),_:1}),e(o)?z("",!0):(F(),N($e,{key:e(O),pointOfCareId:e(V),pointOfCareVersion:e(i),onApply:A},null,8,["pointOfCareId","pointOfCareVersion"])),a(K,{id:t,title:m._lang.backoffice.pointOfCare.serviceDeleteTitle,message:m._lang.backoffice.pointOfCare.serviceDeleteQuestion,action:P},null,8,["title","message"])],64)}}},nl={__name:"form",props:{formModel:{Object,required:!0},loading:{type:Boolean,required:!0},validateForm:{type:Boolean,required:!0},disabled:{type:Boolean,required:!0},isExternalEdit:{type:Boolean,required:!0},selectedLang:{type:[Number,String],required:!0},rules:{type:Object,required:!0},vuelidate:{Object,default:null},showProgress:{type:Boolean,default:!0},progressValue:{type:[Number],required:!1}},emits:["update:formModel"],setup(p,{emit:s}){const n=p,t=k({get(){return n.formModel},set(r){s("update:formModel",r)}});return(r,c)=>{const g=u("progress-bar"),l=u("container-wrapper"),o=u("tab-content"),O=u("tabs");return F(),N(O,null,{default:v(()=>[a(o,{id:"general",title:r._lang.common.general,active:!0},{default:v(()=>[n.showProgress?(F(),N(l,{key:0,"margin-top":!1},{default:v(()=>[n.showProgress?(F(),N(g,{key:0,value:n.progressValue,label:r._lang.common.fill,class:"mb-4 col-12 float-end"},null,8,["value","label"])):z("",!0)]),_:1})):z("",!0),a(ze,{modelValue:e(t),"onUpdate:modelValue":c[0]||(c[0]=V=>S(t)?t.value=V:null),disabled:n.disabled,validateForm:n.validateForm,loading:n.loading,selectedLang:n.selectedLang,rules:n.rules},null,8,["modelValue","disabled","validateForm","loading","selectedLang","rules"])]),_:1},8,["title"]),a(o,{id:"services",title:r._lang.backoffice.menu.services,active:!1,disabled:!1},{default:v(()=>[a(he)]),_:1},8,["title"])]),_:1})}}};export{nl as _};
