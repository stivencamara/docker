import{_ as j}from"./general-bd6e49da.js";import{g as H,f as Y,i as q,r as n,G as w,s as J,j as y,N as A,K as Q,u as i,z as b,k as c,c as F,l as W,w as d,n as o,p as e,e as P,F as L,I as k}from"./index-e6787e94.js";import{d as C}from"./document-7d8e49bb.js";import{d as T}from"./helpers-ee63bdf4.js";import{u as X}from"./document-be6216ed.js";import{u as Z}from"./index.esm-cb55abbd.js";import{b as $}from"./helpers-1692af0f.js";import{e as x}from"./edit-actions-8ddefaf6.js";import"./refusal-82cd23d2.js";import"./index.esm-7850210a.js";import"./generic-25679898.js";import"./cancel-confirm-e26bc141.js";import"./settings-8db6c4e1.js";/* empty css                                                                     */const fe={__name:"edit",setup(ee){const O=H(),m=Y(),R=q(),p=X();let r=n(!0),t=w(T.newForm()),s=n(J.language.pt);n([]);let B=w(T.formRules()),_=n(0),I=n(0),g=n(0),v=n(0),E=n([]);const z=Z(B,t),M=y(()=>I.value===100&&!r.value);async function N(){r.value=!0;let a=await C.getById(_.value,v.value);i.validateResponse(a,null,async()=>{Object.assign(t,a.data),p.setFormToCompare(i.cloneObject(a.data))}),r.value=!1}async function V(){r.value=!0;const a=await C.getLists(s.value);i.validateResponse(a,null,()=>{p.setLists(a.data),p.setFormToCompare(a.data)}),r.value=!1}A(()=>s.value,()=>{V()}),Q(async()=>{_.value=i.decodeId(m.params.documentId),v.value=i.decodeId(m.params.documentVersion),g.value=i.decodeId(m.params.organizationId),!_.value||!v.value?O.push({name:b.router.BACKOFFICE_DOCUMENT_PAGE.name}):(await V(),await N())}),A(()=>[t.texts[0].name,t.organization,t.documentTypeId,t.startDate,t.document],()=>{E.value=T.progressFields(),$.calculatePercentage(t,E.value,a=>{p.setProgress(a),I.value=a})});const h=y(()=>g.value>0?`${b.router.BACKOFFICE_EDIT_ENTITY_PAGE.path.replace(":organizationId",m.params.organizationId).replace(":organizationVersion",m.params.organizationVersion)}#documentos`:b.router.BACKOFFICE_DOCUMENT_PAGE.name);return(a,u)=>{const f=c("breadcrumb-item"),S=c("breadcrumb"),D=c("progress-bar"),G=c("container-wrapper"),K=c("card"),U=c("page");return F(),W(U,{title:a._lang.backoffice.document.editPageTitle},{breadcrumb:d(()=>[o(S,{"has-home":!0},{default:d(()=>[e(g)>0?(F(),P(L,{key:0},[o(f,{label:a._lang.backoffice.entities.breadcrumbTitle,"router-path":e(b).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),o(f,{label:e(R).common.entity,"router-path":e(h)},null,8,["label","router-path"]),o(f,{label:a._lang.backoffice.document.editPageTitle},null,8,["label"])],64)):(F(),P(L,{key:1},[o(f,{label:a._lang.backoffice.document.breadcrumbTitle,"router-path":e(b).router.BACKOFFICE_DOCUMENT_PAGE.path},null,8,["label","router-path"]),o(f,{label:a._lang.backoffice.document.editPageTitle},null,8,["label"])],64))]),_:1})]),actions:d(()=>[o(x,{loading:e(r),"onUpdate:loading":u[0]||(u[0]=l=>k(r)?r.value=l:r=l),canSubmit:e(M),selectedLang:e(s),"onUpdate:selectedLang":u[1]||(u[1]=l=>k(s)?s.value=l:s=l),backRoute:e(h),directBackRoute:e(g)>0,service:e(C),itemId:e(_),itemVersion:e(v),formModel:e(t),vuelidate:e(z),store:e(p),resource:a._lang.backoffice.document,itemIdField:"documentId",progressFields:e(E)},null,8,["loading","canSubmit","selectedLang","backRoute","directBackRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource","progressFields"])]),default:d(()=>[o(K,{shadow:!0},{body:d(()=>[o(G,{"margin-top":!1},{default:d(()=>[o(D,{value:e(I),label:a._lang.common.fill,class:"mb-4 col-12 float-end"},null,8,["value","label"])]),_:1}),o(j,{modelValue:e(t),"onUpdate:modelValue":u[2]||(u[2]=l=>k(t)?t.value=l:t=l),disabled:!1,loading:e(r),selectedLang:e(s),validateForm:!0,rules:e(B),isExternalEdit:e(g)>0},null,8,["modelValue","loading","selectedLang","rules","isExternalEdit"])]),_:1})]),_:1},8,["title"])}}};export{fe as default};
