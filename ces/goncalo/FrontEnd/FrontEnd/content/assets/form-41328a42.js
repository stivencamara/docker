import{i as N,h as R,G as L,r as M,j as q,k as u,c as h,l as S,w as g,n as i,p as e,s as m,u as E,R as F,e as P,y as T,S as A,T as D,F as H}from"./index-e6787e94.js";import{u as Q}from"./index.esm-cb55abbd.js";import{b as f}from"./helpers-1692af0f.js";import{u as B}from"./users-867156ab.js";const W={formRules(){return{name:{required:f.requiredMessage()},displayName:{required:f.requiredMessage()},password:{required:f.requiredMessageWithDependency("isGraUser",!0)},email:{required:f.requiredMessage(),email:f.emailMessage()}}},newProfileRules(){return{profileId:{required:f.requiredMessage()},organization:{required:f.requiredMessage()}}}},J={__name:"create-profile-modal",props:{modelValue:{type:Array,required:!0}},emits:["update:modelValue"],setup(I,{emit:k}){const a=I,w=N();R();const y="create-profile",v=B();let s=L(t()),U=W.newProfileRules(),r=M(!1);const p=Q(U,s,{$scope:!1}),V=q({get(){return a.modelValue},set(l){k("update:modelValue",l)}});function t(){return{profileId:null,organization:null}}function $(){s=Object.assign(s,t()),p.value.$reset()}async function C(){if(r.value=!0,await p.value.$validate(),!p.value.$error){const l={profileId:s.profileId,organizationId:s.organization.id};V.value.filter(d=>d.profileId===s.profileId&&d.organizationId===s.organization.id).length?F.warning(w.common.profileExists):(V.value.push(l),s=Object.assign(s,t()),p.value.$reset(),E.closeModalById(y),F.success(w.common.profileAdded))}r.value=!1}return(l,o)=>{const d=u("form-field"),b=u("row"),c=u("cbutton"),z=u("modal");return h(),S(z,{id:y,title:l._lang.common.addContact,size:e(m).modalSize.extraLarge},{body:g(()=>[i(b,null,{default:g(()=>[i(d,{id:"profileId",class:"mb-3 col-12 col-md-6",modelValue:e(s).profileId,"onUpdate:modelValue":o[0]||(o[0]=_=>e(s).profileId=_),label:l._lang.label.profile,disabled:a.disabled,loading:a.loading,type:e(m).inputs.multiselect,options:e(v).profileList,required:!0,"show-error":e(p).profileId.$error,"error-message":l._errorMessageField(e(p).profileId)},null,8,["modelValue","label","disabled","loading","type","options","show-error","error-message"]),i(d,{id:"organization",class:"mb-3 col-12 col-md-6",modelValue:e(s).organization,"onUpdate:modelValue":o[1]||(o[1]=_=>e(s).organization=_),label:l._lang.label.organization,disabled:a.disabled,loading:a.loading,type:e(m).inputs.multiselect,required:!0,"show-error":e(p).organization.$error,options:e(v).organizationList,"error-message":l._errorMessageField(e(p).organization),"value-prop":e(m).multiselectValueProp.value3},null,8,["modelValue","label","disabled","loading","type","show-error","options","error-message","value-prop"])]),_:1})]),footer:g(()=>[i(c,{title:l._lang.common.cancel,type:e(m).buttonType.secondary,"data-bs-dismiss":"modal","aria-label":"Close",disabled:e(r),onClick:$},null,8,["title","type","disabled"]),i(c,{title:l._lang.common.save,onClick:C,disabled:e(r)},null,8,["title","disabled"])]),_:1},8,["title","size"])}}},ee={__name:"form",props:{modelValue:{type:Object,required:!0,default:{name:"",email:"",profiles:[],active:!0}},loading:{type:Boolean,default:!1},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},isCreate:{type:Boolean,default:!1},vuelidator:{type:Object,default:{}}},emits:["update:modelValue"],setup(I,{emit:k}){const a=I,w=N(),y=B(),v="delete-profile";let s=M(null),U=M(!1);const r=q({get(){return a.modelValue},set(l){k("update:modelValue",l)}}),p=q(()=>E.createEmptyDataSource(V.value)),V=q(()=>{let l=[];return r.value.profiles.forEach(o=>{const d=y.profileList.find(c=>c.value===o.profileId),b=y.organizationList.find(c=>c.value3.id===o.organizationId);d&&b&&l.push({profile:d.label,organization:b.label})}),l}),t=q(()=>a.loading||U.value);function $(l){s.value=l}function C(){if(s.value){let l=E.proxyToObj(s.value);const o=V.value.indexOf(l);o!=-1&&(r.value.profiles.splice(o,1),F.success(w.backoffice.settings.users.profileRemoved)),s.value=null}}return(l,o)=>{const d=u("form-field"),b=u("row"),c=u("table-actions"),z=u("ccolumn"),_=u("table-action-delete"),j=u("ctable"),G=u("container-wrapper"),O=u("confirm-delete-modal");return h(),P(H,null,[i(G,null,{default:g(()=>[i(b,null,{default:g(()=>[i(d,{id:"email",class:"mb-3 col-12 col-md-6",modelValue:e(r).email,"onUpdate:modelValue":o[0]||(o[0]=n=>e(r).email=n),label:l._lang.label.email,loading:e(t),type:e(m).inputs.text,required:a.required,disabled:e(t)||a.disabled,maxlength:150,showError:a.required&&a.vuelidator.email.$error,"error-message":l._errorMessageField(a.vuelidator.email)},null,8,["modelValue","label","loading","type","required","disabled","showError","error-message"]),i(d,{id:"name",class:"mb-3 col-12 col-md-6",modelValue:e(r).name,"onUpdate:modelValue":o[1]||(o[1]=n=>e(r).name=n),label:l._lang.label.name,loading:e(t),type:e(m).inputs.text,required:a.required,disabled:e(t)||a.disabled,maxlength:150,showError:a.required&&a.vuelidator.name.$error,"error-message":l._errorMessageField(a.vuelidator.name)},null,8,["modelValue","label","loading","type","required","disabled","showError","error-message"]),i(d,{id:"displayName",class:"mb-3 col-12",modelValue:e(r).displayName,"onUpdate:modelValue":o[2]||(o[2]=n=>e(r).displayName=n),label:l._lang.label.displayName,loading:e(t),type:e(m).inputs.text,required:a.required,disabled:e(t)||a.disabled,maxlength:150,showError:a.required&&a.vuelidator.displayName.$error,"error-message":l._errorMessageField(a.vuelidator.displayName)},null,8,["modelValue","label","loading","type","required","disabled","showError","error-message"]),e(r).isGraUser?T("",!0):(h(),S(d,{key:0,id:"password",class:"mb-3 col-12",modelValue:e(r).password,"onUpdate:modelValue":o[3]||(o[3]=n=>e(r).password=n),label:l._lang.label.password,loading:e(t),type:e(m).inputs.text,required:a.required,disabled:e(t)||a.disabled,maxlength:150,showError:a.required&&a.vuelidator.password.$error,"error-message":l._errorMessageField(a.vuelidator.password)},null,8,["modelValue","label","loading","type","required","disabled","showError","error-message"])),i(d,{id:"active",class:"mb-3 col-12 col-lg-3",modelValue:e(r).active,"onUpdate:modelValue":o[4]||(o[4]=n=>e(r).active=n),label:l._lang.label.active,disabled:a.disabled,loading:e(t),type:e(m).inputs.checkbox},null,8,["modelValue","label","disabled","loading","type"]),i(d,{id:"isGraUser",class:"mb-3 col-12 col-lg-3",modelValue:e(r).isGraUser,"onUpdate:modelValue":o[5]||(o[5]=n=>e(r).isGraUser=n),label:l._lang.label.isGraUser,disabled:!a.isCreate,loading:e(t),type:e(m).inputs.checkbox},null,8,["modelValue","label","disabled","loading","type"])]),_:1}),i(c,null,{default:g(()=>[i(A,{target:"create-profile",class:"d-inline",type:e(m).buttonType.secondary,title:l._lang.common.toAdd,disabled:a.disabled,icon:D},null,8,["type","title","disabled"])]),_:1}),i(j,{data:e(p),loading:e(t),checkbox:!1,showPagination:!1},{columns:g(()=>[i(z,{name:l._lang.label.profile,field:"profile",fieldSort:"profileId",sortable:!0},null,8,["name"]),i(z,{name:l._lang.label.organization,field:"organization",fieldSort:"organizationId",sortable:!0},null,8,["name"])]),actions:g(n=>[i(_,{id:v,onClick:K=>$(n.item),disabled:a.disabled},null,8,["onClick","disabled"])]),_:1},8,["data","loading"])]),_:1}),i(J,{modelValue:e(r).profiles,"onUpdate:modelValue":o[6]||(o[6]=n=>e(r).profiles=n)},null,8,["modelValue"]),i(O,{id:v,title:l._lang.backoffice.settings.users.deleteProfile,message:l._lang.backoffice.settings.users.deleteProfileQuestion,action:C},null,8,["title","message"])],64)}}};export{ee as _,W as h};
