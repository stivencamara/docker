import{_ as H}from"./form-c5ce17f0.js";import{g as U,f as q,i as x,h as z,r,G as k,s as u,j as F,M as J,N as Q,K as W,u as d,z as o,k as E,c as p,l as v,w as b,n as I,p as e,I as y,y as X}from"./index-a14ad215.js";import{s as C}from"./service-a0c37778.js";import{s as w}from"./helpers-11fd24aa.js";import{u as Y}from"./service-9ca2bd37.js";import"./helpers-71142cd6.js";/* empty css                                                                     */import{_ as Z}from"./detail-actions-e07ee9c0.js";import"./index.esm-88a1129f.js";import"./address.vue_vue_type_style_index_0_scoped_5480b292_lang-b87b4179.js";import"./point-of-care-86564745.js";import"./index.esm-97dcd533.js";import"./form-247c12ee.js";import"./settings-739a4c13.js";import"./legislation-1bd6be27.js";import"./organization-4f7bdfd2.js";import"./helpers-a264fdb9.js";import"./refusal-4e803a93.js";import"./generic-90322b29.js";import"./point-of-care-4055b36e.js";import"./helpers-bdeacb10.js";import"./helpers-d171baff.js";import"./helpers-682b85b1.js";import"./helpers-bd233d9c.js";const Fe={__name:"detail",setup($){const O=U(),f=q();x();const S=z(),T=Y();let s=r(!0),l=k(w.newForm()),n=r(u.language.pt);r([]);let L=r([]),B=k(w.formRules()),m=r(0),c=r(0),P=r(0),K=r(-1),g=r(null);const h=F(()=>f.path.toLowerCase().indexOf("tarefas")>-1),V=F(()=>f.path.toLowerCase().indexOf("pesquisa")>-1),M=r(J.havePermission(u.permissions.service.createEdit));async function G(){s.value=!0;const a=await C.getById(m.value,c.value);d.validateResponse(a,null,()=>{let t=a.data;t.eventTypeId=t.lifeEventId?u.eventType.life:u.eventType.business,t.processingTime.type=t.processingTime.weeks?u.processingTimeType.simplified:u.processingTimeType.advanced,Object.assign(l,t),S.emit(o.emitter.OBJECT_LOADED,a.data),T.setFormToCompare(d.cloneObject(t))}),s.value=!1}async function R(){s.value=!0;const a=await C.getLists(n.value);d.validateResponse(a,null,()=>{T.setLists(a.data)}),s.value=!1}Q(()=>n.value,()=>{R()}),W(async()=>{m.value=d.decodeId(f.params.serviceId),c.value=d.decodeId(f.params.serviceVersion),!m.value||!c.value?O.push({name:o.router.BACKOFFICE_SERVICE_PAGE.name}):(await R(),await G(),A.value&&(await g.value.getHistory(),g.value.setActiveVersion(c.value),g.value.setStep()))});const A=F(()=>!h.value&&M.value&&l.recordStateTypeId!=u.recordStateType.draft);return(a,t)=>{const _=E("breadcrumb-item"),D=E("breadcrumb"),N=E("ctimeline"),j=E("page");return p(),v(j,{title:a._lang.backoffice.service.detailPageTitle},{breadcrumb:b(()=>[I(D,{"has-home":!e(V)},{default:b(()=>[e(h)?(p(),v(_,{key:0,label:a._lang.backoffice.tasks.breadcrumbTitle,"router-path":e(o).router.BACKOFFICE_TASKS_PAGE.path},null,8,["label","router-path"])):e(V)?(p(),v(_,{key:1,label:a._lang.search.pageTitle,"router-path":e(o).router.HOME_PAGE.path},null,8,["label","router-path"])):(p(),v(_,{key:2,label:a._lang.backoffice.service.breadcrumbTitle,"router-path":e(o).router.BACKOFFICE_SERVICE_PAGE.path},null,8,["label","router-path"])),I(_,{label:a._lang.backoffice.service.detailPageTitle},null,8,["label"])]),_:1},8,["has-home"])]),actions:b(()=>[I(Z,{loading:e(s),"onUpdate:loading":t[0]||(t[0]=i=>y(s)?s.value=i:s=i),selectedLang:e(n),"onUpdate:selectedLang":t[1]||(t[1]=i=>y(n)?n.value=i:n=i),service:e(C),backRoute:e(o).router.BACKOFFICE_SERVICE_PAGE.name,editRoute:e(o).router.BACKOFFICE_EDIT_SERVICE_PAGE.name,itemIdField:"serviceId",itemVersionField:"serviceVersion",itemId:e(m),itemVersion:e(c),formModel:e(l),"show-record-state-actions":e(h),store:e(T)},null,8,["loading","selectedLang","service","backRoute","editRoute","itemId","itemVersion","formModel","show-record-state-actions","store"])]),default:b(()=>[e(A)?(p(),v(N,{versions:e(L),key:e(P),activeVersion:e(K),itemId:e(m),detailRoute:e(o).router.BACKOFFICE_DETAIL_SERVICE_PAGE.name,service:e(C),versionFieldName:"serviceVersion",dateFieldName:"serviceApprovedDate",detailRouteIdField:"serviceId",detailRouteVersionField:"serviceVersion",ref_key:"timeline",ref:g},null,8,["versions","activeVersion","itemId","detailRoute","service"])):X("",!0),I(H,{formModel:e(l),"onUpdate:formModel":t[2]||(t[2]=i=>y(l)?l.value=i:l=i),disabled:!0,loading:e(s),selectedLang:e(n),validateForm:!0,rules:e(B),isExternalEdit:!1,showProgress:!1},null,8,["formModel","loading","selectedLang","rules"])]),_:1},8,["title"])}}};export{Fe as default};
