import{m as ue,x as re,r,y as U,n as s,A as d,L as me,o as pe,O as P,I as M,a as i,b as h,c as w,w as c,d as n,f as l,T as be,W as Ie,i as A,M as ye,B as N,s as O}from"./index-920dbb37.js";import{l as z}from"./location-be767322.js";import{h as ge}from"./helpers-952742ca.js";import{b as fe}from"./helpers-4c156364.js";import"./index.esm-d0811cb6.js";const Se={__name:"index",setup(_e){const V=ue(),T=re();let u=r(!0),t=U(E()),F=U(s.createEmptyDataSource()),D=r([]),k=r([]),B=r([]),y=r([]),S=r([]),g=r([]),f=r([]),_=r([]),v=r(d.tableSelectedState.none);async function R(e){t.sortBy=e,await C()}async function G(e){t.pageIndex=e,await C()}function E(){return{pageIndex:1,sortBy:"Code desc",organization:null,locationTypeId:null,abreviation:null,location:null,recordStateIds:null,address:null,islandId:null,countyId:null,parishId:null,zipCode:null,active:!0}}async function K(){Object.assign(t,E()),await L()}async function L(){t.pageNumber=1,await C()}async function C(){u.value=!0;let e=await z.search(t);s.validateResponse(e,null,()=>{F=e.data}),u.value=!1}async function H(){u.value=!0;const e=await z.create(ge.newForm());s.validateResponse(e,null,()=>{const o=s.encodeId(e.data.locationId),b=s.encodeId(e.data.locationVersion);V.push({name:O.router.BACKOFFICE_EDIT_LOCATION_PAGE.name,params:{locationId:o,locationVersion:b}})}),u.value=!1}function $(e){V.push({name:O.router.BACKOFFICE_EDIT_LOCATION_PAGE.name,params:{locationId:s.encodeId(e.locationId),locationVersion:s.encodeId(e.locationVersion)}})}function j(e){V.push({name:O.router.BACKOFFICE_DETAIL_LOCATION_PAGE.name,params:{locationId:s.encodeId(e.locationId),locationVersion:s.encodeId(e.locationVersion)}})}me(async()=>{await C(),await W()}),pe(async()=>{D.value=s.convertEnumToArray(T.enums.locationType),k.value=s.convertEnumToArray(T.enums.recordStateType),B.value=s.concatItemsBadge(k.value,fe.recordStateTypeBadgeOptions)});async function W(){u.value=!0;const e=await z.getLists("pt");s.validateResponse(e,null,()=>{y.value=e.data.divisionList}),u.value=!1}function q(e){return y.value.find(b=>b.value===e).children}function J(e){return y.value.find(I=>I.value===t.islandId).children.find(I=>I.value===e).children}P(()=>t.islandId,()=>{const e=t.islandId;t.countyId=null,t.parishId=null,t.islandId||(t.countyId=null,t.parishId=null),e?S.value=q(e):(S.value=[],g.value=[])}),P(()=>t.countyId,()=>{const e=t.countyId;t.parishId=null,t.countyId||(t.parishId=null),e?g.value=J(e):g.value=[]});const Q=M(()=>!t.islandId),X=M(()=>!t.countyId);return(e,o)=>{const b=i("breadcrumb-item"),I=i("breadcrumb"),Y=i("cbutton"),m=i("form-field"),Z=i("row"),x=i("cfilter"),ee=i("icon-import"),le=i("cbutton-options"),te=i("table-actions"),p=i("ccolumn"),ae=i("table-action-edit"),ne=i("table-action-detail"),oe=i("ctable"),de=i("container-wrapper"),ie=i("card"),se=i("page");return h(),w(se,{title:e._lang.backoffice.location.pageTitle},{breadcrumb:c(()=>[n(I,{"has-home":!0},{default:c(()=>[n(b,{label:e._lang.backoffice.location.breadcrumbTitle},null,8,["label"])]),_:1})]),actions:c(()=>[n(Y,{type:l(d).buttonType.secondary,size:l(d).buttonSize.medium,title:e._lang.common.toAdd,icon:be,onClick:H},null,8,["type","size","title"])]),default:c(()=>[n(ie,{shadow:!0},{body:c(()=>[n(x,{title:e._lang.common.filter,"clear-click":K,"apply-click":L,loading:l(u),collapsed:!0},{default:c(()=>[n(Z,null,{default:c(()=>[n(m,{id:"organization",class:"mb-3 col-12 col-md-6",label:e._lang.label.code,type:l(d).inputs.text,maxlength:45,modelValue:l(t).organization,"onUpdate:modelValue":o[0]||(o[0]=a=>l(t).organization=a)},null,8,["label","type","modelValue"]),n(m,{id:"islandId",class:"mb-3 col-12 col-md-6",modelValue:l(t).islandId,"onUpdate:modelValue":o[1]||(o[1]=a=>l(t).islandId=a),label:e._lang.label.islandId,loading:l(u),type:l(d).inputs.multiselect,options:l(y)},null,8,["modelValue","label","loading","type","options"]),n(m,{id:"countyId",class:"mb-3 col-12 col-md-6 col-lg-4",modelValue:l(t).countyId,"onUpdate:modelValue":o[2]||(o[2]=a=>l(t).countyId=a),label:e._lang.label.countyId,loading:l(u),type:l(d).inputs.multiselect,options:l(S),disabled:l(Q)},null,8,["modelValue","label","loading","type","options","disabled"]),n(m,{id:"parishId",class:"mb-3 col-12 col-md-6 col-lg-4",modelValue:l(t).parishId,"onUpdate:modelValue":o[3]||(o[3]=a=>l(t).parishId=a),label:e._lang.label.parishId,loading:l(u),type:l(d).inputs.multiselect,options:l(g),disabled:l(X)},null,8,["modelValue","label","loading","type","options","disabled"]),n(m,{id:"zipCode",class:"mb-3 col-md-12 col-lg-4",label:e._lang.label.zipCode,type:l(d).inputs.zipCode,maxlength:45,modelValue:l(t).zipCode,"onUpdate:modelValue":o[4]||(o[4]=a=>l(t).zipCode=a)},null,8,["label","type","modelValue"]),n(m,{id:"address",class:"mb-3 col-12 col-md-8",label:e._lang.label.address,type:l(d).inputs.address,maxlength:45,modelValue:l(t).address,"onUpdate:modelValue":o[5]||(o[5]=a=>l(t).address=a)},null,8,["label","type","modelValue"]),n(m,{id:"recordStateIds",class:"mb-3 col-12 col-md-4",label:e._lang.label.state,type:l(d).inputs.multiselect,modelValue:l(t).recordStateIds,"onUpdate:modelValue":o[6]||(o[6]=a=>l(t).recordStateIds=a),options:l(k),mode:l(d).multiselectMode.tags},null,8,["label","type","modelValue","options","mode"]),n(m,{id:"active",class:"mb-3 col-12 col-md-6 col-xl-4",modelValue:l(t).active,"onUpdate:modelValue":o[7]||(o[7]=a=>l(t).active=a),label:e._lang.label.active,type:l(d).inputs.checkbox,disabled:l(u)},null,8,["modelValue","label","type","disabled"])]),_:1})]),_:1},8,["title","loading"]),n(de,{class:"mt-4"},{default:c(()=>[n(te,{title:e._lang.common.tableActionTitle},{default:c(()=>[n(le,{type:l(d).buttonType.secondary},{default:c(()=>[n(Ie,{title:l(T).common.import},{default:c(()=>[n(ee,{color:"#002D74"})]),_:1},8,["title"])]),_:1},8,["type"])]),_:1},8,["title"]),n(oe,{onSort:R,onChangePage:G,data:l(F),loading:l(u),checkbox:!0,selectedItems:l(f),"onUpdate:selectedItems":o[8]||(o[8]=a=>A(f)?f.value=a:f=a),unselectedItems:l(_),"onUpdate:unselectedItems":o[9]||(o[9]=a=>A(_)?_.value=a:_=a),selectedState:l(v),"onUpdate:selectedState":o[10]||(o[10]=a=>A(v)?v.value=a:v=a),checkboxField:"code"},{columns:c(()=>[n(p,{name:e._lang.label.oidCode,field:"code",sortable:!0,maxLength:10},null,8,["name"]),n(p,{name:e._lang.label.islandId,field:"island",sortField:"islandId",sortable:!0},null,8,["name"]),n(p,{name:e._lang.label.countyId,field:"county",sortField:"countyId",sortable:!0},null,8,["name"]),n(p,{name:e._lang.label.parishId,field:"parish",sortField:"parishId",sortable:!0},null,8,["name"]),n(p,{name:e._lang.label.zipCode,field:"zipCode",sortField:"zipCode",sortable:!0},null,8,["name"]),n(p,{name:e._lang.label.address,field:"address",sortField:"address",sortable:!0,maxLength:10},null,8,["name"]),n(p,{name:e._lang.common.state,field:"recordStateTypeId",align:l(d).columnAlign.center,custom:ye,options:l(B),sortable:!0},null,8,["name","align","options"])]),actions:c(a=>[a.item.recordStateTypeId==l(d).recordStateType.draft?(h(),w(ae,{key:0,onClick:ce=>$(a.item)},null,8,["onClick"])):N("",!0),a.item.recordStateTypeId>l(d).recordStateType.draft?(h(),w(ne,{key:1,onClick:ce=>j(a.item)},null,8,["onClick"])):N("",!0)]),_:1},8,["data","loading","selectedItems","unselectedItems","selectedState"])]),_:1})]),_:1})]),_:1},8,["title"])}}};export{Se as default};
