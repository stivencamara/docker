import{m as P,N as R,x as B,r as u,y as F,A as L,I as M,L as N,n,s as f,O as V,a as v,b as h,c as G,w as c,d as m,f as a,i as b}from"./index-920dbb37.js";import{u as K}from"./organization-481d97d6.js";import{e as I}from"./helpers-93ac209f.js";import{b as U}from"./helpers-4c156364.js";import{u as j}from"./index.esm-d064d6e3.js";import{o as _}from"./organization-485b520a.js";import{e as H}from"./edit-actions-4d0f80fb.js";import{_ as x}from"./form-983cc03d.js";import"./index.esm-d0811cb6.js";import"./comments-3b769030.js";import"./cancel-confirm-33e0b7cc.js";import"./settings-bb7269a2.js";import"./helpers-65b02008.js";import"./helpers-6935922b.js";import"./helpers-952742ca.js";import"./helpers-cd5e71d3.js";import"./helpers-db4b16e6.js";/* empty css                                                                     */import"./contacts-9da7813e.js";import"./address-38fb745b.js";import"./location-be767322.js";import"./generic-9b68486a.js";import"./point-of-care-5c4c4d1a.js";import"./service-6e6aa2ba.js";import"./document-875ae5ad.js";const be={__name:"edit",setup(D){const C=P(),z=R();B();const p=K();let l=u(0),d=u(0),o=u(!0),e=F(I.newForm()),s=u(L.language.pt),T=F(I.formRules()),g=u(0);const y=j(T,e,{$stopPropagation:!0}),k=M(()=>g.value===100&&!o.value);N(async()=>{l.value=n.decodeId(z.params.organizationId),d.value=n.decodeId(z.params.organizationVersion),!l.value||!d.value?C.push({name:f.router.BACKOFFICE_ENTITIES_PAGE.name}):(await E(),await w())});async function w(){o.value=!0;const t=await _.getById(l.value,d.value);n.validateResponse(t,null,()=>{Object.assign(e,t.data),p.setFormToCompare(n.cloneObject(t.data))}),o.value=!1}async function E(){o.value=!0;const t=await _.getLists(s.value);n.validateResponse(t,null,()=>{p.setLists(t.data)}),o.value=!1}return V(()=>s.value,()=>{E()}),V(()=>[e.nipc,e.texts[0].name,e.groupName,e.organizationTypeId,e.parentOrganization,e.startDate,e.economicActivityId,e.divisionTypeId,e.divisionId,e.address.zipCode,e.address.islandId,e.address.countyId,e.address.parishId,e.address.locality,e.address.address],()=>{let t=I.progressFields();e.divisionTypeId===L.notApplicable&&n.removeItemOfArray(t,"divisionId"),U.calculatePercentage(e,t,r=>{p.setProgress(r),g.value=r})}),(t,r)=>{const A=v("breadcrumb-item"),O=v("breadcrumb"),S=v("page");return h(),G(S,{title:t._lang.backoffice.entities.editPageTitle},{breadcrumb:c(()=>[m(O,{"has-home":!0},{default:c(()=>[m(A,{label:t._lang.backoffice.entities.breadcrumbTitle,"router-path":a(f).router.BACKOFFICE_ENTITIES_PAGE.path},null,8,["label","router-path"]),m(A,{label:t._lang.backoffice.entities.editPageTitle},null,8,["label"])]),_:1})]),actions:c(()=>[m(H,{loading:a(o),"onUpdate:loading":r[0]||(r[0]=i=>b(o)?o.value=i:o=i),canSubmit:a(k),selectedLang:a(s),"onUpdate:selectedLang":r[1]||(r[1]=i=>b(s)?s.value=i:s=i),backRoute:a(f).router.BACKOFFICE_ENTITIES_PAGE.name,service:a(_),itemId:a(l),itemVersion:a(d),formModel:a(e),vuelidate:a(y),store:a(p),resource:t._lang.backoffice.entities,itemIdField:"organizationId"},null,8,["loading","canSubmit","selectedLang","backRoute","service","itemId","itemVersion","formModel","vuelidate","store","resource"])]),default:c(()=>[m(x,{formModel:a(e),"onUpdate:formModel":r[2]||(r[2]=i=>b(e)?e.value=i:e=i),disabled:!1,validateForm:!0,selectedLang:a(s),rules:a(T),loading:a(o),organizationId:a(l),organizationVersion:a(d),progressValue:a(g),"show-progress":!0,vuelidate:a(y)},null,8,["formModel","selectedLang","rules","loading","organizationId","organizationVersion","progressValue","vuelidate"])]),_:1},8,["title"])}}};export{be as default};
